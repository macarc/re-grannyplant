(()=>{var Dp=Object.create;var Ss=Object.defineProperty;var Rp=Object.getOwnPropertyDescriptor;var Cp=Object.getOwnPropertyNames;var Op=Object.getPrototypeOf,Pp=Object.prototype.hasOwnProperty;var Lp=n=>Ss(n,"__esModule",{value:!0});var xp=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Mp=(n,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Cp(e))!Pp.call(n,r)&&r!=="default"&&Ss(n,r,{get:()=>e[r],enumerable:!(t=Rp(e,r))||t.enumerable});return n},Up=n=>Mp(Lp(Ss(n!=null?Dp(Op(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var Dc=xp((FI,Hr)=>{var uc,lc,hc,dc,fc,pc,mc,gc,yc,zr,As,vc,wc,Ic,en,_c,Ec,Tc,bc,Sc,Ac,Nc,kc,$r;(function(n){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(r){n(t(e,t(r)))}):typeof Hr=="object"&&typeof Hr.exports=="object"?n(t(e,t(Hr.exports))):n(t(e));function t(r,i){return r!==e&&(typeof Object.create=="function"?Object.defineProperty(r,"__esModule",{value:!0}):r.__esModule=!0),function(s,o){return r[s]=i?i(s,o):o}}})(function(n){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])};uc=function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(r,i);function s(){this.constructor=r}r.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)},lc=Object.assign||function(r){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r},hc=function(r,i){var s={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&i.indexOf(o)<0&&(s[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(r);a<o.length;a++)i.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(r,o[a])&&(s[o[a]]=r[o[a]]);return s},dc=function(r,i,s,o){var a=arguments.length,c=a<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,i,s,o);else for(var l=r.length-1;l>=0;l--)(u=r[l])&&(c=(a<3?u(c):a>3?u(i,s,c):u(i,s))||c);return a>3&&c&&Object.defineProperty(i,s,c),c},fc=function(r,i){return function(s,o){i(s,o,r)}},pc=function(r,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,i)},mc=function(r,i,s,o){function a(c){return c instanceof s?c:new s(function(u){u(c)})}return new(s||(s=Promise))(function(c,u){function l(f){try{h(o.next(f))}catch(m){u(m)}}function d(f){try{h(o.throw(f))}catch(m){u(m)}}function h(f){f.done?c(f.value):a(f.value).then(l,d)}h((o=o.apply(r,i||[])).next())})},gc=function(r,i){var s={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(h){return function(f){return d([h,f])}}function d(h){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(c=h[0]&2?a.return:h[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,h[1])).done)return c;switch(a=0,c&&(h=[h[0]&2,c.value]),h[0]){case 0:case 1:c=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,a=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(c=s.trys,!(c=c.length>0&&c[c.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!c||h[1]>c[0]&&h[1]<c[3])){s.label=h[1];break}if(h[0]===6&&s.label<c[1]){s.label=c[1],c=h;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(h);break}c[2]&&s.ops.pop(),s.trys.pop();continue}h=i.call(r,s)}catch(f){h=[6,f],a=0}finally{o=c=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},yc=function(r,i){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&$r(i,r,s)},$r=Object.create?function(r,i,s,o){o===void 0&&(o=s),Object.defineProperty(r,o,{enumerable:!0,get:function(){return i[s]}})}:function(r,i,s,o){o===void 0&&(o=s),r[o]=i[s]},zr=function(r){var i=typeof Symbol=="function"&&Symbol.iterator,s=i&&r[i],o=0;if(s)return s.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&o>=r.length&&(r=void 0),{value:r&&r[o++],done:!r}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},As=function(r,i){var s=typeof Symbol=="function"&&r[Symbol.iterator];if(!s)return r;var o=s.call(r),a,c=[],u;try{for(;(i===void 0||i-- >0)&&!(a=o.next()).done;)c.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(u)throw u.error}}return c},vc=function(){for(var r=[],i=0;i<arguments.length;i++)r=r.concat(As(arguments[i]));return r},wc=function(){for(var r=0,i=0,s=arguments.length;i<s;i++)r+=arguments[i].length;for(var o=Array(r),a=0,i=0;i<s;i++)for(var c=arguments[i],u=0,l=c.length;u<l;u++,a++)o[a]=c[u];return o},Ic=function(r,i,s){if(s||arguments.length===2)for(var o=0,a=i.length,c;o<a;o++)(c||!(o in i))&&(c||(c=Array.prototype.slice.call(i,0,o)),c[o]=i[o]);return r.concat(c||Array.prototype.slice.call(i))},en=function(r){return this instanceof en?(this.v=r,this):new en(r)},_c=function(r,i,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=s.apply(r,i||[]),a,c=[];return a={},u("next"),u("throw"),u("return"),a[Symbol.asyncIterator]=function(){return this},a;function u(v){o[v]&&(a[v]=function(I){return new Promise(function(E,L){c.push([v,I,E,L])>1||l(v,I)})})}function l(v,I){try{d(o[v](I))}catch(E){m(c[0][3],E)}}function d(v){v.value instanceof en?Promise.resolve(v.value.v).then(h,f):m(c[0][2],v)}function h(v){l("next",v)}function f(v){l("throw",v)}function m(v,I){v(I),c.shift(),c.length&&l(c[0][0],c[0][1])}},Ec=function(r){var i,s;return i={},o("next"),o("throw",function(a){throw a}),o("return"),i[Symbol.iterator]=function(){return this},i;function o(a,c){i[a]=r[a]?function(u){return(s=!s)?{value:en(r[a](u)),done:a==="return"}:c?c(u):u}:c}},Tc=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r[Symbol.asyncIterator],s;return i?i.call(r):(r=typeof zr=="function"?zr(r):r[Symbol.iterator](),s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s);function o(c){s[c]=r[c]&&function(u){return new Promise(function(l,d){u=r[c](u),a(l,d,u.done,u.value)})}}function a(c,u,l,d){Promise.resolve(d).then(function(h){c({value:h,done:l})},u)}},bc=function(r,i){return Object.defineProperty?Object.defineProperty(r,"raw",{value:i}):r.raw=i,r};var t=Object.create?function(r,i){Object.defineProperty(r,"default",{enumerable:!0,value:i})}:function(r,i){r.default=i};Sc=function(r){if(r&&r.__esModule)return r;var i={};if(r!=null)for(var s in r)s!=="default"&&Object.prototype.hasOwnProperty.call(r,s)&&$r(i,r,s);return t(i,r),i},Ac=function(r){return r&&r.__esModule?r:{default:r}},Nc=function(r,i,s,o){if(s==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?r!==i||!o:!i.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?o:s==="a"?o.call(r):o?o.value:i.get(r)},kc=function(r,i,s,o,a){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?r!==i||!a:!i.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?a.call(r,s):a?a.value=s:i.set(r,s),s},n("__extends",uc),n("__assign",lc),n("__rest",hc),n("__decorate",dc),n("__param",fc),n("__metadata",pc),n("__awaiter",mc),n("__generator",gc),n("__exportStar",yc),n("__createBinding",$r),n("__values",zr),n("__read",As),n("__spread",vc),n("__spreadArrays",wc),n("__spreadArray",Ic),n("__await",en),n("__asyncGenerator",_c),n("__asyncDelegator",Ec),n("__asyncValues",Tc),n("__makeTemplateObject",bc),n("__importStar",Sc),n("__importDefault",Ac),n("__classPrivateFieldGet",Nc),n("__classPrivateFieldSet",kc)})});var Rc=Up(Dc()),{__extends:Cc,__assign:Fp,__rest:Kr,__decorate:VI,__param:qI,__metadata:BI,__awaiter:Oc,__generator:Pc,__exportStar:jI,__createBinding:zI,__values:Gr,__read:Gn,__spread:$I,__spreadArrays:HI,__spreadArray:Ns,__await:KI,__asyncGenerator:GI,__asyncDelegator:WI,__asyncValues:QI,__makeTemplateObject:YI,__importStar:JI,__importDefault:XI,__classPrivateFieldGet:ZI,__classPrivateFieldSet:e_}=Rc.default;var Vp=function(n){for(var e=[],t=0,r=0;r<n.length;r++){var i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)==55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)==56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},qp=function(n){for(var e=[],t=0,r=0;t<n.length;){var i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){var s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{var s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Bp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<n.length;i+=3){var s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,l=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|u>>6,f=u&63;c||(f=64,o||(h=64)),r.push(t[l],t[d],t[h],t[f])}return r.join("")},encodeString:function(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Vp(n),e)},decodeString:function(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qp(this.decodeStringToByteArray(n,e))},decodeStringToByteArray:function(n,e){this.init_();for(var t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<n.length;){var s=t[n.charAt(i++)],o=i<n.length,a=o?t[n.charAt(i)]:0;++i;var c=i<n.length,u=c?t[n.charAt(i)]:64;++i;var l=i<n.length,d=l?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||d==null)throw Error();var h=s<<2|a>>4;if(r.push(h),u!==64){var f=a<<4&240|u>>2;if(r.push(f),d!==64){var m=u<<6&192|d;r.push(m)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};var Lc=function(n){try{return Bp.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};var xc=function(){function n(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,r){e.resolve=t,e.reject=r})}return n.prototype.wrapCallback=function(e){var t=this;return function(r,i){r?t.reject(r):t.resolve(i),typeof e=="function"&&(t.promise.catch(function(){}),e.length===1?e(r):e(r,i))}},n}();function H(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Wr(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(H())}function jp(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch(n){return!1}}function Qr(){var n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Yr(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Mc(){return H().indexOf("Electron/")>=0}function Jr(){var n=H();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Uc(){return H().indexOf("MSAppHost/")>=0}function Fc(){return!jp()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var zp="FirebaseError",tn=function(n){Cc(e,n);function e(t,r,i){var s=n.call(this,r)||this;return s.code=t,s.customData=i,s.name=zp,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,nn.prototype.create),s}return e}(Error),nn=function(){function n(e,t,r){this.service=e,this.serviceName=t,this.errors=r}return n.prototype.create=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=t[0]||{},s=this.service+"/"+e,o=this.errors[e],a=o?$p(o,i):"Error",c=this.serviceName+": "+a+" ("+s+").",u=new tn(s,c,i);return u},n}();function $p(n,e){return n.replace(Hp,function(t,r){var i=e[r];return i!=null?String(i):"<"+r+"?>"})}var Hp=/\{\$([^}]+)}/g;function Vc(n){for(var e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bt(n,e){if(n===e)return!0;for(var t=Object.keys(n),r=Object.keys(e),i=0,s=t;i<s.length;i++){var o=s[i];if(!r.includes(o))return!1;var a=n[o],c=e[o];if(qc(a)&&qc(c)){if(!bt(a,c))return!1}else if(a!==c)return!1}for(var u=0,l=r;u<l.length;u++){var o=l[u];if(!t.includes(o))return!1}return!0}function qc(n){return n!==null&&typeof n=="object"}function rn(n){for(var e=[],t=function(c,u){Array.isArray(u)?u.forEach(function(l){e.push(encodeURIComponent(c)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(c)+"="+encodeURIComponent(u))},r=0,i=Object.entries(n);r<i.length;r++){var s=i[r],o=s[0],a=s[1];t(o,a)}return e.length?"&"+e.join("&"):""}function sn(n){var e={},t=n.replace(/^\?/,"").split("&");return t.forEach(function(r){if(r){var i=r.split("="),s=i[0],o=i[1];e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function on(n){var e=n.indexOf("?");if(!e)return"";var t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var r_=function(){function n(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return n.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},n.prototype.compress_=function(e,t){t||(t=0);var r=this.W_;if(typeof e=="string")for(var i=0;i<16;i++)r[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)r[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var i=16;i<80;i++){var s=r[i-3]^r[i-8]^r[i-14]^r[i-16];r[i]=(s<<1|s>>>31)&4294967295}for(var o=this.chain_[0],a=this.chain_[1],c=this.chain_[2],u=this.chain_[3],l=this.chain_[4],d,h,i=0;i<80;i++){i<40?i<20?(d=u^a&(c^u),h=1518500249):(d=a^c^u,h=1859775393):i<60?(d=a&c|u&(a|c),h=2400959708):(d=a^c^u,h=3395469782);var s=(o<<5|o>>>27)+d+l+h+r[i]&4294967295;l=u,u=c,c=(a<<30|a>>>2)&4294967295,a=o,o=s}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},n.prototype.update=function(e,t){if(e!=null){t===void 0&&(t=e.length);for(var r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}},n.prototype.digest=function(){var e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);for(var i=0,r=0;r<5;r++)for(var s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e},n}();function Bc(n,e){var t=new Kp(n,e);return t.subscribe.bind(t)}var Kp=function(){function n(e,t){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(r)}).catch(function(i){r.error(i)})}return n.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},n.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},n.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},n.prototype.subscribe=function(e,t,r){var i=this,s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Gp(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=ks),s.error===void 0&&(s.error=ks),s.complete===void 0&&(s.complete=ks);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?s.error(i.finalError):s.complete()}catch(a){}}),this.observers.push(s),o},n.prototype.unsubscribeOne=function(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},n.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},n.prototype.sendOne=function(e,t){var r=this;this.task.then(function(){if(r.observers!==void 0&&r.observers[e]!==void 0)try{t(r.observers[e])}catch(i){typeof console!="undefined"&&console.error&&console.error(i)}})},n.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},n}();function Gp(n,e){if(typeof n!="object"||n===null)return!1;for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i in n&&typeof n[i]=="function")return!0}return!1}function ks(){}var i_=4*60*60*1e3;function be(n){return n&&n._delegate?n._delegate:n}var Ye=function(){function n(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return n.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},n.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},n.prototype.setServiceProps=function(e){return this.serviceProps=e,this},n.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},n}();var St="[DEFAULT]";var Wp=function(){function n(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return n.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var r=new xc;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{var i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch(s){}}return this.instancesDeferred.get(t).promise},n.prototype.getImmediate=function(e){var t,r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error("Service "+this.name+" is not available")}},n.prototype.getComponent=function(){return this.component},n.prototype.setComponent=function(e){var t,r;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,!!this.shouldAutoInitialize()){if(Yp(e))try{this.getOrInitializeService({instanceIdentifier:St})}catch(d){}try{for(var i=Gr(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var o=Gn(s.value,2),a=o[0],c=o[1],u=this.normalizeInstanceIdentifier(a);try{var l=this.getOrInitializeService({instanceIdentifier:u});c.resolve(l)}catch(d){}}}catch(d){t={error:d}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}},n.prototype.clearInstance=function(e){e===void 0&&(e=St),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},n.prototype.delete=function(){return Oc(this,void 0,void 0,function(){var e;return Pc(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Ns(Ns([],Gn(e.filter(function(r){return"INTERNAL"in r}).map(function(r){return r.INTERNAL.delete()}))),Gn(e.filter(function(r){return"_delete"in r}).map(function(r){return r._delete()}))))];case 1:return t.sent(),[2]}})})},n.prototype.isComponentSet=function(){return this.component!=null},n.prototype.isInitialized=function(e){return e===void 0&&(e=St),this.instances.has(e)},n.prototype.getOptions=function(e){return e===void 0&&(e=St),this.instancesOptions.get(e)||{}},n.prototype.initialize=function(e){var t,r;e===void 0&&(e={});var i=e.options,s=i===void 0?{}:i,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=Gr(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=Gn(u.value,2),d=l[0],h=l[1],f=this.normalizeInstanceIdentifier(d);o===f&&h.resolve(a)}}catch(m){t={error:m}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return a},n.prototype.onInit=function(e,t){var r,i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);var o=this.instances.get(i);return o&&e(o,i),function(){s.delete(e)}},n.prototype.invokeOnInitCallbacks=function(e,t){var r,i,s=this.onInitCallbacks.get(t);if(!!s)try{for(var o=Gr(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(u){}}}catch(u){r={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},n.prototype.getOrInitializeService=function(e){var t=e.instanceIdentifier,r=e.options,i=r===void 0?{}:r,s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:Qp(t),options:i}),this.instances.set(t,s),this.instancesOptions.set(t,i),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch(o){}return s||null},n.prototype.normalizeInstanceIdentifier=function(e){return e===void 0&&(e=St),this.component?this.component.multipleInstances?e:St:e},n.prototype.shouldAutoInitialize=function(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"},n}();function Qp(n){return n===St?void 0:n}function Yp(n){return n.instantiationMode==="EAGER"}var jc=function(){function n(e){this.name=e,this.providers=new Map}return n.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},n.prototype.addOrOverwriteComponent=function(e){var t=this.getProvider(e.name);t.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},n.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Wp(e,this);return this.providers.set(e,t),t},n.prototype.getProviders=function(){return Array.from(this.providers.values())},n}();function Le(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var At,Jp=[],U;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(U||(U={}));var Xp={debug:U.DEBUG,verbose:U.VERBOSE,info:U.INFO,warn:U.WARN,error:U.ERROR,silent:U.SILENT},Zp=U.INFO,em=(At={},At[U.DEBUG]="log",At[U.VERBOSE]="log",At[U.INFO]="info",At[U.WARN]="warn",At[U.ERROR]="error",At),tm=function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(!(e<n.logLevel)){var i=new Date().toISOString(),s=em[e];if(s)console[s].apply(console,Le(["["+i+"]  "+n.name+":"],t));else throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}},an=function(){function n(e){this.name=e,this._logLevel=Zp,this._logHandler=tm,this._userLogHandler=null,Jp.push(this)}return Object.defineProperty(n.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in U))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),n.prototype.setLogLevel=function(e){this._logLevel=typeof e=="string"?Xp[e]:e},Object.defineProperty(n.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Le([this,U.DEBUG],e)),this._logHandler.apply(this,Le([this,U.DEBUG],e))},n.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Le([this,U.VERBOSE],e)),this._logHandler.apply(this,Le([this,U.VERBOSE],e))},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Le([this,U.INFO],e)),this._logHandler.apply(this,Le([this,U.INFO],e))},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Le([this,U.WARN],e)),this._logHandler.apply(this,Le([this,U.WARN],e))},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Le([this,U.ERROR],e)),this._logHandler.apply(this,Le([this,U.ERROR],e))},n}();var zc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(nm(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function nm(n){let e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}var $c="@firebase/app",rm="0.7.0";var Ds=new an("@firebase/app"),im="@firebase/app-compat",sm="@firebase/analytics-compat",om="@firebase/analytics",am="@firebase/app-check-compat",cm="@firebase/app-check",um="@firebase/auth",lm="@firebase/auth-compat",hm="@firebase/database",dm="@firebase/database-compat",fm="@firebase/functions",pm="@firebase/functions-compat",mm="@firebase/installations",gm="@firebase/installations-compat",ym="@firebase/messaging",vm="@firebase/messaging-compat",wm="@firebase/performance",Im="@firebase/performance-compat",_m="@firebase/remote-config",Em="@firebase/remote-config-compat",Tm="@firebase/storage",bm="@firebase/storage-compat",Sm="@firebase/firestore",Am="@firebase/firestore-compat",Nm="firebase",km="9.0.0";var Hc="[DEFAULT]",Dm={[$c]:"fire-core",[im]:"fire-core-compat",[om]:"fire-analytics",[sm]:"fire-analytics-compat",[cm]:"fire-app-check",[am]:"fire-app-check-compat",[um]:"fire-auth",[lm]:"fire-auth-compat",[hm]:"fire-rtdb",[dm]:"fire-rtdb-compat",[fm]:"fire-fn",[pm]:"fire-fn-compat",[mm]:"fire-iid",[gm]:"fire-iid-compat",[ym]:"fire-fcm",[vm]:"fire-fcm-compat",[wm]:"fire-perf",[Im]:"fire-perf-compat",[_m]:"fire-rc",[Em]:"fire-rc-compat",[Tm]:"fire-gcs",[bm]:"fire-gcs-compat",[Sm]:"fire-fst",[Am]:"fire-fst-compat","fire-js":"fire-js",[Nm]:"fire-js-all"};var Xr=new Map,Rs=new Map;function Rm(n,e){try{n.container.addComponent(e)}catch(t){Ds.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Nt(n){let e=n.name;if(Rs.has(e))return Ds.debug(`There were multiple attempts to register component ${e}.`),!1;Rs.set(e,n);for(let t of Xr.values())Rm(t,n);return!0}function Wn(n,e){return n.container.getProvider(e)}var Cm={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function."},Zr=new nn("app","Firebase",Cm);var Kc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ye("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zr.create("app-deleted",{appName:this._name})}};var kt=km;function Gc(n,e={}){typeof e!="object"&&(e={name:e});let t=Object.assign({name:Hc,automaticDataCollectionEnabled:!1},e),r=t.name;if(typeof r!="string"||!r)throw Zr.create("bad-app-name",{appName:String(r)});let i=Xr.get(r);if(i){if(bt(n,i.options)&&bt(t,i.config))return i;throw Zr.create("duplicate-app",{appName:r})}let s=new jc(r);for(let a of Rs.values())s.addComponent(a);let o=new Kc(n,t,s);return Xr.set(r,o),o}function ei(n=Hc){let e=Xr.get(n);if(!e)throw Zr.create("no-app",{appName:n});return e}function at(n,e,t){var r;let i=(r=Dm[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ds.warn(a.join(" "));return}Nt(new Ye(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function Om(n){Nt(new Ye("platform-logger",e=>new zc(e),"PRIVATE")),at($c,rm,n),at("fire-js","")}Om();var Pm="firebase",Lm="9.0.1-2021730202621";at(Pm,Lm,"app");var __=Gc({apiKey:"AIzaSyAx6QoU7LVOOs_i-m-MYYLYvw2FZYXklJg",authDomain:"granny-plant.firebaseapp.com",projectId:"granny-plant"});var Cs=function(n,e){return Cs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Cs(n,e)};function xm(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Cs(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Wc(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Mm=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},_,Os=Os||{},k=Mm||self;function ti(){}function Ps(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function Qn(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function Um(n){return Object.prototype.hasOwnProperty.call(n,Ls)&&n[Ls]||(n[Ls]=++Fm)}var Ls="closure_uid_"+(1e9*Math.random()>>>0),Fm=0;function Vm(n,e,t){return n.call.apply(n.bind,arguments)}function qm(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function se(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?se=Vm:se=qm,se.apply(null,arguments)}function ni(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function oe(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ct(){this.s=this.s,this.o=this.o}var Bm=0,jm={};ct.prototype.s=!1;ct.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),Bm!=0)){var n=Um(this);delete jm[n]}};ct.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Qc=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(var t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},Yc=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){for(var r=n.length,i=typeof n=="string"?n.split(""):n,s=0;s<r;s++)s in i&&e.call(t,i[s],s,n)};function zm(n){e:{for(var e=Lg,t=n.length,r=typeof n=="string"?n.split(""):n,i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:typeof n=="string"?n.charAt(e):n[e]}function Jc(n){return Array.prototype.concat.apply([],arguments)}function xs(n){var e=n.length;if(0<e){for(var t=Array(e),r=0;r<e;r++)t[r]=n[r];return t}return[]}function ri(n){return/^[\s\xa0]*$/.test(n)}var Xc=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function he(n,e){return n.indexOf(e)!=-1}function Ms(n,e){return n<e?-1:n>e?1:0}var de;e:{if(Us=k.navigator,Us&&(Fs=Us.userAgent,Fs)){de=Fs;break e}de=""}var Us,Fs;function Vs(n,e,t){for(var r in n)e.call(t,n[r],r,n)}function Zc(n){var e={};for(var t in n)e[t]=n[t];return e}var eu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tu(n,e){for(var t,r,i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(var s=0;s<eu.length;s++)t=eu[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function qs(n){return qs[" "](n),n}qs[" "]=ti;function $m(n){var e=Gm;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}var Hm=he(de,"Opera"),cn=he(de,"Trident")||he(de,"MSIE"),nu=he(de,"Edge"),Bs=nu||cn,ru=he(de,"Gecko")&&!(he(de.toLowerCase(),"webkit")&&!he(de,"Edge"))&&!(he(de,"Trident")||he(de,"MSIE"))&&!he(de,"Edge"),Km=he(de.toLowerCase(),"webkit")&&!he(de,"Edge");function iu(){var n=k.document;return n?n.documentMode:void 0}var ii;e:{if(si="",oi=function(){var n=de;if(ru)return/rv:([^\);]+)(\)|;)/.exec(n);if(nu)return/Edge\/([\d\.]+)/.exec(n);if(cn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(Km)return/WebKit\/(\S+)/.exec(n);if(Hm)return/(?:Version)[ \/]?(\S+)/.exec(n)}(),oi&&(si=oi?oi[1]:""),cn&&(ai=iu(),ai!=null&&ai>parseFloat(si))){ii=String(ai);break e}ii=si}var si,oi,ai,Gm={};function Wm(){return $m(function(){for(var n=0,e=Xc(String(ii)).split("."),t=Xc("9").split("."),r=Math.max(e.length,t.length),i=0;n==0&&i<r;i++){var s=e[i]||"",o=t[i]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s[0].length==0&&o[0].length==0)break;n=Ms(s[1].length==0?0:parseInt(s[1],10),o[1].length==0?0:parseInt(o[1],10))||Ms(s[2].length==0,o[2].length==0)||Ms(s[2],o[2]),s=s[3],o=o[3]}while(n==0)}return 0<=n})}var js;k.document&&cn?(zs=iu(),js=zs||parseInt(ii,10)||void 0):js=void 0;var zs,Qm=js,Ym=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{k.addEventListener("test",ti,e),k.removeEventListener("test",ti,e)}catch(t){}return n}();function le(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}le.prototype.h=function(){this.defaultPrevented=!0};function Yn(n,e){if(le.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(ru){e:{try{qs(e.nodeName);var i=!0;break e}catch(s){}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:Jm[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Yn.Z.h.call(this)}}oe(Yn,le);var Jm={2:"touch",3:"pen",4:"mouse"};Yn.prototype.h=function(){Yn.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Jn="closure_listenable_"+(1e6*Math.random()|0),Xm=0;function Zm(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++Xm,this.ca=this.fa=!1}function ci(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function ui(n){this.src=n,this.g={},this.h=0}ui.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var o=Hs(n,e,r,i);return-1<o?(e=n[o],t||(e.fa=!1)):(e=new Zm(e,this.src,s,!!r,i),e.fa=t,n.push(e)),e};function $s(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=Qc(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(ci(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Hs(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.ca&&s.listener==e&&s.capture==!!t&&s.ia==r)return i}return-1}var Ks="closure_lm_"+(1e6*Math.random()|0),Gs={};function su(n,e,t,r,i){if(r&&r.once)return au(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)su(n,e[s],t,r,i);return null}return t=Js(t),n&&n[Jn]?n.N(e,t,Qn(r)?!!r.capture:!!r,i):ou(n,e,t,!1,r,i)}function ou(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var o=Qn(i)?!!i.capture:!!i,a=Qs(n);if(a||(n[Ks]=a=new ui(n)),t=a.add(e,t,r,o,s),t.proxy)return t;if(r=eg(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Ym||(i=o),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(uu(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function eg(){function n(t){return e.call(n.src,n.listener,t)}var e=tg;return n}function au(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)au(n,e[s],t,r,i);return null}return t=Js(t),n&&n[Jn]?n.O(e,t,Qn(r)?!!r.capture:!!r,i):ou(n,e,t,!0,r,i)}function cu(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)cu(n,e[s],t,r,i);else r=Qn(r)?!!r.capture:!!r,t=Js(t),n&&n[Jn]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Hs(s,t,r,i),-1<t&&(ci(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=Qs(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Hs(e,t,r,i)),(t=-1<n?e[n]:null)&&Ws(t))}function Ws(n){if(typeof n!="number"&&n&&!n.ca){var e=n.src;if(e&&e[Jn])$s(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(uu(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Qs(e))?($s(t,n),t.h==0&&(t.src=null,e[Ks]=null)):ci(n)}}}function uu(n){return n in Gs?Gs[n]:Gs[n]="on"+n}function tg(n,e){if(n.ca)n=!0;else{e=new Yn(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&Ws(n),n=t.call(r,e)}return n}function Qs(n){return n=n[Ks],n instanceof ui?n:null}var Ys="__closure_events_fn_"+(1e9*Math.random()>>>0);function Js(n){return typeof n=="function"?n:(n[Ys]||(n[Ys]=function(e){return n.handleEvent(e)}),n[Ys])}function Z(){ct.call(this),this.i=new ui(this),this.P=this,this.I=null}oe(Z,ct);Z.prototype[Jn]=!0;Z.prototype.removeEventListener=function(n,e,t,r){cu(this,n,e,t,r)};function ae(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,typeof e=="string")e=new le(e,n);else if(e instanceof le)e.target=e.target||n;else{var i=e;e=new le(r,n),tu(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=li(o,r,!0,e)&&i}if(o=e.g=n,i=li(o,r,!0,e)&&i,i=li(o,r,!1,e)&&i,t)for(s=0;s<t.length;s++)o=e.g=t[s],i=li(o,r,!1,e)&&i}Z.prototype.M=function(){if(Z.Z.M.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)ci(t[r]);delete n.g[e],n.h--}}this.I=null};Z.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};Z.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function li(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==t){var a=o.listener,c=o.ia||o.src;o.fa&&$s(n.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var Xs=k.JSON.stringify;function ng(){var n=hu,e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var rg=function(){function n(){this.h=this.g=null}return n.prototype.add=function(e,t){var r=lu.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r},n}(),lu=new(function(){function n(e,t){this.i=e,this.j=t,this.h=0,this.g=null}return n.prototype.get=function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e},n}())(function(){return new ig},function(n){return n.reset()}),ig=function(){function n(){this.next=this.g=this.h=null}return n.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},n.prototype.reset=function(){this.next=this.g=this.h=null},n}();function sg(n){k.setTimeout(function(){throw n},0)}function Zs(n,e){eo||og(),to||(eo(),to=!0),hu.add(n,e)}var eo;function og(){var n=k.Promise.resolve(void 0);eo=function(){n.then(ag)}}var to=!1,hu=new rg;function ag(){for(var n;n=ng();){try{n.h.call(n.g)}catch(t){sg(t)}var e=lu;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}to=!1}function hi(n,e){Z.call(this),this.h=n||1,this.g=e||k,this.j=se(this.kb,this),this.l=Date.now()}oe(hi,Z);_=hi.prototype;_.da=!1;_.S=null;_.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ae(this,"tick"),this.da&&(no(this),this.start()))}};_.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function no(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}_.M=function(){hi.Z.M.call(this),no(this),delete this.g};function ro(n,e,t){if(typeof n=="function")t&&(n=se(n,t));else if(n&&typeof n.handleEvent=="function")n=se(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:k.setTimeout(n,e||0)}function du(n){n.g=ro(function(){n.g=null,n.i&&(n.i=!1,du(n))},n.j);var e=n.h;n.h=null,n.m.apply(null,e)}var cg=function(n){xm(e,n);function e(t,r){var i=n.call(this)||this;return i.m=t,i.j=r,i.h=null,i.i=!1,i.g=null,i}return e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:du(this)},e.prototype.M=function(){n.prototype.M.call(this),this.g&&(k.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(ct);function Xn(n){ct.call(this),this.h=n,this.g={}}oe(Xn,ct);var fu=[];function pu(n,e,t,r){Array.isArray(t)||(t&&(fu[0]=t.toString()),t=fu);for(var i=0;i<t.length;i++){var s=su(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function mu(n){Vs(n.g,function(e,t){this.g.hasOwnProperty(t)&&Ws(e)},n),n.g={}}Xn.prototype.M=function(){Xn.Z.M.call(this),mu(this)};Xn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function di(){this.g=!0}di.prototype.Aa=function(){this.g=!1};function ug(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+o})}function lg(n,e,t,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+o})}function un(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+dg(n,t)+(r?" "+r:"")})}function hg(n,e){n.info(function(){return"TIMEOUT: "+e})}di.prototype.info=function(){};function dg(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Xs(t)}catch(a){return e}}var Dt={},gu=null;function fi(){return gu=gu||new Z}Dt.Ma="serverreachability";function yu(n){le.call(this,Dt.Ma,n)}oe(yu,le);function Zn(n){var e=fi();ae(e,new yu(e,n))}Dt.STAT_EVENT="statevent";function vu(n,e){le.call(this,Dt.STAT_EVENT,n),this.stat=e}oe(vu,le);function fe(n){var e=fi();ae(e,new vu(e,n))}Dt.Na="timingevent";function wu(n,e){le.call(this,Dt.Na,n),this.size=e}oe(wu,le);function er(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){n()},e)}var pi={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Iu={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function io(){}io.prototype.h=null;function _u(n){return n.h||(n.h=n.i())}function Eu(){}var tr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function so(){le.call(this,"d")}oe(so,le);function oo(){le.call(this,"c")}oe(oo,le);var ao;function mi(){}oe(mi,io);mi.prototype.g=function(){return new XMLHttpRequest};mi.prototype.i=function(){return{}};ao=new mi;function nr(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new Xn(this),this.P=fg,n=Bs?125:void 0,this.W=new hi(n),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Tu}function Tu(){this.i=null,this.g="",this.h=!1}var fg=45e3,co={},gi={};_=nr.prototype;_.setTimeout=function(n){this.P=n};function uo(n,e,t){n.K=1,n.v=_i(Je(e)),n.s=t,n.U=!0,bu(n,null)}function bu(n,e){n.F=Date.now(),rr(n),n.A=Je(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),Pu(t.h,"t",r),n.C=0,t=n.l.H,n.h=new Tu,n.g=nl(n.l,t?e:null,!n.s),0<n.O&&(n.L=new cg(se(n.Ia,n,n.g),n.O)),pu(n.V,n.g,"readystatechange",n.gb),e=n.H?Zc(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),Zn(1),ug(n.j,n.u,n.A,n.m,n.X,n.s)}_.gb=function(n){n=n.target;var e=this.L;e&&Xe(n)==3?e.l():this.Ia(n)};_.Ia=function(n){try{if(n==this.g)e:{var e=Xe(this.g),t=this.g.Da(),r=this.g.ba();if(!(3>e)&&(e!=3||Bs||this.g&&(this.h.h||this.g.ga()||Hu(this.g)))){this.I||e!=4||t==7||(t==8||0>=r?Zn(3):Zn(2)),yi(this);var i=this.g.ba();this.N=i;t:if(Su(this)){var s=Hu(this.g);n="";var o=s.length,a=Xe(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Rt(this),ir(this);var c="";break t}this.h.i=new k.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,n+=this.h.i.decode(s[t],{stream:a&&t==o-1});s.splice(0,o),this.h.g+=n,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=i==200,lg(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ri(u)){var d=u;break t}}d=null}if(i=d)un(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,lo(this,i);else{this.i=!1,this.o=3,fe(12),Rt(this),ir(this);break e}}this.U?(Au(this,e,c),Bs&&this.i&&e==3&&(pu(this.V,this.W,"tick",this.fb),this.W.start())):(un(this.j,this.m,c,null),lo(this,c)),e==4&&Rt(this),this.i&&!this.I&&(e==4?Xu(this.l,this):(this.i=!1,rr(this)))}else i==400&&0<c.indexOf("Unknown SID")?(this.o=3,fe(12)):(this.o=0,fe(13)),Rt(this),ir(this)}}}catch(h){}finally{}};function Su(n){return n.g?n.u=="GET"&&n.K!=2&&n.l.Ba:!1}function Au(n,e,t){for(var r=!0,i;!n.I&&n.C<t.length;)if(i=pg(n,t),i==gi){e==4&&(n.o=4,fe(14),r=!1),un(n.j,n.m,null,"[Incomplete Response]");break}else if(i==co){n.o=4,fe(15),un(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else un(n.j,n.m,i,null),lo(n,i);Su(n)&&i!=gi&&i!=co&&(n.h.g="",n.C=0),e!=4||t.length!=0||n.h.h||(n.o=1,fe(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,e=n.l,e.g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),Eo(e),e.L=!0,fe(11))):(un(n.j,n.m,t,"[Invalid Chunked Response]"),Rt(n),ir(n))}_.fb=function(){if(this.g){var n=Xe(this.g),e=this.g.ga();this.C<e.length&&(yi(this),Au(this,n,e),this.i&&n!=4&&rr(this))}};function pg(n,e){var t=n.C,r=e.indexOf(`
`,t);return r==-1?gi:(t=Number(e.substring(t,r)),isNaN(t)?co:(r+=1,r+t>e.length?gi:(e=e.substr(r,t),n.C=r+t,e)))}_.cancel=function(){this.I=!0,Rt(this)};function rr(n){n.Y=Date.now()+n.P,Nu(n,n.P)}function Nu(n,e){if(n.B!=null)throw Error("WatchDog timer not null");n.B=er(se(n.eb,n),e)}function yi(n){n.B&&(k.clearTimeout(n.B),n.B=null)}_.eb=function(){this.B=null;var n=Date.now();0<=n-this.Y?(hg(this.j,this.A),this.K!=2&&(Zn(3),fe(17)),Rt(this),this.o=2,ir(this)):Nu(this,this.Y-n)};function ir(n){n.l.G==0||n.I||Xu(n.l,n)}function Rt(n){yi(n);var e=n.L;e&&typeof e.na=="function"&&e.na(),n.L=null,no(n.W),mu(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function lo(n,e){try{var t=n.l;if(t.G!=0&&(t.g==n||po(t.i,n))){if(t.I=n.N,!n.J&&po(t.i,n)&&t.G==3){try{var r=t.Ca.g.parse(e)}catch(I){r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0)e:if(!t.u){if(t.g)if(t.g.F+3e3<n.F)Ni(t),Si(t);else break e;_o(t),fe(18)}else t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&t.A==0&&!t.v&&(t.v=er(se(t.ab,t),6e3));if(1>=Mu(t.i)&&t.ka){try{t.ka()}catch(I){}t.ka=void 0}}else Pt(t,11)}else if((n.J||t.g==n)&&Ni(t),!ri(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){var s=i[e];if(t.U=s[0],s=s[1],t.G==2)if(s[0]=="c"){t.J=s[1],t.la=s[2];var o=s[3];o!=null&&(t.ma=o,t.h.info("VER="+t.ma));var a=s[4];a!=null&&(t.za=a,t.h.info("SVER="+t.za));var c=s[5];c!=null&&typeof c=="number"&&0<c&&(r=1.5*c,t.K=r,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;var u=n.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var d=r.i;!d.g&&(he(l,"spdy")||he(l,"quic")||he(l,"h2"))&&(d.j=d.l,d.g=new Set,d.h&&(mo(d,d.h),d.h=null))}if(r.D){var h=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,z(r.F,r.D,h))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms")),r=t;var f=n;if(r.oa=tl(r,r.H?r.la:null,r.W),f.J){Uu(r.i,f);var m=f,v=r.K;v&&m.setTimeout(v),m.B&&(yi(m),rr(m)),r.g=f}else Yu(r);0<t.l.length&&Ai(t)}else s[0]!="stop"&&s[0]!="close"||Pt(t,7);else t.G==3&&(s[0]=="stop"||s[0]=="close"?s[0]=="stop"?Pt(t,7):wo(t):s[0]!="noop"&&t.j&&t.j.wa(s),t.A=0)}}Zn(4)}catch(I){}}function mg(n){if(n.R&&typeof n.R=="function")return n.R();if(typeof n=="string")return n.split("");if(Ps(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function ho(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(Ps(n)||typeof n=="string")Yc(n,e,void 0);else{if(n.T&&typeof n.T=="function")var t=n.T();else if(n.R&&typeof n.R=="function")t=void 0;else if(Ps(n)||typeof n=="string"){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=mg(n),i=r.length;for(var s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}}function ln(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof ln)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}_=ln.prototype;_.R=function(){fo(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n};_.T=function(){return fo(this),this.g.concat()};function fo(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];Ct(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)r=n.g[e],Ct(i,r)||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}_.get=function(n,e){return Ct(this.h,n)?this.h[n]:e};_.set=function(n,e){Ct(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e};_.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],s=this.get(i);n.call(e,s,i,this)}};function Ct(n,e){return Object.prototype.hasOwnProperty.call(n,e)}var ku=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function gg(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ot(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof Ot){this.g=e!==void 0?e:n.g,vi(this,n.j),this.s=n.s,wi(this,n.i),Ii(this,n.m),this.l=n.l,e=n.h;var t=new ar;t.i=e.i,e.g&&(t.g=new ln(e.g),t.h=e.h),Du(this,t),this.o=n.o}else n&&(t=String(n).match(ku))?(this.g=!!e,vi(this,t[1]||"",!0),this.s=sr(t[2]||""),wi(this,t[3]||"",!0),Ii(this,t[4]),this.l=sr(t[5]||"",!0),Du(this,t[6]||"",!0),this.o=sr(t[7]||"")):(this.g=!!e,this.h=new ar(null,this.g))}Ot.prototype.toString=function(){var n=[],e=this.j;e&&n.push(or(e,Ru,!0),":");var t=this.i;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(or(e,Ru,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.i&&t.charAt(0)!="/"&&n.push("/"),n.push(or(t,t.charAt(0)=="/"?_g:Ig,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",or(t,Tg)),n.join("")};function Je(n){return new Ot(n)}function vi(n,e,t){n.j=t?sr(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function wi(n,e,t){n.i=t?sr(e,!0):e}function Ii(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Du(n,e,t){e instanceof ar?(n.h=e,bg(n.h,n.g)):(t||(e=or(e,Eg)),n.h=new ar(e,n.g))}function z(n,e,t){n.h.set(e,t)}function _i(n){return z(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function yg(n){return n instanceof Ot?Je(n):new Ot(n,void 0)}function vg(n,e,t,r){var i=new Ot(null,void 0);return n&&vi(i,n),e&&wi(i,e),t&&Ii(i,t),r&&(i.l=r),i}function sr(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function or(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,wg),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function wg(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Ru=/[#\/\?@]/g,Ig=/[#\?:]/g,_g=/[#\?]/g,Eg=/[#\?@]/g,Tg=/#/g;function ar(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function ut(n){n.g||(n.g=new ln,n.h=0,n.i&&gg(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}_=ar.prototype;_.add=function(n,e){ut(this),this.i=null,n=hn(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function Cu(n,e){ut(n),e=hn(n,e),Ct(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,n=n.g,Ct(n.h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&fo(n)))}function Ou(n,e){return ut(n),e=hn(n,e),Ct(n.g.h,e)}_.forEach=function(n,e){ut(this),this.g.forEach(function(t,r){Yc(t,function(i){n.call(e,i,r,this)},this)},this)};_.T=function(){ut(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],s=0;s<i.length;s++)t.push(e[r]);return t};_.R=function(n){ut(this);var e=[];if(typeof n=="string")Ou(this,n)&&(e=Jc(e,this.g.get(hn(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=Jc(e,n[t])}return e};_.set=function(n,e){return ut(this),this.i=null,n=hn(this,n),Ou(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};_.get=function(n,e){return n?(n=this.R(n),0<n.length?String(n[0]):e):e};function Pu(n,e,t){Cu(n,e),0<t.length&&(n.i=null,n.g.set(hn(n,e),xs(t)),n.h+=t.length)}_.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;r[s]!==""&&(o+="="+encodeURIComponent(String(r[s]))),n.push(o)}}return this.i=n.join("&")};function hn(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function bg(n,e){e&&!n.j&&(ut(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(Cu(this,r),Pu(this,i,t))},n)),n.j=e}var Sg=function(){function n(e,t){this.h=e,this.g=t}return n}();function Lu(n){this.l=n||Ag,k.PerformanceNavigationTiming?(n=k.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(k.g&&k.g.Ea&&k.g.Ea()&&k.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ag=10;function xu(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function Mu(n){return n.h?1:n.g?n.g.size:0}function po(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function mo(n,e){n.g?n.g.add(e):n.h=e}function Uu(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}Lu.prototype.cancel=function(){var n,e;if(this.i=Fu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){try{for(var t=Wc(this.g.values()),r=t.next();!r.done;r=t.next()){var i=r.value;i.cancel()}}catch(s){n={error:s}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(n)throw n.error}}this.g.clear()}};function Fu(n){var e,t;if(n.h!=null)return n.i.concat(n.h.D);if(n.g!=null&&n.g.size!==0){var r=n.i;try{for(var i=Wc(n.g.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.D)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}return xs(n.i)}function go(){}go.prototype.stringify=function(n){return k.JSON.stringify(n,void 0)};go.prototype.parse=function(n){return k.JSON.parse(n,void 0)};function Ng(){this.g=new go}function kg(n,e,t){var r=t||"";try{ho(n,function(i,s){var o=i;Qn(i)&&(o=Xs(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Dg(n,e){var t=new di;if(k.Image){var r=new Image;r.onload=ni(Ei,t,r,"TestLoadImage: loaded",!0,e),r.onerror=ni(Ei,t,r,"TestLoadImage: error",!1,e),r.onabort=ni(Ei,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=ni(Ei,t,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function Ei(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(s){}}function cr(n){this.l=n.$b||null,this.j=n.ib||!1}oe(cr,io);cr.prototype.g=function(){return new Ti(this.l,this.j)};cr.prototype.i=function(n){return function(){return n}}({});function Ti(n,e){Z.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=yo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}oe(Ti,Z);var yo=0;_=Ti.prototype;_.open=function(n,e){if(this.readyState!=yo)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,lr(this)};_.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||k).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};_.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=yo};_.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,lr(this)),this.g&&(this.readyState=3,lr(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof k.ReadableStream!="undefined"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Vu(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))};function Vu(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}_.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?ur(this):lr(this),this.readyState==3&&Vu(this)}};_.Ua=function(n){this.g&&(this.response=this.responseText=n,ur(this))};_.Ta=function(n){this.g&&(this.response=n,ur(this))};_.ha=function(){this.g&&ur(this)};function ur(n){n.readyState=4,n.l=null,n.j=null,n.A=null,lr(n)}_.setRequestHeader=function(n,e){this.v.append(n,e)};_.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};_.getAllResponseHeaders=function(){if(!this.h)return"";for(var n=[],e=this.h.entries(),t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function lr(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Ti.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var Rg=k.JSON.parse;function Q(n){Z.call(this),this.headers=new ln,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=qu,this.K=this.L=!1}oe(Q,Z);var qu="",Cg=/^https?$/i,Og=["POST","PUT"];_=Q.prototype;_.ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ao.g(),this.C=this.u?_u(this.u):_u(ao),this.g.onreadystatechange=se(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(s){Bu(this,s);return}n=t||"";var i=new ln(this.headers);r&&ho(r,function(s,o){i.set(o,s)}),r=zm(i.T()),t=k.FormData&&n instanceof k.FormData,!(0<=Qc(Og,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(s,o){this.g.setRequestHeader(o,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{$u(this),0<this.B&&((this.K=Pg(this.g))?(this.g.timeout=this.B,this.g.ontimeout=se(this.pa,this)):this.A=ro(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Bu(this,s)}};function Pg(n){return cn&&Wm()&&typeof n.timeout=="number"&&n.ontimeout!==void 0}function Lg(n){return n.toLowerCase()=="content-type"}_.pa=function(){typeof Os!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ae(this,"timeout"),this.abort(8))};function Bu(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,ju(n),bi(n)}function ju(n){n.D||(n.D=!0,ae(n,"complete"),ae(n,"error"))}_.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ae(this,"complete"),ae(this,"abort"),bi(this))};_.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),bi(this,!0)),Q.Z.M.call(this)};_.Fa=function(){this.s||(this.F||this.v||this.l?zu(this):this.cb())};_.cb=function(){zu(this)};function zu(n){if(n.h&&typeof Os!="undefined"&&(!n.C[1]||Xe(n)!=4||n.ba()!=2)){if(n.v&&Xe(n)==4)ro(n.Fa,0,n);else if(ae(n,"readystatechange"),Xe(n)==4){n.h=!1;try{var e=n.ba();e:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var i;if(i=e===0){var s=String(n.H).match(ku)[1]||null;if(!s&&k.self&&k.self.location){var o=k.self.location.protocol;s=o.substr(0,o.length-1)}i=!Cg.test(s?s.toLowerCase():"")}r=i}if(r)ae(n,"complete"),ae(n,"success");else{n.m=6;try{var a=2<Xe(n)?n.g.statusText:""}catch(c){a=""}n.j=a+" ["+n.ba()+"]",ju(n)}}finally{bi(n)}}}}function bi(n,e){if(n.g){$u(n);var t=n.g,r=n.C[0]?ti:null;n.g=null,n.C=null,e||ae(n,"ready");try{t.onreadystatechange=r}catch(i){}}}function $u(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(k.clearTimeout(n.A),n.A=null)}function Xe(n){return n.g?n.g.readyState:0}_.ba=function(){try{return 2<Xe(this)?this.g.status:-1}catch(n){return-1}};_.ga=function(){try{return this.g?this.g.responseText:""}catch(n){return""}};_.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),Rg(e)}};function Hu(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case qu:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}_.Da=function(){return this.m};_.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function xg(n){var e="";return Vs(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function vo(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=xg(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):z(n,e,t))}function hr(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Ku(n){this.za=0,this.l=[],this.h=new di,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=hr("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=hr("baseRetryDelayMs",5e3,n),this.$a=hr("retryDelaySeedMs",1e4,n),this.Ya=hr("forwardChannelMaxRetries",2,n),this.ra=hr("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new Lu(n&&n.concurrentRequestLimit),this.Ca=new Ng,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||n.Xb!==!1}_=Ku.prototype;_.ma=8;_.G=1;function wo(n){if(Gu(n),n.G==3){var e=n.V++,t=Je(n.F);z(t,"SID",n.J),z(t,"RID",e),z(t,"TYPE","terminate"),dr(n,t),e=new nr(n,n.h,e,void 0),e.K=2,e.v=_i(Je(t)),t=!1,k.navigator&&k.navigator.sendBeacon&&(t=k.navigator.sendBeacon(e.v.toString(),"")),!t&&k.Image&&(new Image().src=e.v,t=!0),t||(e.g=nl(e.l,null),e.g.ea(e.v)),e.F=Date.now(),rr(e)}el(n)}_.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch(e){}};function Si(n){n.g&&(Eo(n),n.g.cancel(),n.g=null)}function Gu(n){Si(n),n.u&&(k.clearTimeout(n.u),n.u=null),Ni(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&k.clearTimeout(n.m),n.m=null)}function Io(n,e){n.l.push(new Sg(n.Za++,e)),n.G==3&&Ai(n)}function Ai(n){xu(n.i)||n.m||(n.m=!0,Zs(n.Ha,n),n.C=0)}function Mg(n,e){return Mu(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.l=e.D.concat(n.l),!0):n.G==1||n.G==2||n.C>=(n.Xa?0:n.Ya)?!1:(n.m=er(se(n.Ha,n,e),Zu(n,n.C)),n.C++,!0)}_.Ha=function(n){if(this.m)if(this.m=null,this.G==1){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;var e=new nr(this,this.h,n,void 0),t=this.s;if(this.P&&(t?(t=Zc(t),tu(t,this.P)):t=this.P),this.o===null&&(e.H=t),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){t:{var s=this.l[i];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(r+=s,4096<r){r=i;break e}if(r===4096||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Qu(this,e,r),i=Je(this.F),z(i,"RID",n),z(i,"CVER",22),this.D&&z(i,"X-HTTP-Session-Id",this.D),dr(this,i),this.o&&t&&vo(i,this.o,t),mo(this.i,e),this.Ra&&z(i,"TYPE","init"),this.ja?(z(i,"$req",r),z(i,"SID","null"),e.$=!0,uo(e,i,null)):uo(e,i,r),this.G=2}}else this.G==3&&(n?Wu(this,n):this.l.length==0||xu(this.i)||Wu(this))};function Wu(n,e){var t;e?t=e.m:t=n.V++;var r=Je(n.F);z(r,"SID",n.J),z(r,"RID",t),z(r,"AID",n.U),dr(n,r),n.o&&n.s&&vo(r,n.o,n.s),t=new nr(n,n.h,t,n.C+1),n.o===null&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=Qu(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),mo(n.i,t),uo(t,r,e)}function dr(n,e){n.j&&ho({},function(t,r){z(e,r,t)})}function Qu(n,e,t){t=Math.min(n.l.length,t);var r=n.j?se(n.j.Oa,n.j,n):null;e:for(var i=n.l,s=-1;;){var o=["count="+t];s==-1?0<t?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<t;c++){var u=i[c].h,l=i[c].g;if(u-=s,0>u)s=Math.max(0,i[c].h-100),a=!1;else try{kg(l,o,"req"+u+"_")}catch(d){r&&r(l)}}if(a){r=o.join("&");break e}}return n=n.l.splice(0,t),e.D=n,r}function Yu(n){n.g||n.u||(n.Y=1,Zs(n.Ga,n),n.A=0)}function _o(n){return n.g||n.u||3<=n.A?!1:(n.Y++,n.u=er(se(n.Ga,n),Zu(n,n.A)),n.A++,!0)}_.Ga=function(){if(this.u=null,Ju(this),this.$&&!(this.L||this.g==null||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=er(se(this.bb,this),n)}};_.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,fe(10),Si(this),Ju(this))};function Eo(n){n.B!=null&&(k.clearTimeout(n.B),n.B=null)}function Ju(n){n.g=new nr(n,n.h,"rpc",n.Y),n.o===null&&(n.g.H=n.s),n.g.O=0;var e=Je(n.oa);z(e,"RID","rpc"),z(e,"SID",n.J),z(e,"CI",n.N?"0":"1"),z(e,"AID",n.U),dr(n,e),z(e,"TYPE","xmlhttp"),n.o&&n.s&&vo(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=_i(Je(e)),t.s=null,t.U=!0,bu(t,n)}_.ab=function(){this.v!=null&&(this.v=null,Si(this),_o(this),fe(19))};function Ni(n){n.v!=null&&(k.clearTimeout(n.v),n.v=null)}function Xu(n,e){var t=null;if(n.g==e){Ni(n),Eo(n),n.g=null;var r=2}else if(po(n.i,e))t=e.D,Uu(n.i,e),r=1;else return;if(n.I=e.N,n.G!=0){if(e.i)if(r==1){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;r=fi(),ae(r,new wu(r,t,e,i)),Ai(n)}else Yu(n);else if(i=e.o,i==3||i==0&&0<n.I||!(r==1&&Mg(n,e)||r==2&&_o(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Pt(n,5);break;case 4:Pt(n,10);break;case 3:Pt(n,6);break;default:Pt(n,2)}}}function Zu(n,e){var t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function Pt(n,e){if(n.h.info("Error code "+e),e==2){var t=null;n.j&&(t=null);var r=se(n.jb,n);t||(t=new Ot("//www.google.com/images/cleardot.gif"),k.location&&k.location.protocol=="http"||vi(t,"https"),_i(t)),Dg(t.toString(),r)}else fe(2);n.G=0,n.j&&n.j.va(e),el(n),Gu(n)}_.jb=function(n){n?(this.h.info("Successfully pinged google.com"),fe(2)):(this.h.info("Failed to ping google.com"),fe(1))};function el(n){n.G=0,n.I=-1,n.j&&((Fu(n.i).length!=0||n.l.length!=0)&&(n.i.i.length=0,xs(n.l),n.l.length=0),n.j.ua())}function tl(n,e,t){var r=yg(t);if(r.i!="")e&&wi(r,e+"."+r.i),Ii(r,r.m);else{var i=k.location;r=vg(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&Vs(n.aa,function(s,o){z(r,o,s)}),e=n.D,t=n.sa,e&&t&&z(r,e,t),z(r,"VER",n.ma),dr(n,r),r}function nl(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=t&&n.Ba&&!n.qa?new Q(new cr({ib:!0})):new Q(n.qa),e.L=n.H,e}function rl(){}_=rl.prototype;_.xa=function(){};_.wa=function(){};_.va=function(){};_.ua=function(){};_.Oa=function(){};function ki(){if(cn&&!(10<=Number(Qm)))throw Error("Environmental error: no available transport.")}ki.prototype.g=function(n,e){return new Se(n,e)};function Se(n,e){Z.call(this),this.g=new Ku(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!ri(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ri(e)&&(this.g.D=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new dn(this)}oe(Se,Z);Se.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),Zs(se(n.hb,n,e))),fe(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=tl(n,null,n.W),Ai(n)};Se.prototype.close=function(){wo(this.g)};Se.prototype.u=function(n){if(typeof n=="string"){var e={};e.__data__=n,Io(this.g,e)}else this.v?(e={},e.__data__=Xs(n),Io(this.g,e)):Io(this.g,n)};Se.prototype.M=function(){this.g.j=null,delete this.j,wo(this.g),delete this.g,Se.Z.M.call(this)};function il(n){so.call(this);var e=n.__sm__;if(e){e:{for(var t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}oe(il,so);function sl(){oo.call(this),this.status=1}oe(sl,oo);function dn(n){this.g=n}oe(dn,rl);dn.prototype.xa=function(){ae(this.g,"a")};dn.prototype.wa=function(n){ae(this.g,new il(n))};dn.prototype.va=function(n){ae(this.g,new sl(n))};dn.prototype.ua=function(){ae(this.g,"b")};ki.prototype.createWebChannel=ki.prototype.g;Se.prototype.send=Se.prototype.u;Se.prototype.open=Se.prototype.m;Se.prototype.close=Se.prototype.close;pi.NO_ERROR=0;pi.TIMEOUT=8;pi.HTTP_ERROR=6;Iu.COMPLETE="complete";Eu.EventType=tr;tr.OPEN="a";tr.CLOSE="b";tr.ERROR="c";tr.MESSAGE="d";Z.prototype.listen=Z.prototype.N;Q.prototype.listenOnce=Q.prototype.O;Q.prototype.getLastError=Q.prototype.La;Q.prototype.getLastErrorCode=Q.prototype.Da;Q.prototype.getStatus=Q.prototype.ba;Q.prototype.getResponseJson=Q.prototype.Qa;Q.prototype.getResponseText=Q.prototype.ga;Q.prototype.send=Q.prototype.ea;var ol=function(){return new ki},al=function(){return fi()},Di=pi,cl=Iu,ul=Dt,To={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ll=cr,fr=Eu,hl=Q;var pe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};pe.UNAUTHENTICATED=new pe(null),pe.GOOGLE_CREDENTIALS=new pe("google-credentials-uid"),pe.FIRST_PARTY=new pe("first-party-uid"),pe.MOCK_USER=new pe("mock-user");var fn="9.0.1-2021730202621";var Lt=new an("@firebase/firestore");function bo(){return Lt.logLevel}function w(n,...e){if(Lt.logLevel<=U.DEBUG){let t=e.map(So);Lt.debug(`Firestore (${fn}): ${n}`,...t)}}function ve(n,...e){if(Lt.logLevel<=U.ERROR){let t=e.map(So);Lt.error(`Firestore (${fn}): ${n}`,...t)}}function dl(n,...e){if(Lt.logLevel<=U.WARN){let t=e.map(So);Lt.warn(`Firestore (${fn}): ${n}`,...t)}}function So(n){if(typeof n=="string")return n;try{return e=n,JSON.stringify(e)}catch(t){return n}var e}function S(n="Unexpected state"){let e=`FIRESTORE (${fn}) INTERNAL ASSERTION FAILED: `+n;throw ve(e),new Error(e)}function O(n,e){n||S()}function C(n,e){return n}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},T=class extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var xe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var fl=class{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}},pl=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(pe.UNAUTHENTICATED))}shutdown(){}};var ml=class{constructor(e){this.t=e,this.currentUser=pe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=a=>this.i!==r?(r=this.i,t(a)):Promise.resolve(),s=new xe;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new xe,e.enqueueRetryable(()=>i(this.currentUser))};let o=a=>{e.enqueueRetryable(async()=>{w("FirebaseCredentialsProvider","Auth detected"),this.auth=a,this.auth.addAuthTokenListener(this.o),await s.promise,await i(this.currentUser)})};this.t.onInit(a=>o(a)),setTimeout(()=>{if(!this.auth){let a=this.t.getImmediate({optional:!0});a?o(a):(w("FirebaseCredentialsProvider","Auth not yet detected"),s.resolve(),s=new xe)}},0),e.enqueueRetryable(async()=>{this.i===0&&(await s.promise,await i(this.currentUser))})}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(w("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(O(typeof r.accessToken=="string"),new fl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return O(e===null||typeof e=="string"),new pe(e)}},gl=class{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=pe.FIRST_PARTY}get authHeaders(){let e={"X-Goog-AuthUser":this.l},t=this.h.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.m&&(e["X-Goog-Iam-Authorization-Token"]=this.m),e}},yl=class{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new gl(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(pe.FIRST_PARTY))}shutdown(){}invalidateToken(){}};var Re=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.g(r),this.p=r=>t.writeSequenceNumber(r))}g(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.p&&this.p(e),e}};function Ug(n){let e=typeof self!="undefined"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}Re.T=-1;var Ao=class{static I(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Ug(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function M(n,e){return n<e?-1:n>e?1:0}function pn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function vl(n){return n+"\0"}var ee=class{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new T(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new T(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new T(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new T(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ee.fromMillis(Date.now())}static fromDate(e){return ee.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new ee(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?M(this.nanoseconds,e.nanoseconds):M(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var P=class{constructor(e){this.timestamp=e}static fromTimestamp(e){return new P(e)}static min(){return new P(new ee(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};function wl(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function mn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Il(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var gn=class{constructor(e,t,r){t===void 0?t=0:t>e.length&&S(),r===void 0?r=e.length-t:r>e.length-t&&S(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return gn.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof gn?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},q=class extends gn{construct(e,t,r){return new q(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new T(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new q(t)}static emptyPath(){return new q([])}},Fg=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ce=class extends gn{construct(e,t,r){return new ce(e,t,r)}static isValidIdentifier(e){return Fg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ce.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ce(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new T(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new T(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new T(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new T(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ce(t)}static emptyPath(){return new ce([])}};var pr=class{constructor(e){this.fields=e,e.sort(ce.comparator)}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var te=class{constructor(e){this.binaryString=e}static fromBase64String(e){let t=atob(e);return new te(t)}static fromUint8Array(e){let t=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new te(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return M(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};te.EMPTY_BYTE_STRING=new te("");var Vg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lt(n){if(O(!!n),typeof n=="string"){let e=0,t=Vg.exec(n);if(O(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Y(n.seconds),nanos:Y(n.nanos)}}function Y(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yn(n){return typeof n=="string"?te.fromBase64String(n):te.fromUint8Array(n)}function _l(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function El(n){let e=n.mapValue.fields.__previous_value__;return _l(e)?El(e):e}function mr(n){let e=lt(n.mapValue.fields.__local_write_time__.timestampValue);return new ee(e.seconds,e.nanos)}function vn(n){return n==null}function Ri(n){return n===0&&1/n==-1/0}function qg(n){return typeof n=="number"&&Number.isInteger(n)&&!Ri(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var b=class{constructor(e){this.path=e}static fromPath(e){return new b(q.fromString(e))}static fromName(e){return new b(q.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return e!==null&&q.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return q.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new b(new q(e.slice()))}};function xt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?_l(n)?4:10:S()}function qe(n,e){let t=xt(n);if(t!==xt(e))return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return mr(n).isEqual(mr(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;let s=lt(r.timestampValue),o=lt(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return yn(r.bytesValue).isEqual(yn(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Y(r.geoPointValue.latitude)===Y(i.geoPointValue.latitude)&&Y(r.geoPointValue.longitude)===Y(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Y(r.integerValue)===Y(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){let s=Y(r.doubleValue),o=Y(i.doubleValue);return s===o?Ri(s)===Ri(o):isNaN(s)&&isNaN(o)}return!1}(n,e);case 9:return pn(n.arrayValue.values||[],e.arrayValue.values||[],qe);case 10:return function(r,i){let s=r.mapValue.fields||{},o=i.mapValue.fields||{};if(wl(s)!==wl(o))return!1;for(let a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!qe(s[a],o[a])))return!1;return!0}(n,e);default:return S()}}function gr(n,e){return(n.values||[]).find(t=>qe(t,e))!==void 0}function wn(n,e){let t=xt(n),r=xt(e);if(t!==r)return M(t,r);switch(t){case 0:return 0;case 1:return M(n.booleanValue,e.booleanValue);case 2:return function(i,s){let o=Y(i.integerValue||i.doubleValue),a=Y(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return Tl(n.timestampValue,e.timestampValue);case 4:return Tl(mr(n),mr(e));case 5:return M(n.stringValue,e.stringValue);case 6:return function(i,s){let o=yn(i),a=yn(s);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(i,s){let o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){let u=M(o[c],a[c]);if(u!==0)return u}return M(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,s){let o=M(Y(i.latitude),Y(s.latitude));return o!==0?o:M(Y(i.longitude),Y(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,s){let o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){let u=wn(o[c],a[c]);if(u)return u}return M(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,s){let o=i.fields||{},a=Object.keys(o),c=s.fields||{},u=Object.keys(c);a.sort(),u.sort();for(let l=0;l<a.length&&l<u.length;++l){let d=M(a[l],u[l]);if(d!==0)return d;let h=wn(o[a[l]],c[u[l]]);if(h!==0)return h}return M(a.length,u.length)}(n.mapValue,e.mapValue);default:throw S()}}function Tl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return M(n,e);let t=lt(n),r=lt(e),i=M(t.seconds,r.seconds);return i!==0?i:M(t.nanos,r.nanos)}function No(n){return ko(n)}function ko(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){let i=lt(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?yn(n.bytesValue).toBase64():"referenceValue"in n?(t=n.referenceValue,b.fromName(t).toString()):"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",s=!0;for(let o of r.values||[])s?s=!1:i+=",",i+=ko(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){let i=Object.keys(r.fields||{}).sort(),s="{",o=!0;for(let a of i)o?o=!1:s+=",",s+=`${a}:${ko(r.fields[a])}`;return s+"}"}(n.mapValue):S();var e,t}function Do(n){return!!n&&"integerValue"in n}function Ro(n){return!!n&&"arrayValue"in n}function bl(n){return!!n&&"nullValue"in n}function Sl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ci(n){return!!n&&"mapValue"in n}function yr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return mn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=yr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=yr(n.arrayValue.values[t]);return e}return Object.assign({},n)}var we=class{constructor(e){this.value=e}static empty(){return new we({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ci(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=yr(t)}setAll(e){let t=ce.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=yr(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Ci(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qe(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ci(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){mn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new we(yr(this.value))}};function Al(n){let e=[];return mn(n.fields,(t,r)=>{let i=new ce([t]);if(Ci(r)){let s=Al(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new pr(e)}var G=class{constructor(e,t,r,i,s){this.key=e,this.documentType=t,this.version=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new G(e,0,P.min(),we.empty(),0)}static newFoundDocument(e,t,r){return new G(e,1,t,r,0)}static newNoDocument(e,t){return new G(e,2,t,we.empty(),0)}static newUnknownDocument(e,t){return new G(e,3,t,we.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=we.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=we.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof G&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new G(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Nl=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.A=null}};function kl(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Nl(n,e,t,r,i,s,o)}function vr(n){let e=C(n);if(e.A===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>jg(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),vn(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=xi(e.startAt)),e.endAt&&(t+="|ub:",t+=xi(e.endAt)),e.A=t}return e.A}function Bg(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${No(r.value)}`;var r}).join(", ")}]`),vn(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(t)).join(", ")}]`),n.startAt&&(e+=", startAt: "+xi(n.startAt)),n.endAt&&(e+=", endAt: "+xi(n.endAt)),`Target(${e})`}function Oi(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!zg(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if(t=n.filters[i],r=e.filters[i],t.op!==r.op||!t.field.isEqual(r.field)||!qe(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Fl(n.startAt,e.startAt)&&Fl(n.endAt,e.endAt)}function Pi(n){return b.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var me=class extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.R(e,t,r):new Dl(e,t,r):t==="array-contains"?new Pl(e,r):t==="in"?new Ll(e,r):t==="not-in"?new xl(e,r):t==="array-contains-any"?new Ml(e,r):new me(e,t,r)}static R(e,t,r){return t==="in"?new Rl(e,r):new Cl(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.P(wn(t,this.value)):t!==null&&xt(this.value)===xt(t)&&this.P(wn(t,this.value))}P(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return S()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}};function jg(n){return n.field.canonicalString()+n.op.toString()+No(n.value)}var Dl=class extends me{constructor(e,t,r){super(e,t,r),this.key=b.fromName(r.referenceValue)}matches(e){let t=b.comparator(e.key,this.key);return this.P(t)}},Rl=class extends me{constructor(e,t){super(e,"in",t),this.keys=Ol("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Cl=class extends me{constructor(e,t){super(e,"not-in",t),this.keys=Ol("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Ol(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>b.fromName(r.referenceValue))}var Pl=class extends me{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ro(t)&&gr(t.arrayValue,this.value)}},Ll=class extends me{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&gr(this.value.arrayValue,t)}},xl=class extends me{constructor(e,t){super(e,"not-in",t)}matches(e){if(gr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!gr(this.value.arrayValue,t)}},Ml=class extends me{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ro(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>gr(this.value.arrayValue,r))}},Li=class{constructor(e,t){this.position=e,this.before=t}};function xi(n){return`${n.before?"b":"a"}:${n.position.map(e=>No(e)).join(",")}`}var In=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function zg(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function Ul(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=b.comparator(b.fromName(o.referenceValue),t.key):r=wn(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return n.before?r<=0:r<0}function Fl(n,e){if(n===null)return e===null;if(e===null||n.before!==e.before||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qe(n.position[t],e.position[t]))return!1;return!0}var wr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.V=null,this.S=null,this.startAt,this.endAt}};function $g(n,e,t,r,i,s,o,a){return new wr(n,e,t,r,i,s,o,a)}function Mi(n){return new wr(n)}function Ui(n){return!vn(n.limit)&&n.limitType==="F"}function Co(n){return!vn(n.limit)&&n.limitType==="L"}function Hg(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Kg(n){for(let e of n.filters)if(e.v())return e.field;return null}function Gg(n){return n.collectionGroup!==null}function Ir(n){let e=C(n);if(e.V===null){e.V=[];let t=Kg(e),r=Hg(e);if(t!==null&&r===null)t.isKeyField()||e.V.push(new In(t)),e.V.push(new In(ce.keyField(),"asc"));else{let i=!1;for(let s of e.explicitOrderBy)e.V.push(s),s.field.isKeyField()&&(i=!0);if(!i){let s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new In(ce.keyField(),s))}}}return e.V}function Ze(n){let e=C(n);if(!e.S)if(e.limitType==="F")e.S=kl(e.path,e.collectionGroup,Ir(e),e.filters,e.limit,e.startAt,e.endAt);else{let t=[];for(let s of Ir(e)){let o=s.dir==="desc"?"asc":"desc";t.push(new In(s.field,o))}let r=e.endAt?new Li(e.endAt.position,!e.endAt.before):null,i=e.startAt?new Li(e.startAt.position,!e.startAt.before):null;e.S=kl(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.S}function Wg(n,e,t){return new wr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Fi(n,e){return Oi(Ze(n),Ze(e))&&n.limitType===e.limitType}function Vl(n){return`${vr(Ze(n))}|lt:${n.limitType}`}function Oo(n){return`Query(target=${Bg(Ze(n))}; limitType=${n.limitType})`}function _r(n,e){return e.isFoundDocument()&&function(t,r){let i=r.key.path;return t.collectionGroup!==null?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):b.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(let i of t.explicitOrderBy)if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(t,r){for(let i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(t,r){return!(t.startAt&&!Ul(t.startAt,Ir(t),r)||t.endAt&&Ul(t.endAt,Ir(t),r))}(n,e)}function ql(n){return(e,t)=>{let r=!1;for(let i of Ir(n)){let s=Qg(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Qg(n,e,t){let r=n.field.isKeyField()?b.comparator(e.key,t.key):function(i,s,o){let a=s.data.field(i),c=o.data.field(i);return a!==null&&c!==null?wn(a,c):S()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return S()}}function Bl(n,e){if(n.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ri(e)?"-0":e}}function jl(n){return{integerValue:""+n}}function Yg(n,e){return qg(e)?jl(e):Bl(n,e)}var Er=class{constructor(){this._=void 0}};function Jg(n,e,t){return n instanceof _n?function(r,i){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):n instanceof Mt?$l(n,e):n instanceof Ut?Hl(n,e):function(r,i){let s=zl(r,i),o=Kl(s)+Kl(r.C);return Do(s)&&Do(r.C)?jl(o):Bl(r.N,o)}(n,e)}function Xg(n,e,t){return n instanceof Mt?$l(n,e):n instanceof Ut?Hl(n,e):t}function zl(n,e){return n instanceof En?Do(t=e)||function(r){return!!r&&"doubleValue"in r}(t)?e:{integerValue:0}:null;var t}var _n=class extends Er{},Mt=class extends Er{constructor(e){super(),this.elements=e}};function $l(n,e){let t=Gl(e);for(let r of n.elements)t.some(i=>qe(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ut=class extends Er{constructor(e){super(),this.elements=e}};function Hl(n,e){let t=Gl(e);for(let r of n.elements)t=t.filter(i=>!qe(i,r));return{arrayValue:{values:t}}}var En=class extends Er{constructor(e,t){super(),this.N=e,this.C=t}};function Kl(n){return Y(n.integerValue||n.doubleValue)}function Gl(n){return Ro(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Wl=class{constructor(e,t){this.field=e,this.transform=t}};function Zg(n,e){return n.field.isEqual(e.field)&&function(t,r){return t instanceof Mt&&r instanceof Mt||t instanceof Ut&&r instanceof Ut?pn(t.elements,r.elements,qe):t instanceof En&&r instanceof En?qe(t.C,r.C):t instanceof _n&&r instanceof _n}(n.transform,e.transform)}var Ql=class{constructor(e,t){this.version=e,this.transformResults=t}},Me=class{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Me}static exists(e){return new Me(void 0,e)}static updateTime(e){return new Me(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Vi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Tr=class{};function ey(n,e,t){n instanceof Tn?function(r,i,s){let o=r.value.clone(),a=Zl(r.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(n,e,t):n instanceof ht?function(r,i,s){if(!Vi(r.precondition,i))return void i.convertToUnknownDocument(s.version);let o=Zl(r.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(Xl(r)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):function(r,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Po(n,e,t){n instanceof Tn?function(r,i,s){if(!Vi(r.precondition,i))return;let o=r.value.clone(),a=eh(r.fieldTransforms,s,i);o.setAll(a),i.convertToFoundDocument(Jl(i),o).setHasLocalMutations()}(n,e,t):n instanceof ht?function(r,i,s){if(!Vi(r.precondition,i))return;let o=eh(r.fieldTransforms,s,i),a=i.data;a.setAll(Xl(r)),a.setAll(o),i.convertToFoundDocument(Jl(i),a).setHasLocalMutations()}(n,e,t):function(r,i){Vi(r.precondition,i)&&i.convertToNoDocument(P.min())}(n,e)}function ty(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=zl(r.transform,i||null);s!=null&&(t==null&&(t=we.empty()),t.set(r.field,s))}return t||null}function Yl(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(t,r){return t===void 0&&r===void 0||!(!t||!r)&&pn(t,r,(i,s)=>Zg(i,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}function Jl(n){return n.isFoundDocument()?n.version:P.min()}var Tn=class extends Tr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}},ht=class extends Tr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}};function Xl(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Zl(n,e,t){let r=new Map;O(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Xg(o,a,t[i]))}return r}function eh(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,Jg(s,o,e))}return r}var Lo=class extends Tr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}},xo=class extends Tr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}};var th=class{constructor(e){this.count=e}};var J,F;function ny(n){switch(n){case y.OK:return S();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0;default:return S()}}function nh(n){if(n===void 0)return ve("GRPC error has no .code"),y.UNKNOWN;switch(n){case J.OK:return y.OK;case J.CANCELLED:return y.CANCELLED;case J.UNKNOWN:return y.UNKNOWN;case J.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case J.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case J.INTERNAL:return y.INTERNAL;case J.UNAVAILABLE:return y.UNAVAILABLE;case J.UNAUTHENTICATED:return y.UNAUTHENTICATED;case J.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case J.NOT_FOUND:return y.NOT_FOUND;case J.ALREADY_EXISTS:return y.ALREADY_EXISTS;case J.PERMISSION_DENIED:return y.PERMISSION_DENIED;case J.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case J.ABORTED:return y.ABORTED;case J.OUT_OF_RANGE:return y.OUT_OF_RANGE;case J.UNIMPLEMENTED:return y.UNIMPLEMENTED;case J.DATA_LOSS:return y.DATA_LOSS;default:return S()}}(F=J||(J={}))[F.OK=0]="OK",F[F.CANCELLED=1]="CANCELLED",F[F.UNKNOWN=2]="UNKNOWN",F[F.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",F[F.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",F[F.NOT_FOUND=5]="NOT_FOUND",F[F.ALREADY_EXISTS=6]="ALREADY_EXISTS",F[F.PERMISSION_DENIED=7]="PERMISSION_DENIED",F[F.UNAUTHENTICATED=16]="UNAUTHENTICATED",F[F.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",F[F.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",F[F.ABORTED=10]="ABORTED",F[F.OUT_OF_RANGE=11]="OUT_OF_RANGE",F[F.UNIMPLEMENTED=12]="UNIMPLEMENTED",F[F.INTERNAL=13]="INTERNAL",F[F.UNAVAILABLE=14]="UNAVAILABLE",F[F.DATA_LOSS=15]="DATA_LOSS";var ne=class{constructor(e,t){this.comparator=e,this.root=t||re.EMPTY}insert(e,t){return new ne(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,re.BLACK,null,null))}remove(e){return new ne(this.comparator,this.root.remove(e,this.comparator).copy(null,null,re.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new br(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new br(this.root,e,this.comparator,!1)}getReverseIterator(){return new br(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new br(this.root,e,this.comparator,!0)}},br=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},re=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??re.RED,this.left=i??re.EMPTY,this.right=s??re.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new re(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return re.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return re.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,re.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,re.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw S();let e=this.left.check();if(e!==this.right.check())throw S();return e+(this.isRed()?0:1)}};re.EMPTY=null,re.RED=!0,re.BLACK=!1;re.EMPTY=new class{constructor(){this.size=0}get key(){throw S()}get value(){throw S()}get color(){throw S()}get left(){throw S()}get right(){throw S()}copy(n,e,t,r,i){return this}insert(n,e,t){return new re(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var K=class{constructor(e){this.comparator=e,this.data=new ne(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mo(this.data.getIterator())}getIteratorFrom(e){return new Mo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof K)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new K(this.comparator);return t.data=e,t}},Mo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ry=new ne(b.comparator);function Be(){return ry}var iy=new ne(b.comparator);function Uo(){return iy}var sy=new ne(b.comparator);function oy(){return sy}var ay=new K(b.comparator);function B(...n){let e=ay;for(let t of n)e=e.add(t);return e}var cy=new K(M);function rh(){return cy}var Sr=class{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t){let r=new Map;return r.set(e,bn.createSynthesizedTargetChangeForCurrentChange(e,t)),new Sr(P.min(),r,rh(),Be(),B())}},bn=class{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t){return new bn(te.EMPTY_BYTE_STRING,t,B(),B(),B())}};var Ar=class{constructor(e,t,r,i){this.k=e,this.removedTargetIds=t,this.key=r,this.$=i}},Fo=class{constructor(e,t){this.targetId=e,this.O=t}},Vo=class{constructor(e,t,r=te.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},qo=class{constructor(){this.F=0,this.M=oh(),this.L=te.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return this.F!==0}get K(){return this.U}j(e){e.approximateByteSize()>0&&(this.U=!0,this.L=e)}W(){let e=B(),t=B(),r=B();return this.M.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:S()}}),new bn(this.L,this.B,e,t,r)}G(){this.U=!1,this.M=oh()}H(e,t){this.U=!0,this.M=this.M.insert(e,t)}J(e){this.U=!0,this.M=this.M.remove(e)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}},ih=class{constructor(e){this.tt=e,this.et=new Map,this.nt=Be(),this.st=sh(),this.it=new K(M)}rt(e){for(let t of e.k)e.$&&e.$.isFoundDocument()?this.ot(t,e.$):this.at(t,e.key,e.$);for(let t of e.removedTargetIds)this.at(t,e.key,e.$)}ct(e){this.forEachTarget(e,t=>{let r=this.ut(t);switch(e.state){case 0:this.ht(t)&&r.j(e.resumeToken);break;case 1:r.X(),r.q||r.G(),r.j(e.resumeToken);break;case 2:r.X(),r.q||this.removeTarget(t);break;case 3:this.ht(t)&&(r.Z(),r.j(e.resumeToken));break;case 4:this.ht(t)&&(this.lt(t),r.j(e.resumeToken));break;default:S()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.et.forEach((r,i)=>{this.ht(i)&&t(i)})}ft(e){let t=e.targetId,r=e.O.count,i=this.dt(t);if(i){let s=i.target;if(Pi(s))if(r===0){let o=new b(s.path);this.at(t,o,G.newNoDocument(o,P.min()))}else O(r===1);else this.wt(t)!==r&&(this.lt(t),this.it=this.it.add(t))}}_t(e){let t=new Map;this.et.forEach((s,o)=>{let a=this.dt(o);if(a){if(s.current&&Pi(a.target)){let c=new b(a.target.path);this.nt.get(c)!==null||this.gt(o,c)||this.at(o,c,G.newNoDocument(c,e))}s.K&&(t.set(o,s.W()),s.G())}});let r=B();this.st.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.dt(c);return!u||u.purpose===2||(a=!1,!1)}),a&&(r=r.add(s))});let i=new Sr(e,t,this.it,this.nt,r);return this.nt=Be(),this.st=sh(),this.it=new K(M),i}ot(e,t){if(!this.ht(e))return;let r=this.gt(e,t.key)?2:0;this.ut(e).H(t.key,r),this.nt=this.nt.insert(t.key,t),this.st=this.st.insert(t.key,this.yt(t.key).add(e))}at(e,t,r){if(!this.ht(e))return;let i=this.ut(e);this.gt(e,t)?i.H(t,1):i.J(t),this.st=this.st.insert(t,this.yt(t).delete(e)),r&&(this.nt=this.nt.insert(t,r))}removeTarget(e){this.et.delete(e)}wt(e){let t=this.ut(e).W();return this.tt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Y(e){this.ut(e).Y()}ut(e){let t=this.et.get(e);return t||(t=new qo,this.et.set(e,t)),t}yt(e){let t=this.st.get(e);return t||(t=new K(M),this.st=this.st.insert(e,t)),t}ht(e){let t=this.dt(e)!==null;return t||w("WatchChangeAggregator","Detected inactive target",e),t}dt(e){let t=this.et.get(e);return t&&t.q?null:this.tt.Et(e)}lt(e){this.et.set(e,new qo),this.tt.getRemoteKeysForTarget(e).forEach(t=>{this.at(e,t,null)})}gt(e,t){return this.tt.getRemoteKeysForTarget(e).has(t)}};function sh(){return new ne(b.comparator)}function oh(){return new ne(b.comparator)}var uy=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),ly=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),ah=class{constructor(e,t){this.databaseId=e,this.D=t}};function Nr(n,e){return n.D?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ch(n,e){return n.D?e.toBase64():e.toUint8Array()}function hy(n,e){return Nr(n,e.toTimestamp())}function Ae(n){return O(!!n),P.fromTimestamp(function(e){let t=lt(e);return new ee(t.seconds,t.nanos)}(n))}function Bo(n,e){return function(t){return new q(["projects",t.projectId,"databases",t.database])}(n).child("documents").child(e).canonicalString()}function uh(n){let e=q.fromString(n);return O(Ih(e)),e}function qi(n,e){return Bo(n.databaseId,e.path)}function Ft(n,e){let t=uh(e);if(t.get(1)!==n.databaseId.projectId)throw new T(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new T(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new b(hh(t))}function jo(n,e){return Bo(n.databaseId,e)}function lh(n){let e=uh(n);return e.length===4?q.emptyPath():hh(e)}function zo(n){return new q(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function hh(n){return O(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function dh(n,e,t){return{name:qi(n,e),fields:t.value.mapValue.fields}}function dy(n,e,t){let r=Ft(n,e.name),i=Ae(e.updateTime),s=new we({mapValue:{fields:e.fields}}),o=G.newFoundDocument(r,i,s);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function fy(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:S()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.D?(O(u===void 0||typeof u=="string"),te.fromBase64String(u||"")):(O(u===void 0||u instanceof Uint8Array),te.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let u=c.code===void 0?y.UNKNOWN:nh(c.code);return new T(u,c.message||"")}(o);t=new Vo(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ft(n,r.document.name),s=Ae(r.document.updateTime),o=new we({mapValue:{fields:r.document.fields}}),a=G.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Ar(c,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ft(n,r.document),s=r.readTime?Ae(r.readTime):P.min(),o=G.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Ar([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ft(n,r.document),s=r.removedTargetIds||[];t=new Ar([],s,i,null)}else{if(!("filter"in e))return S();{e.filter;let r=e.filter;r.targetId;let i=r.count||0,s=new th(i),o=r.targetId;t=new Fo(o,s)}}return t}function $o(n,e){let t;if(e instanceof Tn)t={update:dh(n,e.key,e.value)};else if(e instanceof Lo)t={delete:qi(n,e.key)};else if(e instanceof ht)t={update:dh(n,e.key,e.data),updateMask:Iy(e.fieldMask)};else{if(!(e instanceof xo))return S();t={verify:qi(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,s){let o=s.transform;if(o instanceof _n)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Mt)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ut)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof En)return{fieldPath:s.field.canonicalString(),increment:o.C};throw S()}(0,r))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:hy(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:S()}(n,e.precondition)),t}function fh(n,e){let t=e.currentDocument?function(i){return i.updateTime!==void 0?Me.updateTime(Ae(i.updateTime)):i.exists!==void 0?Me.exists(i.exists):Me.none()}(e.currentDocument):Me.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let a=null;if("setToServerValue"in o)O(o.setToServerValue==="REQUEST_TIME"),a=new _n;else if("appendMissingElements"in o){let u=o.appendMissingElements.values||[];a=new Mt(u)}else if("removeAllFromArray"in o){let u=o.removeAllFromArray.values||[];a=new Ut(u)}else"increment"in o?a=new En(s,o.increment):S();let c=ce.fromServerFormat(o.fieldPath);return new Wl(c,a)}(n,i)):[];if(e.update){e.update.name;let i=Ft(n,e.update.name),s=new we({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(a){let c=a.fieldPaths||[];return new pr(c.map(u=>ce.fromServerFormat(u)))}(e.updateMask);return new ht(i,s,o,t,r)}return new Tn(i,s,t,r)}if(e.delete){let i=Ft(n,e.delete);return new Lo(i,t)}if(e.verify){let i=Ft(n,e.verify);return new xo(i,t)}return S()}function py(n,e){return n&&n.length>0?(O(e!==void 0),n.map(t=>function(r,i){let s=r.updateTime?Ae(r.updateTime):Ae(i);return s.isEqual(P.min())&&(s=Ae(i)),new Ql(s,r.transformResults||[])}(t,e))):[]}function ph(n,e){return{documents:[jo(n,e.path)]}}function mh(n,e){let t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=jo(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=jo(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);let i=function(a){if(a.length===0)return;let c=a.map(u=>function(l){if(l.op==="=="){if(Sl(l.value))return{unaryFilter:{field:Sn(l.field),op:"IS_NAN"}};if(bl(l.value))return{unaryFilter:{field:Sn(l.field),op:"IS_NULL"}}}else if(l.op==="!="){if(Sl(l.value))return{unaryFilter:{field:Sn(l.field),op:"IS_NOT_NAN"}};if(bl(l.value))return{unaryFilter:{field:Sn(l.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sn(l.field),op:yy(l.op),value:l.value}}}(u));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);i&&(t.structuredQuery.where=i);let s=function(a){if(a.length!==0)return a.map(c=>function(u){return{field:Sn(u.field),direction:gy(u.dir)}}(c))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let o=function(a,c){return a.D||vn(c)?c:{value:c}}(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=vh(e.startAt)),e.endAt&&(t.structuredQuery.endAt=vh(e.endAt)),t}function gh(n){let e=lh(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){O(r===1);let l=t.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];t.where&&(s=yh(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(l=>function(d){return new In(An(d.field),function(h){switch(h){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction))}(l)));let a=null;t.limit&&(a=function(l){let d;return d=typeof l=="object"?l.value:l,vn(d)?null:d}(t.limit));let c=null;t.startAt&&(c=wh(t.startAt));let u=null;return t.endAt&&(u=wh(t.endAt)),$g(e,i,o,s,a,"F",c,u)}function my(n,e){let t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return S()}}(0,e.purpose);return t==null?null:{"goog-listen-tags":t}}function yh(n){return n?n.unaryFilter!==void 0?[wy(n)]:n.fieldFilter!==void 0?[vy(n)]:n.compositeFilter!==void 0?n.compositeFilter.filters.map(e=>yh(e)).reduce((e,t)=>e.concat(t)):S():[]}function vh(n){return{before:n.before,values:n.position}}function wh(n){let e=!!n.before,t=n.values||[];return new Li(t,e)}function gy(n){return uy[n]}function yy(n){return ly[n]}function Sn(n){return{fieldPath:n.canonicalString()}}function An(n){return ce.fromServerFormat(n.fieldPath)}function vy(n){return me.create(An(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return S()}}(n.fieldFilter.op),n.fieldFilter.value)}function wy(n){switch(n.unaryFilter.op){case"IS_NAN":let e=An(n.unaryFilter.field);return me.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=An(n.unaryFilter.field);return me.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=An(n.unaryFilter.field);return me.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=An(n.unaryFilter.field);return me.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return S()}}function Iy(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ih(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Ue(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_h(e)),e=_y(n.get(t),e);return _h(e)}function _y(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function _h(n){return n+""}function et(n){let e=n.length;if(O(e>=2),e===2)return O(n.charAt(0)===""&&n.charAt(1)===""),q.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&S(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:S()}s=o+2}return new q(r)}var Eh=class{constructor(e,t){this.seconds=e,this.nanoseconds=t}},Ie=class{constructor(e,t,r){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=r}};Ie.store="owner",Ie.key="owner";var tt=class{constructor(e,t,r){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=r}};tt.store="mutationQueues",tt.keyPath="userId";var j=class{constructor(e,t,r,i,s){this.userId=e,this.batchId=t,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=s}};j.store="mutations",j.keyPath="batchId",j.userMutationsIndex="userMutationsIndex",j.userMutationsKeyPath=["userId","batchId"];var ue=class{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,Ue(t)]}static key(e,t,r){return[e,Ue(t),r]}};ue.store="documentMutations",ue.PLACEHOLDER=new ue;var Th=class{constructor(e,t){this.path=e,this.readTime=t}},bh=class{constructor(e,t){this.path=e,this.version=t}},W=class{constructor(e,t,r,i,s,o){this.unknownDocument=e,this.noDocument=t,this.document=r,this.hasCommittedMutations=i,this.readTime=s,this.parentPath=o}};W.store="remoteDocuments",W.readTimeIndex="readTimeIndex",W.readTimeIndexPath="readTime",W.collectionReadTimeIndex="collectionReadTimeIndex",W.collectionReadTimeIndexPath=["parentPath","readTime"];var Fe=class{constructor(e){this.byteSize=e}};Fe.store="remoteDocumentGlobal",Fe.key="remoteDocumentGlobalKey";var ge=class{constructor(e,t,r,i,s,o,a){this.targetId=e,this.canonicalId=t,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=s,this.lastLimboFreeSnapshotVersion=o,this.query=a}};ge.store="targets",ge.keyPath="targetId",ge.queryTargetsIndexName="queryTargetsIndex",ge.queryTargetsKeyPath=["canonicalId","targetId"];var ie=class{constructor(e,t,r){this.targetId=e,this.path=t,this.sequenceNumber=r}};ie.store="targetDocuments",ie.keyPath=["targetId","path"],ie.documentTargetsIndex="documentTargetsIndex",ie.documentTargetsKeyPath=["path","targetId"];var _e=class{constructor(e,t,r,i){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=r,this.targetCount=i}};_e.key="targetGlobalKey",_e.store="targetGlobal";var dt=class{constructor(e,t){this.collectionId=e,this.parent=t}};dt.store="collectionParents",dt.keyPath=["collectionId","parent"];var je=class{constructor(e,t,r,i){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=r,this.inForeground=i}};je.store="clientMetadata",je.keyPath="clientId";var Vt=class{constructor(e,t,r){this.bundleId=e,this.createTime=t,this.version=r}};Vt.store="bundles",Vt.keyPath="bundleId";var qt=class{constructor(e,t,r){this.name=e,this.readTime=t,this.bundledQuery=r}};qt.store="namedQueries",qt.keyPath="name";var Ey=[tt.store,j.store,ue.store,W.store,ge.store,Ie.store,_e.store,ie.store,je.store,Fe.store,dt.store,Vt.store,qt.store],Sh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ho=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};var g=class{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&S(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new g((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof g?t:g.resolve(t)}catch(t){return g.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):g.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):g.reject(t)}static resolve(e){return new g((t,r)=>{t(e)})}static reject(e){return new g((t,r)=>{r(e)})}static waitFor(e){return new g((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=g.resolve(!1);for(let r of e)t=t.next(i=>i?g.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}};var kr=class{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.Tt=new xe,this.transaction.oncomplete=()=>{this.Tt.resolve()},this.transaction.onabort=()=>{t.error?this.Tt.reject(new Nn(e,t.error)):this.Tt.resolve()},this.transaction.onerror=r=>{let i=Ko(r.target.error);this.Tt.reject(new Nn(e,i))}}static open(e,t,r,i){try{return new kr(t,e.transaction(i,r))}catch(s){throw new Nn(t,s)}}get It(){return this.Tt.promise}abort(e){e&&this.Tt.reject(e),this.aborted||(w("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){let t=this.transaction.objectStore(e);return new Nh(t)}},ze=class{constructor(e,t,r){this.name=e,this.version=t,this.At=r,ze.Rt(H())===12.2&&ve("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return w("SimpleDb","Removing database:",e),jt(window.indexedDB.deleteDatabase(e)).toPromise()}static Pt(){if(typeof indexedDB=="undefined")return!1;if(ze.bt())return!0;let e=H(),t=ze.Rt(e),r=0<t&&t<10,i=ze.vt(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static bt(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.Vt)==="YES"}static St(e,t){return e.store(t)}static Rt(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static vt(e){let t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async Dt(e){return this.db||(w("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Nn(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new T(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Nn(e,o))},i.onupgradeneeded=s=>{w("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.At.Ct(o,i.transaction,s.oldVersion,this.version).next(()=>{w("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.Nt&&(this.db.onversionchange=t=>this.Nt(t)),this.db}xt(e){this.Nt=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){let s=t==="readonly",o=0;for(;;){++o;try{this.db=await this.Dt(e);let a=kr.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).catch(u=>(a.abort(u),g.reject(u))).toPromise();return c.catch(()=>{}),await a.It,c}catch(a){let c=a.name!=="FirebaseError"&&o<3;if(w("SimpleDb","Transaction failed with error:",a.message,"Retrying:",c),this.close(),!c)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}},Ah=class{constructor(e){this.kt=e,this.$t=!1,this.Ot=null}get isDone(){return this.$t}get Ft(){return this.Ot}set cursor(e){this.kt=e}done(){this.$t=!0}Mt(e){this.Ot=e}delete(){return jt(this.kt.delete())}},Nn=class extends T{constructor(e,t){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Bt(n){return n.name==="IndexedDbTransactionError"}var Nh=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(w("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(w("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),jt(r)}add(e){return w("SimpleDb","ADD",this.store.name,e,e),jt(this.store.add(e))}get(e){return jt(this.store.get(e)).next(t=>(t===void 0&&(t=null),w("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return w("SimpleDb","DELETE",this.store.name,e),jt(this.store.delete(e))}count(){return w("SimpleDb","COUNT",this.store.name),jt(this.store.count())}Lt(e,t){let r=this.cursor(this.options(e,t)),i=[];return this.Bt(r,(s,o)=>{i.push(o)}).next(()=>i)}Ut(e,t){w("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.qt=!1;let i=this.cursor(r);return this.Bt(i,(s,o,a)=>a.delete())}Kt(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.Bt(i,t)}jt(e){let t=this.cursor({});return new g((r,i)=>{t.onerror=s=>{let o=Ko(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}Bt(e,t){let r=[];return new g((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new Ah(a),u=t(a.primaryKey,a.value,c);if(u instanceof g){let l=u.catch(d=>(c.done(),g.reject(d)));r.push(l)}c.isDone?i():c.Ft===null?a.continue():a.continue(c.Ft)}}).next(()=>g.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.qt?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function jt(n){return new g((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Ko(r.target.error);t(i)}})}var kh=!1;function Ko(n){let e=ze.Rt(H());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new T("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kh||(kh=!0,setTimeout(()=>{throw r},0)),r}}return n}var Go=class extends Ho{constructor(e,t){super(),this.Qt=e,this.currentSequenceNumber=t}};function Ee(n,e){let t=C(n);return ze.St(t.Qt,e)}var Bi=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&ey(s,e,r[i])}}applyToLocalView(e){for(let t of this.baseMutations)t.key.isEqual(e.key)&&Po(t,e,this.localWriteTime);for(let t of this.mutations)t.key.isEqual(e.key)&&Po(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(t=>{let r=e.get(t.key),i=r;this.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(P.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),B())}isEqual(e){return this.batchId===e.batchId&&pn(this.mutations,e.mutations,(t,r)=>Yl(t,r))&&pn(this.baseMutations,e.baseMutations,(t,r)=>Yl(t,r))}},ji=class{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){O(e.mutations.length===r.length);let i=oy(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ji(e,t,r,i)}};var nt=class{constructor(e,t,r,i,s=P.min(),o=P.min(),a=te.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new nt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new nt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new nt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}};var Wo=class{constructor(e){this.Wt=e}};function Dh(n,e){if(e.document)return dy(n.Wt,e.document,!!e.hasCommittedMutations);if(e.noDocument){let t=b.fromSegments(e.noDocument.path),r=Dn(e.noDocument.readTime),i=G.newNoDocument(t,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){let t=b.fromSegments(e.unknownDocument.path),r=Dn(e.unknownDocument.version);return G.newUnknownDocument(t,r)}return S()}function Rh(n,e,t){let r=Ch(t),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){let s=function(a,c){return{name:qi(a,c.key),fields:c.data.value.mapValue.fields,updateTime:Nr(a,c.version.toTimestamp())}}(n.Wt,e),o=e.hasCommittedMutations;return new W(null,null,s,o,r,i)}if(e.isNoDocument()){let s=e.key.path.toArray(),o=kn(e.version),a=e.hasCommittedMutations;return new W(null,new Th(s,o),null,a,r,i)}if(e.isUnknownDocument()){let s=e.key.path.toArray(),o=kn(e.version);return new W(new bh(s,o),null,null,!0,r,i)}return S()}function Ch(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ty(n){let e=new ee(n[0],n[1]);return P.fromTimestamp(e)}function kn(n){let e=n.toTimestamp();return new Eh(e.seconds,e.nanoseconds)}function Dn(n){let e=new ee(n.seconds,n.nanoseconds);return P.fromTimestamp(e)}function Rn(n,e){let t=(e.baseMutations||[]).map(s=>fh(n.Wt,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>fh(n.Wt,s)),i=ee.fromMillis(e.localWriteTimeMs);return new Bi(e.batchId,i,t,r)}function Dr(n){let e=Dn(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Dn(n.lastLimboFreeSnapshotVersion):P.min(),r;var i;return n.query.documents!==void 0?(O((i=n.query).documents.length===1),r=Ze(Mi(lh(i.documents[0])))):r=function(s){return Ze(gh(s))}(n.query),new nt(r,n.targetId,0,n.lastListenSequenceNumber,e,t,te.fromBase64String(n.resumeToken))}function Oh(n,e){let t=kn(e.snapshotVersion),r=kn(e.lastLimboFreeSnapshotVersion),i;i=Pi(e.target)?ph(n.Wt,e.target):mh(n.Wt,e.target);let s=e.resumeToken.toBase64();return new ge(e.targetId,vr(e.target),t,s,e.sequenceNumber,r,i)}function Ph(n){let e=gh({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wg(e,e.limit,"L"):e}var Lh=class{getBundleMetadata(e,t){return xh(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Dn(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return xh(e).put({bundleId:(r=t).id,createTime:kn(Ae(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return Mh(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Ph(i.bundledQuery),readTime:Dn(i.readTime)};var i})}saveNamedQuery(e,t){return Mh(e).put(function(r){return{name:r.name,readTime:kn(Ae(r.readTime)),bundledQuery:r.bundledQuery}}(t))}};function xh(n){return Ee(n,Vt.store)}function Mh(n){return Ee(n,qt.store)}var Uh=class{constructor(){this.Gt=new zi}addToCollectionParentIndex(e,t){return this.Gt.add(t),g.resolve()}getCollectionParents(e,t){return g.resolve(this.Gt.getEntries(t))}},zi=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new K(q.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new K(q.comparator)).toArray()}};var Fh=class{constructor(){this.zt=new zi}addToCollectionParentIndex(e,t){if(!this.zt.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.zt.add(t)});let s={collectionId:r,parent:Ue(i)};return Vh(e).put(s)}return g.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[vl(t),""],!1,!0);return Vh(e).Lt(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(et(o.parent))}return r})}};function Vh(n){return Ee(n,dt.store)}var qh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ye=class{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ye(e,ye.DEFAULT_COLLECTION_PERCENTILE,ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function Bh(n,e,t){let r=n.store(j.store),i=n.store(ue.store),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.Kt({range:o},(l,d,h)=>(a++,h.delete()));s.push(c.next(()=>{O(a===1)}));let u=[];for(let l of t.mutations){let d=ue.key(e,l.key.path,t.batchId);s.push(i.delete(d)),u.push(l.key)}return g.waitFor(s).next(()=>u)}function $i(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw S();e=n.noDocument}return JSON.stringify(e).length}ye.DEFAULT_COLLECTION_PERCENTILE=10,ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ye.DEFAULT=new ye(41943040,ye.DEFAULT_COLLECTION_PERCENTILE,ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ye.DISABLED=new ye(-1,0,0);var Hi=class{constructor(e,t,r,i){this.userId=e,this.N=t,this.Ht=r,this.referenceDelegate=i,this.Jt={}}static Yt(e,t,r,i){O(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new Hi(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ft(e).Kt({index:j.userMutationsIndex,range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Cn(e),o=ft(e);return o.add({}).next(a=>{O(typeof a=="number");let c=new Bi(a,t,r,i),u=function(h,f,m){let v=m.baseMutations.map(E=>$o(h.Wt,E)),I=m.mutations.map(E=>$o(h.Wt,E));return new j(f,m.batchId,m.localWriteTime.toMillis(),v,I)}(this.N,this.userId,c),l=[],d=new K((h,f)=>M(h.canonicalString(),f.canonicalString()));for(let h of i){let f=ue.key(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(u)),l.push(s.put(f,ue.PLACEHOLDER))}return d.forEach(h=>{l.push(this.Ht.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Jt[a]=c.keys()}),g.waitFor(l).next(()=>c)})}lookupMutationBatch(e,t){return ft(e).get(t).next(r=>r?(O(r.userId===this.userId),Rn(this.N,r)):null)}Xt(e,t){return this.Jt[t]?g.resolve(this.Jt[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Jt[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ft(e).Kt({index:j.userMutationsIndex,range:i},(o,a,c)=>{a.userId===this.userId&&(O(a.batchId>=r),s=Rn(this.N,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ft(e).Kt({index:j.userMutationsIndex,range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ft(e).Lt(j.userMutationsIndex,t).next(r=>r.map(i=>Rn(this.N,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=ue.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Cn(e).Kt({range:i},(o,a,c)=>{let[u,l,d]=o,h=et(l);if(u===this.userId&&t.path.isEqual(h))return ft(e).get(d).next(f=>{if(!f)throw S();O(f.userId===this.userId),s.push(Rn(this.N,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new K(M),i=[];return t.forEach(s=>{let o=ue.prefixForPath(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Cn(e).Kt({range:a},(u,l,d)=>{let[h,f,m]=u,v=et(f);h===this.userId&&s.path.isEqual(v)?r=r.add(m):d.done()});i.push(c)}),g.waitFor(i).next(()=>this.Zt(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=ue.prefixForPath(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new K(M);return Cn(e).Kt({range:o},(c,u,l)=>{let[d,h,f]=c,m=et(h);d===this.userId&&r.isPrefixOf(m)?m.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Zt(e,a))}Zt(e,t){let r=[],i=[];return t.forEach(s=>{i.push(ft(e).get(s).next(o=>{if(o===null)throw S();O(o.userId===this.userId),r.push(Rn(this.N,o))}))}),g.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Bh(e.Qt,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.te(t.batchId)}),g.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}te(e){delete this.Jt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return g.resolve();let r=IDBKeyRange.lowerBound(ue.prefixForUser(this.userId)),i=[];return Cn(e).Kt({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=et(s[1]);i.push(c)}else a.done()}).next(()=>{O(i.length===0)})})}containsKey(e,t){return jh(e,this.userId,t)}ee(e){return zh(e).get(this.userId).next(t=>t||new tt(this.userId,-1,""))}};function jh(n,e,t){let r=ue.prefixForPath(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Cn(n).Kt({range:s,qt:!0},(a,c,u)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),u.done()}).next(()=>o)}function ft(n){return Ee(n,j.store)}function Cn(n){return Ee(n,ue.store)}function zh(n){return Ee(n,tt.store)}var pt=class{constructor(e){this.ne=e}next(){return this.ne+=2,this.ne}static se(){return new pt(0)}static ie(){return new pt(-1)}};var $h=class{constructor(e,t){this.referenceDelegate=e,this.N=t}allocateTargetId(e){return this.re(e).next(t=>{let r=new pt(t.highestTargetId);return t.highestTargetId=r.next(),this.oe(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.re(e).next(t=>P.fromTimestamp(new ee(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.re(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.re(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.oe(e,i)))}addTargetData(e,t){return this.ae(e,t).next(()=>this.re(e).next(r=>(r.targetCount+=1,this.ce(t,r),this.oe(e,r))))}updateTargetData(e,t){return this.ae(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>On(e).delete(t.targetId)).next(()=>this.re(e)).next(r=>(O(r.targetCount>0),r.targetCount-=1,this.oe(e,r)))}removeTargets(e,t,r){let i=0,s=[];return On(e).Kt((o,a)=>{let c=Dr(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>g.waitFor(s)).next(()=>i)}forEachTarget(e,t){return On(e).Kt((r,i)=>{let s=Dr(i);t(s)})}re(e){return Hh(e).get(_e.key).next(t=>(O(t!==null),t))}oe(e,t){return Hh(e).put(_e.key,t)}ae(e,t){return On(e).put(Oh(this.N,t))}ce(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.re(e).next(t=>t.targetCount)}getTargetData(e,t){let r=vr(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return On(e).Kt({range:i,index:ge.queryTargetsIndexName},(o,a,c)=>{let u=Dr(a);Oi(t,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=mt(e);return t.forEach(o=>{let a=Ue(o.path);i.push(s.put(new ie(r,a))),i.push(this.referenceDelegate.addReference(e,r,o))}),g.waitFor(i)}removeMatchingKeys(e,t,r){let i=mt(e);return g.forEach(t,s=>{let o=Ue(s.path);return g.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=mt(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=mt(e),s=B();return i.Kt({range:r,qt:!0},(o,a,c)=>{let u=et(o[1]),l=new b(u);s=s.add(l)}).next(()=>s)}containsKey(e,t){let r=Ue(t.path),i=IDBKeyRange.bound([r],[vl(r)],!1,!0),s=0;return mt(e).Kt({index:ie.documentTargetsIndex,qt:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}Et(e,t){return On(e).get(t).next(r=>r?Dr(r):null)}};function On(n){return Ee(n,ge.store)}function Hh(n){return Ee(n,_e.store)}function mt(n){return Ee(n,ie.store)}async function Pn(n){if(n.code!==y.FAILED_PRECONDITION||n.message!==Sh)throw n;w("LocalStore","Unexpectedly lost primary lease")}function Kh([n,e],[t,r]){let i=M(n,t);return i===0?M(e,r):i}var Gh=class{constructor(e){this.ue=e,this.buffer=new K(Kh),this.he=0}le(){return++this.he}fe(e){let t=[e,this.le()];if(this.buffer.size<this.ue)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Kh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Wh=class{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.de=!1,this.we=null}start(e){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this._e(e)}stop(){this.we&&(this.we.cancel(),this.we=null)}get started(){return this.we!==null}_e(e){let t=this.de?3e5:6e4;w("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.we=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.we=null,this.de=!0;try{await e.collectGarbage(this.garbageCollector)}catch(r){Bt(r)?w("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Pn(r)}await this._e(e)})}},Qh=class{constructor(e,t){this.me=e,this.params=t}calculateTargetCount(e,t){return this.me.ge(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return g.resolve(Re.T);let r=new Gh(t);return this.me.forEachTarget(e,i=>r.fe(i.sequenceNumber)).next(()=>this.me.ye(e,i=>r.fe(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.me.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.me.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(w("LruGarbageCollector","Garbage collection skipped; disabled"),g.resolve(qh)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(w("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qh):this.pe(e,t))}getCacheSize(e){return this.me.getCacheSize(e)}pe(e,t){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(w("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,t))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),bo()<=U.DEBUG&&w("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),g.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};var Yh=class{constructor(e,t){this.db=e,this.garbageCollector=function(r,i){return new Qh(r,i)}(this,t)}ge(e){let t=this.Ee(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Ee(e){let t=0;return this.ye(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}ye(e,t){return this.Te(e,(r,i)=>t(i))}addReference(e,t,r){return Ki(e,r)}removeReference(e,t,r){return Ki(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Ki(e,t)}Ie(e,t){return function(r,i){let s=!1;return zh(r).jt(o=>jh(r,o,i).next(a=>(a&&(s=!0),g.resolve(!a)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Te(e,(o,a)=>{if(a<=t){let c=this.Ie(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o),mt(e).delete([0,Ue(o.path)])))});i.push(c)}}).next(()=>g.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Ki(e,t)}Te(e,t){let r=mt(e),i,s=Re.T;return r.Kt({index:ie.documentTargetsIndex},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==Re.T&&t(new b(et(i)),s),s=u,i=c):s=Re.T}).next(()=>{s!==Re.T&&t(new b(et(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Ki(n,e){return mt(n).put(function(t,r){return new ie(0,Ue(t.path),r)}(e,n.currentSequenceNumber))}var zt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i!==void 0){for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t])}else this.inner[r]=[[e,t]]}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),!0;return!1}forEach(e){mn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Il(this.inner)}};var Qo=class{constructor(){this.changes=new zt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}getReadTime(e){let t=this.changes.get(e);return t?t.readTime:P.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:G.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?g.resolve(r.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Jh=class{constructor(e,t){this.N=e,this.Ht=t}addEntry(e,t,r){return $t(e).put(Gi(t),r)}removeEntry(e,t){let r=$t(e),i=Gi(t);return r.delete(i)}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Ae(e,r)))}getEntry(e,t){return $t(e).get(Gi(t)).next(r=>this.Re(t,r))}Pe(e,t){return $t(e).get(Gi(t)).next(r=>({document:this.Re(t,r),size:$i(r)}))}getEntries(e,t){let r=Be();return this.be(e,t,(i,s)=>{let o=this.Re(i,s);r=r.insert(i,o)}).next(()=>r)}ve(e,t){let r=Be(),i=new ne(b.comparator);return this.be(e,t,(s,o)=>{let a=this.Re(s,o);r=r.insert(s,a),i=i.insert(s,$i(o))}).next(()=>({documents:r,Ve:i}))}be(e,t,r){if(t.isEmpty())return g.resolve();let i=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),s=t.getIterator(),o=s.getNext();return $t(e).Kt({range:i},(a,c,u)=>{let l=b.fromSegments(a);for(;o&&b.comparator(o,l)<0;)r(o,null),o=s.getNext();o&&o.isEqual(l)&&(r(o,c),o=s.hasNext()?s.getNext():null),o?u.Mt(o.path.toArray()):u.done()}).next(()=>{for(;o;)r(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r){let i=Be(),s=t.path.length+1,o={};if(r.isEqual(P.min())){let a=t.path.toArray();o.range=IDBKeyRange.lowerBound(a)}else{let a=t.path.toArray(),c=Ch(r);o.range=IDBKeyRange.lowerBound([a,c],!0),o.index=W.collectionReadTimeIndex}return $t(e).Kt(o,(a,c,u)=>{if(a.length!==s)return;let l=Dh(this.N,c);t.path.isPrefixOf(l.key.path)?_r(t,l)&&(i=i.insert(l.key,l)):u.done()}).next(()=>i)}newChangeBuffer(e){return new Xh(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Zh(e).get(Fe.key).next(t=>(O(!!t),t))}Ae(e,t){return Zh(e).put(Fe.key,t)}Re(e,t){if(t){let r=Dh(this.N,t);if(!(r.isNoDocument()&&r.version.isEqual(P.min())))return r}return G.newInvalidDocument(e)}},Xh=class extends Qo{constructor(e,t){super(),this.Se=e,this.trackRemovals=t,this.De=new zt(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new K((s,o)=>M(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.De.get(s);if(o.document.isValidDocument()){let c=Rh(this.Se.N,o.document,this.getReadTime(s));i=i.add(s.path.popLast()),r+=$i(c)-a,t.push(this.Se.addEntry(e,s,c))}else if(r-=a,this.trackRemovals){let c=Rh(this.Se.N,G.newNoDocument(s,P.min()),this.getReadTime(s));t.push(this.Se.addEntry(e,s,c))}else t.push(this.Se.removeEntry(e,s))}),i.forEach(s=>{t.push(this.Se.Ht.addToCollectionParentIndex(e,s))}),t.push(this.Se.updateMetadata(e,r)),g.waitFor(t)}getFromCache(e,t){return this.Se.Pe(e,t).next(r=>(this.De.set(t,r.size),r.document))}getAllFromCache(e,t){return this.Se.ve(e,t).next(({documents:r,Ve:i})=>(i.forEach((s,o)=>{this.De.set(s,o)}),r))}};function Zh(n){return Ee(n,Fe.store)}function $t(n){return Ee(n,W.store)}function Gi(n){return n.path.toArray()}var ed=class{constructor(e){this.N=e}Ct(e,t,r,i){O(r<i&&r>=0&&i<=11);let s=new kr("createOrUpgrade",t);r<1&&i>=1&&(function(a){a.createObjectStore(Ie.store)}(e),function(a){a.createObjectStore(tt.store,{keyPath:tt.keyPath}),a.createObjectStore(j.store,{keyPath:j.keyPath,autoIncrement:!0}).createIndex(j.userMutationsIndex,j.userMutationsKeyPath,{unique:!0}),a.createObjectStore(ue.store)}(e),td(e),function(a){a.createObjectStore(W.store)}(e));let o=g.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore(ie.store),a.deleteObjectStore(ge.store),a.deleteObjectStore(_e.store)}(e),td(e)),o=o.next(()=>function(a){let c=a.store(_e.store),u=new _e(0,0,P.min().toTimestamp(),0);return c.put(_e.key,u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(a,c){return c.store(j.store).Lt().next(u=>{a.deleteObjectStore(j.store),a.createObjectStore(j.store,{keyPath:j.keyPath,autoIncrement:!0}).createIndex(j.userMutationsIndex,j.userMutationsKeyPath,{unique:!0});let l=c.store(j.store),d=u.map(h=>l.put(h));return g.waitFor(d)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore(je.store,{keyPath:je.keyPath})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Ce(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore(Fe.store)}(e),this.Ne(s)))),r<7&&i>=7&&(o=o.next(()=>this.xe(s))),r<8&&i>=8&&(o=o.next(()=>this.ke(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e),function(a){let c=a.objectStore(W.store);c.createIndex(W.readTimeIndex,W.readTimeIndexPath,{unique:!1}),c.createIndex(W.collectionReadTimeIndex,W.collectionReadTimeIndexPath,{unique:!1})}(t)})),r<10&&i>=10&&(o=o.next(()=>this.$e(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore(Vt.store,{keyPath:Vt.keyPath})})(e),function(a){a.createObjectStore(qt.store,{keyPath:qt.keyPath})}(e)})),o}Ne(e){let t=0;return e.store(W.store).Kt((r,i)=>{t+=$i(i)}).next(()=>{let r=new Fe(t);return e.store(Fe.store).put(Fe.key,r)})}Ce(e){let t=e.store(tt.store),r=e.store(j.store);return t.Lt().next(i=>g.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.Lt(j.userMutationsIndex,o).next(a=>g.forEach(a,c=>{O(c.userId===s.userId);let u=Rn(this.N,c);return Bh(e,s.userId,u).next(()=>{})}))}))}xe(e){let t=e.store(ie.store),r=e.store(W.store);return e.store(_e.store).get(_e.key).next(i=>{let s=[];return r.Kt((o,a)=>{let c=new q(o),u=function(l){return[0,Ue(l)]}(c);s.push(t.get(u).next(l=>l?g.resolve():(d=>t.put(new ie(0,Ue(d),i.highestListenSequenceNumber)))(c)))}).next(()=>g.waitFor(s))})}ke(e,t){e.createObjectStore(dt.store,{keyPath:dt.keyPath});let r=t.store(dt.store),i=new zi,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Ue(c)})}};return t.store(W.store).Kt({qt:!0},(o,a)=>{let c=new q(o);return s(c.popLast())}).next(()=>t.store(ue.store).Kt({qt:!0},([o,a,c],u)=>{let l=et(a);return s(l.popLast())}))}$e(e){let t=e.store(ge.store);return t.Kt((r,i)=>{let s=Dr(i),o=Oh(this.N,s);return t.put(o)})}};function td(n){n.createObjectStore(ie.store,{keyPath:ie.keyPath}).createIndex(ie.documentTargetsIndex,ie.documentTargetsKeyPath,{unique:!0}),n.createObjectStore(ge.store,{keyPath:ge.keyPath}).createIndex(ge.queryTargetsIndexName,ge.queryTargetsKeyPath,{unique:!0}),n.createObjectStore(_e.store)}var Yo="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Wi=class{constructor(e,t,r,i,s,o,a,c,u,l){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Oe=s,this.window=o,this.document=a,this.Fe=u,this.Me=l,this.Le=null,this.Be=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ue=null,this.inForeground=!1,this.qe=null,this.Ke=null,this.je=Number.NEGATIVE_INFINITY,this.Qe=d=>Promise.resolve(),!Wi.Pt())throw new T(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Yh(this,i),this.We=t+"main",this.N=new Wo(c),this.Ge=new ze(this.We,11,new ed(this.N)),this.ze=new $h(this.referenceDelegate,this.N),this.Ht=new Fh,this.He=function(d,h){return new Jh(d,h)}(this.N,this.Ht),this.Je=new Lh,this.window&&this.window.localStorage?this.Ye=this.window.localStorage:(this.Ye=null,l===!1&&ve("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Xe().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new T(y.FAILED_PRECONDITION,Yo);return this.Ze(),this.tn(),this.en(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ze.getHighestSequenceNumber(e))}).then(e=>{this.Le=new Re(e,this.Fe)}).then(()=>{this.Be=!0}).catch(e=>(this.Ge&&this.Ge.close(),Promise.reject(e)))}nn(e){return this.Qe=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ge.xt(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Oe.enqueueAndForget(async()=>{this.started&&await this.Xe()}))}Xe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Qi(e).put(new je(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.sn(e).next(t=>{t||(this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)))})}).next(()=>this.rn(e)).next(t=>this.isPrimary&&!t?this.on(e).next(()=>!1):!!t&&this.an(e).next(()=>!0))).catch(e=>{if(Bt(e))return w("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return w("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Oe.enqueueRetryable(()=>this.Qe(e)),this.isPrimary=e})}sn(e){return Rr(e).get(Ie.key).next(t=>g.resolve(this.cn(t)))}un(e){return Qi(e).delete(this.clientId)}async hn(){if(this.isPrimary&&!this.ln(this.je,18e5)){this.je=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ee(t,je.store);return r.Lt().next(i=>{let s=this.fn(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return g.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ye)for(let t of e)this.Ye.removeItem(this.dn(t.clientId))}}en(){this.Ke=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Xe().then(()=>this.hn()).then(()=>this.en()))}cn(e){return!!e&&e.ownerId===this.clientId}rn(e){return this.Me?g.resolve(!0):Rr(e).get(Ie.key).next(t=>{if(t!==null&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)){if(this.cn(t)&&this.networkEnabled)return!0;if(!this.cn(t)){if(!t.allowTabSynchronization)throw new T(y.FAILED_PRECONDITION,Yo);return!1}}return!(!this.networkEnabled||!this.inForeground)||Qi(e).Lt().next(r=>this.fn(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&w("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Be=!1,this._n(),this.Ke&&(this.Ke.cancel(),this.Ke=null),this.mn(),this.gn(),await this.Ge.runTransaction("shutdown","readwrite",[Ie.store,je.store],e=>{let t=new Go(e,Re.T);return this.on(t).next(()=>this.un(t))}),this.Ge.close(),this.yn()}fn(e,t){return e.filter(r=>this.ln(r.updateTimeMs,t)&&!this.wn(r.clientId))}pn(){return this.runTransaction("getActiveClients","readonly",e=>Qi(e).Lt().next(t=>this.fn(t,18e5).map(r=>r.clientId)))}get started(){return this.Be}getMutationQueue(e){return Hi.Yt(e,this.N,this.Ht,this.referenceDelegate)}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getIndexManager(){return this.Ht}getBundleCache(){return this.Je}runTransaction(e,t,r){w("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s;return this.Ge.runTransaction(e,i,Ey,o=>(s=new Go(o,this.Le?this.Le.next():Re.T),t==="readwrite-primary"?this.sn(s).next(a=>!!a||this.rn(s)).next(a=>{if(!a)throw ve(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)),new T(y.FAILED_PRECONDITION,Sh);return r(s)}).next(a=>this.an(s).next(()=>a)):this.En(s).next(()=>r(s)))).then(o=>(s.raiseOnCommittedEvent(),o))}En(e){return Rr(e).get(Ie.key).next(t=>{if(t!==null&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)&&!this.cn(t)&&!(this.Me||this.allowTabSynchronization&&t.allowTabSynchronization))throw new T(y.FAILED_PRECONDITION,Yo)})}an(e){let t=new Ie(this.clientId,this.allowTabSynchronization,Date.now());return Rr(e).put(Ie.key,t)}static Pt(){return ze.Pt()}on(e){let t=Rr(e);return t.get(Ie.key).next(r=>this.cn(r)?(w("IndexedDbPersistence","Releasing primary lease."),t.delete(Ie.key)):g.resolve())}ln(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ve(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ze(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.qe=()=>{this.Oe.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Xe()))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground=this.document.visibilityState==="visible")}mn(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)}tn(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ue=()=>{this._n(),Fc()&&navigator.appVersion.match("Version/14")&&this.Oe.enterRestrictedMode(!0),this.Oe.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ue))}gn(){this.Ue&&(this.window.removeEventListener("pagehide",this.Ue),this.Ue=null)}wn(e){var t;try{let r=((t=this.Ye)===null||t===void 0?void 0:t.getItem(this.dn(e)))!==null;return w("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ve("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}_n(){if(this.Ye)try{this.Ye.setItem(this.dn(this.clientId),String(Date.now()))}catch(e){ve("Failed to set zombie client id.",e)}}yn(){if(this.Ye)try{this.Ye.removeItem(this.dn(this.clientId))}catch(e){}}dn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Rr(n){return Ee(n,Ie.store)}function Qi(n){return Ee(n,je.store)}function by(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Jo=class{constructor(e,t,r){this.He=e,this.In=t,this.Ht=r}An(e,t){return this.In.getAllMutationBatchesAffectingDocumentKey(e,t).next(r=>this.Rn(e,t,r))}Rn(e,t,r){return this.He.getEntry(e,t).next(i=>{for(let s of r)s.applyToLocalView(i);return i})}Pn(e,t){e.forEach((r,i)=>{for(let s of t)s.applyToLocalView(i)})}bn(e,t){return this.He.getEntries(e,t).next(r=>this.vn(e,r).next(()=>r))}vn(e,t){return this.In.getAllMutationBatchesAffectingDocumentKeys(e,t).next(r=>this.Pn(t,r))}getDocumentsMatchingQuery(e,t,r){return function(i){return b.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(t)?this.Vn(e,t.path):Gg(t)?this.Sn(e,t,r):this.Dn(e,t,r)}Vn(e,t){return this.An(e,new b(t)).next(r=>{let i=Uo();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}Sn(e,t,r){let i=t.collectionGroup,s=Uo();return this.Ht.getCollectionParents(e,i).next(o=>g.forEach(o,a=>{let c=function(u,l){return new wr(l,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(t,a.child(i));return this.Dn(e,c,r).next(u=>{u.forEach((l,d)=>{s=s.insert(l,d)})})}).next(()=>s))}Dn(e,t,r){let i,s;return this.He.getDocumentsMatchingQuery(e,t,r).next(o=>(i=o,this.In.getAllMutationBatchesAffectingQuery(e,t))).next(o=>(s=o,this.Cn(e,s,i).next(a=>{i=a;for(let c of s)for(let u of c.mutations){let l=u.key,d=i.get(l);d==null&&(d=G.newInvalidDocument(l),i=i.insert(l,d)),Po(u,d,c.localWriteTime),d.isFoundDocument()||(i=i.remove(l))}}))).next(()=>(i.forEach((o,a)=>{_r(t,a)||(i=i.remove(o))}),i))}Cn(e,t,r){let i=B();for(let o of t)for(let a of o.mutations)a instanceof ht&&r.get(a.key)===null&&(i=i.add(a.key));let s=r;return this.He.getEntries(e,i).next(o=>(o.forEach((a,c)=>{c.isFoundDocument()&&(s=s.insert(a,c))}),s))}};var Yi=class{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Nn=r,this.xn=i}static kn(e,t){let r=B(),i=B();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Yi(e,t.fromCache,r,i)}};var Xo=class{$n(e){this.On=e}getDocumentsMatchingQuery(e,t,r,i){return function(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(P.min())?this.Fn(e,t):this.On.bn(e,i).next(s=>{let o=this.Mn(t,s);return(Ui(t)||Co(t))&&this.Ln(t.limitType,o,i,r)?this.Fn(e,t):(bo()<=U.DEBUG&&w("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Oo(t)),this.On.getDocumentsMatchingQuery(e,t,r).next(a=>(o.forEach(c=>{a=a.insert(c.key,c)}),a)))})}Mn(e,t){let r=new K(ql(e));return t.forEach((i,s)=>{_r(e,s)&&(r=r.add(s))}),r}Ln(e,t,r,i){if(r.size!==t.size)return!0;let s=e==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Fn(e,t){return bo()<=U.DEBUG&&w("QueryEngine","Using full collection scan to execute query:",Oo(t)),this.On.getDocumentsMatchingQuery(e,t,P.min())}};var nd=class{constructor(e,t,r,i){this.persistence=e,this.Bn=t,this.N=i,this.Un=new ne(M),this.qn=new zt(s=>vr(s),Oi),this.Kn=P.min(),this.In=e.getMutationQueue(r),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new Jo(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Un))}};function rd(n,e,t,r){return new nd(n,e,t,r)}async function id(n,e){let t=C(n),r=t.In,i=t.Qn,s=await t.persistence.runTransaction("Handle user change","readonly",o=>{let a;return t.In.getAllMutationBatches(o).next(c=>(a=c,r=t.persistence.getMutationQueue(e),i=new Jo(t.jn,r,t.persistence.getIndexManager()),r.getAllMutationBatches(o))).next(c=>{let u=[],l=[],d=B();for(let h of a){u.push(h.batchId);for(let f of h.mutations)d=d.add(f.key)}for(let h of c){l.push(h.batchId);for(let f of h.mutations)d=d.add(f.key)}return i.bn(o,d).next(h=>({Wn:h,removedBatchIds:u,addedBatchIds:l}))})});return t.In=r,t.Qn=i,t.Bn.$n(t.Qn),s}function Sy(n,e){let t=C(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.jn.newChangeBuffer({trackRemovals:!0});return function(o,a,c,u){let l=c.batch,d=l.keys(),h=g.resolve();return d.forEach(f=>{h=h.next(()=>u.getEntry(a,f)).next(m=>{let v=c.docVersions.get(f);O(v!==null),m.version.compareTo(v)<0&&(l.applyToRemoteDocument(m,c),m.isValidDocument()&&u.addEntry(m,c.commitVersion))})}),h.next(()=>o.In.removeMutationBatch(a,l))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.In.performConsistencyCheck(r)).next(()=>t.Qn.bn(r,i))})}function sd(n){let e=C(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ze.getLastRemoteSnapshotVersion(t))}function Ay(n,e){let t=C(n),r=e.snapshotVersion,i=t.Un;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.jn.newChangeBuffer({trackRemovals:!0});i=t.Un;let a=[];e.targetChanges.forEach((u,l)=>{let d=i.get(l);if(!d)return;a.push(t.ze.removeMatchingKeys(s,u.removedDocuments,l).next(()=>t.ze.addMatchingKeys(s,u.addedDocuments,l)));let h=u.resumeToken;if(h.approximateByteSize()>0){let f=d.withResumeToken(h,r).withSequenceNumber(s.currentSequenceNumber);i=i.insert(l,f),function(m,v,I){return O(v.resumeToken.approximateByteSize()>0),m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(d,f,u)&&a.push(t.ze.updateTargetData(s,f))}});let c=Be();if(e.documentUpdates.forEach((u,l)=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(Ny(s,o,e.documentUpdates,r,void 0).next(u=>{c=u})),!r.isEqual(P.min())){let u=t.ze.getLastRemoteSnapshotVersion(s).next(l=>t.ze.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return g.waitFor(a).next(()=>o.apply(s)).next(()=>t.Qn.vn(s,c)).next(()=>c)}).then(s=>(t.Un=i,s))}function Ny(n,e,t,r,i){let s=B();return t.forEach(o=>s=s.add(o)),e.getEntries(n,s).next(o=>{let a=Be();return t.forEach((c,u)=>{let l=o.get(c),d=(i==null?void 0:i.get(c))||r;u.isNoDocument()&&u.version.isEqual(P.min())?(e.removeEntry(c,d),a=a.insert(c,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u,d),a=a.insert(c,u)):w("LocalStore","Ignoring outdated watch update for ",c,". Current version:",l.version," Watch version:",u.version)}),a})}function ky(n,e){let t=C(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.In.getNextMutationBatchAfterBatchId(r,e)))}function Dy(n,e){let t=C(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ze.getTargetData(r,e).next(s=>s?(i=s,g.resolve(i)):t.ze.allocateTargetId(r).next(o=>(i=new nt(e,o,0,r.currentSequenceNumber),t.ze.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Un.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Un=t.Un.insert(r.targetId,r),t.qn.set(e,r.targetId)),r})}async function Zo(n,e,t){let r=C(n),i=r.Un.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Bt(o))throw o;w("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Un=r.Un.remove(e),r.qn.delete(i.target)}function od(n,e,t){let r=C(n),i=P.min(),s=B();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,u){let l=C(a),d=l.qn.get(u);return d!==void 0?g.resolve(l.Un.get(d)):l.ze.getTargetData(c,u)}(r,o,Ze(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.ze.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Bn.getDocumentsMatchingQuery(o,e,t?i:P.min(),t?s:B())).next(a=>({documents:a,Gn:s})))}async function Ry(n){let e=C(n);return e.persistence.runTransaction("Synchronize last document change read time","readonly",t=>function(r){let i=$t(r),s=P.min();return i.Kt({index:W.readTimeIndex,reverse:!0},(o,a,c)=>{a.readTime&&(s=Ty(a.readTime)),c.done()}).next(()=>s)}(t)).then(t=>{e.Kn=t})}var ad=class{constructor(e){this.N=e,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return g.resolve(this.Yn.get(t))}saveBundleMetadata(e,t){var r;return this.Yn.set(t.id,{id:(r=t).id,version:r.version,createTime:Ae(r.createTime)}),g.resolve()}getNamedQuery(e,t){return g.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,function(r){return{name:r.name,query:Ph(r.bundledQuery),readTime:Ae(r.readTime)}}(t)),g.resolve()}};var Ji=class{constructor(){this.Zn=new K(X.ts),this.es=new K(X.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){let r=new X(e,t);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.rs(new X(e,t))}os(e,t){e.forEach(r=>this.removeReference(r,t))}cs(e){let t=new b(new q([])),r=new X(t,e),i=new X(t,e+1),s=[];return this.es.forEachInRange([r,i],o=>{this.rs(o),s.push(o.key)}),s}us(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){let t=new b(new q([])),r=new X(t,e),i=new X(t,e+1),s=B();return this.es.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new X(e,0),r=this.Zn.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},X=class{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return b.comparator(e.key,t.key)||M(e.ls,t.ls)}static ns(e,t){return M(e.ls,t.ls)||b.comparator(e.key,t.key)}};var cd=class{constructor(e,t){this.Ht=e,this.referenceDelegate=t,this.In=[],this.fs=1,this.ds=new K(X.ts)}checkEmpty(e){return g.resolve(this.In.length===0)}addMutationBatch(e,t,r,i){let s=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];let o=new Bi(s,t,r,i);this.In.push(o);for(let a of i)this.ds=this.ds.add(new X(a.key,s)),this.Ht.addToCollectionParentIndex(e,a.key.path.popLast());return g.resolve(o)}lookupMutationBatch(e,t){return g.resolve(this.ws(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this._s(r),s=i<0?0:i;return g.resolve(this.In.length>s?this.In[s]:null)}getHighestUnacknowledgedBatchId(){return g.resolve(this.In.length===0?-1:this.fs-1)}getAllMutationBatches(e){return g.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new X(t,0),i=new X(t,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([r,i],o=>{let a=this.ws(o.ls);s.push(a)}),g.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new K(M);return t.forEach(i=>{let s=new X(i,0),o=new X(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([s,o],a=>{r=r.add(a.ls)})}),g.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;b.isDocumentKey(s)||(s=s.child(""));let o=new X(new b(s),0),a=new K(M);return this.ds.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.ls)),!0)},o),g.resolve(this.gs(a))}gs(e){let t=[];return e.forEach(r=>{let i=this.ws(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){O(this.ys(t.batchId,"removed")===0),this.In.shift();let r=this.ds;return g.forEach(t.mutations,i=>{let s=new X(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=r})}te(e){}containsKey(e,t){let r=new X(t,0),i=this.ds.firstAfterOrEqual(r);return g.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.In.length,g.resolve()}ys(e,t){return this._s(e)}_s(e){return this.In.length===0?0:e-this.In[0].batchId}ws(e){let t=this._s(e);return t<0||t>=this.In.length?null:this.In[t]}};var ud=class{constructor(e,t){this.Ht=e,this.ps=t,this.docs=new ne(b.comparator),this.size=0}addEntry(e,t,r){let i=t.key,s=this.docs.get(i),o=s?s.size:0,a=this.ps(t);return this.docs=this.docs.insert(i,{document:t.clone(),size:a,readTime:r}),this.size+=a-o,this.Ht.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return g.resolve(r?r.document.clone():G.newInvalidDocument(t))}getEntries(e,t){let r=Be();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.clone():G.newInvalidDocument(i))}),g.resolve(r)}getDocumentsMatchingQuery(e,t,r){let i=Be(),s=new b(t.path.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){let{key:a,value:{document:c,readTime:u}}=o.getNext();if(!t.path.isPrefixOf(a.path))break;u.compareTo(r)<=0||_r(t,c)&&(i=i.insert(c.key,c.clone()))}return g.resolve(i)}Es(e,t){return g.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new ld(this)}getSize(e){return g.resolve(this.size)}},ld=class extends Qo{constructor(e){super(),this.Se=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.document.isValidDocument()?t.push(this.Se.addEntry(e,i.document,this.getReadTime(r))):this.Se.removeEntry(r)}),g.waitFor(t)}getFromCache(e,t){return this.Se.getEntry(e,t)}getAllFromCache(e,t){return this.Se.getEntries(e,t)}};var hd=class{constructor(e){this.persistence=e,this.Ts=new zt(t=>vr(t),Oi),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.Is=0,this.As=new Ji,this.targetCount=0,this.Rs=pt.se()}forEachTarget(e,t){return this.Ts.forEach((r,i)=>t(i)),g.resolve()}getLastRemoteSnapshotVersion(e){return g.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return g.resolve(this.Is)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),g.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Is&&(this.Is=t),g.resolve()}ae(e){this.Ts.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Rs=new pt(t),this.highestTargetId=t),e.sequenceNumber>this.Is&&(this.Is=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,g.resolve()}updateTargetData(e,t){return this.ae(t),g.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.cs(t.targetId),this.targetCount-=1,g.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Ts.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),g.waitFor(s).next(()=>i)}getTargetCount(e){return g.resolve(this.targetCount)}getTargetData(e,t){let r=this.Ts.get(t)||null;return g.resolve(r)}addMatchingKeys(e,t,r){return this.As.ss(t,r),g.resolve()}removeMatchingKeys(e,t,r){this.As.os(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),g.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.As.cs(t),g.resolve()}getMatchingKeysForTargetId(e,t){let r=this.As.hs(t);return g.resolve(r)}containsKey(e,t){return g.resolve(this.As.containsKey(t))}};var dd=class{constructor(e,t){this.Ps={},this.Le=new Re(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new hd(this),this.Ht=new Uh,this.He=function(r,i){return new ud(r,i)}(this.Ht,r=>this.referenceDelegate.bs(r)),this.N=new Wo(t),this.Je=new ad(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(e){let t=this.Ps[e.toKey()];return t||(t=new cd(this.Ht,this.referenceDelegate),this.Ps[e.toKey()]=t),t}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(e,t,r){w("MemoryPersistence","Starting transaction:",e);let i=new fd(this.Le.next());return this.referenceDelegate.vs(),r(i).next(s=>this.referenceDelegate.Vs(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ss(e,t){return g.or(Object.values(this.Ps).map(r=>()=>r.containsKey(e,t)))}},fd=class extends Ho{constructor(e){super(),this.currentSequenceNumber=e}},Xi=class{constructor(e){this.persistence=e,this.Ds=new Ji,this.Cs=null}static Ns(e){return new Xi(e)}get xs(){if(this.Cs)return this.Cs;throw S()}addReference(e,t,r){return this.Ds.addReference(r,t),this.xs.delete(r.toString()),g.resolve()}removeReference(e,t,r){return this.Ds.removeReference(r,t),this.xs.add(r.toString()),g.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),g.resolve()}removeTarget(e,t){this.Ds.cs(t.targetId).forEach(i=>this.xs.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.xs.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}vs(){this.Cs=new Set}Vs(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return g.forEach(this.xs,r=>{let i=b.fromPath(r);return this.ks(e,i).next(s=>{s||t.removeEntry(i)})}).next(()=>(this.Cs=null,t.apply(e)))}updateLimboDocument(e,t){return this.ks(e,t).next(r=>{r?this.xs.delete(t.toString()):this.xs.add(t.toString())})}bs(e){return 0}ks(e,t){return g.or([()=>g.resolve(this.Ds.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ss(e,t)])}};var ea=class{constructor(){this.activeTargetIds=rh()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ms(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Os(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ta=class{constructor(){this.yi=new ea,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.yi.Fs(e),this.pi[e]||"not-current"}updateQueryState(e,t,r){this.pi[e]=t}removeLocalQueryTarget(e){this.yi.Ms(e)}isLocalQueryTarget(e){return this.yi.activeTargetIds.has(e)}clearQueryState(e){delete this.pi[e]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(e){return this.yi.activeTargetIds.has(e)}start(){return this.yi=new ea,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}};var pd=class{Ei(e){}shutdown(){}};var na=class{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.Pi=[],this.bi()}Ei(e){this.Pi.push(e)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}bi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){w("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.Pi)e(0)}Ri(){w("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.Pi)e(1)}static Pt(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Cy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};var md=class{constructor(e){this.vi=e.vi,this.Vi=e.Vi}Si(e){this.Di=e}Ci(e){this.Ni=e}onMessage(e){this.xi=e}close(){this.Vi()}send(e){this.vi(e)}ki(){this.Di()}$i(e){this.Ni(e)}Oi(e){this.xi(e)}};var gd=class extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http";this.Fi=t+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(e,t,r,i){let s=this.Bi(e,t);w("RestConnection","Sending: ",s,r);let o={};return this.Ui(o,i),this.qi(e,s,o,r).then(a=>(w("RestConnection","Received: ",a),a),a=>{throw dl("RestConnection",`${e} failed with error: `,a,"url: ",s,"request:",r),a})}Ki(e,t,r,i){return this.Li(e,t,r,i)}Ui(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+fn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(let r in t.authHeaders)t.authHeaders.hasOwnProperty(r)&&(e[r]=t.authHeaders[r])}Bi(e,t){let r=Cy[e];return`${this.Fi}/v1/${t}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}qi(e,t,r,i){return new Promise((s,o)=>{let a=new hl;a.listenOnce(cl.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Di.NO_ERROR:let u=a.getResponseJson();w("Connection","XHR received:",JSON.stringify(u)),s(u);break;case Di.TIMEOUT:w("Connection",'RPC "'+e+'" timed out'),o(new T(y.DEADLINE_EXCEEDED,"Request time out"));break;case Di.HTTP_ERROR:let l=a.getStatus();if(w("Connection",'RPC "'+e+'" failed with status:',l,"response text:",a.getResponseText()),l>0){let d=a.getResponseJson().error;if(d&&d.status&&d.message){let h=function(f){let m=f.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(m)>=0?m:y.UNKNOWN}(d.status);o(new T(h,d.message))}else o(new T(y.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new T(y.UNAVAILABLE,"Connection failed."));break;default:S()}}finally{w("Connection",'RPC "'+e+'" completed.')}});let c=JSON.stringify(i);a.send(t,"POST",c,r,15)})}ji(e,t){let r=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=ol(),s=al(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new ll({})),this.Ui(o.initMessageHeaders,t),Wr()||Yr()||Mc()||Jr()||Uc()||Qr()||(o.httpHeadersOverwriteParam="$httpHeaders");let a=r.join("");w("Connection","Creating WebChannel: "+a,o);let c=i.createWebChannel(a,o),u=!1,l=!1,d=new md({vi:f=>{l?w("Connection","Not sending because WebChannel is closed:",f):(u||(w("Connection","Opening WebChannel transport."),c.open(),u=!0),w("Connection","WebChannel sending:",f),c.send(f))},Vi:()=>c.close()}),h=(f,m,v)=>{f.listen(m,I=>{try{v(I)}catch(E){setTimeout(()=>{throw E},0)}})};return h(c,fr.EventType.OPEN,()=>{l||w("Connection","WebChannel transport opened.")}),h(c,fr.EventType.CLOSE,()=>{l||(l=!0,w("Connection","WebChannel transport closed"),d.$i())}),h(c,fr.EventType.ERROR,f=>{l||(l=!0,dl("Connection","WebChannel transport errored:",f),d.$i(new T(y.UNAVAILABLE,"The operation could not be completed")))}),h(c,fr.EventType.MESSAGE,f=>{var m;if(!l){let v=f.data[0];O(!!v);let I=v,E=I.error||((m=I[0])===null||m===void 0?void 0:m.error);if(E){w("Connection","WebChannel received error:",E);let L=E.status,R=function(V){let x=J[V];if(x!==void 0)return nh(x)}(L),N=E.message;R===void 0&&(R=y.INTERNAL,N="Unknown error status: "+L+" with message "+E.message),l=!0,d.$i(new T(R,N)),c.close()}else w("Connection","WebChannel received:",v),d.Oi(v)}}),h(s,ul.STAT_EVENT,f=>{f.stat===To.PROXY?w("Connection","Detected buffering proxy"):f.stat===To.NOPROXY&&w("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.ki()},0),d}};function Oy(){return typeof window!="undefined"?window:null}function Zi(){return typeof document!="undefined"?document:null}function es(n){return new ah(n,!0)}var ra=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Oe=e,this.timerId=t,this.Qi=r,this.Wi=i,this.Gi=s,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(e){this.cancel();let t=Math.floor(this.zi+this.Zi()),r=Math.max(0,Date.now()-this.Ji),i=Math.max(0,t-r);i>0&&w("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.zi} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,i,()=>(this.Ji=Date.now(),e())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){this.Hi!==null&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){this.Hi!==null&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}};var ia=class{constructor(e,t,r,i,s,o){this.Oe=e,this.er=r,this.nr=i,this.credentialsProvider=s,this.listener=o,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new ra(e,t)}ar(){return this.state===1||this.state===2||this.state===4}cr(){return this.state===2}start(){this.state!==3?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&this.ir===null&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this.dr()))}wr(e){this._r(),this.stream.send(e)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(e,t){this._r(),this.rr.cancel(),this.sr++,e!==3?this.rr.reset():t&&t.code===y.RESOURCE_EXHAUSTED?(ve(t.toString()),ve("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):t&&t.code===y.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),this.stream!==null&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ci(t)}mr(){}auth(){this.state=1;let e=this.gr(this.sr),t=this.sr;this.credentialsProvider.getToken().then(r=>{this.sr===t&&this.yr(r)},r=>{e(()=>{let i=new T(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.pr(i)})})}yr(e){let t=this.gr(this.sr);this.stream=this.Er(e),this.stream.Si(()=>{t(()=>(this.state=2,this.listener.Si()))}),this.stream.Ci(r=>{t(()=>this.pr(r))}),this.stream.onMessage(r=>{t(()=>this.onMessage(r))})}ur(){this.state=4,this.rr.Xi(async()=>{this.state=0,this.start()})}pr(e){return w("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}gr(e){return t=>{this.Oe.enqueueAndForget(()=>this.sr===e?t():(w("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},yd=class extends ia{constructor(e,t,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,r,s),this.N=i}Er(e){return this.nr.ji("Listen",e)}onMessage(e){this.rr.reset();let t=fy(this.N,e),r=function(i){if(!("targetChange"in i))return P.min();let s=i.targetChange;return s.targetIds&&s.targetIds.length?P.min():s.readTime?Ae(s.readTime):P.min()}(e);return this.listener.Tr(t,r)}Ir(e){let t={};t.database=zo(this.N),t.addTarget=function(i,s){let o,a=s.target;return o=Pi(a)?{documents:ph(i,a)}:{query:mh(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=ch(i,s.resumeToken):s.snapshotVersion.compareTo(P.min())>0&&(o.readTime=Nr(i,s.snapshotVersion.toTimestamp())),o}(this.N,e);let r=my(this.N,e);r&&(t.labels=r),this.wr(t)}Ar(e){let t={};t.database=zo(this.N),t.removeTarget=e,this.wr(t)}},vd=class extends ia{constructor(e,t,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle",t,r,s),this.N=i,this.Rr=!1}get Pr(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.br([])}Er(e){return this.nr.ji("Write",e)}onMessage(e){if(O(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Rr){this.rr.reset();let t=py(e.writeResults,e.commitTime),r=Ae(e.commitTime);return this.listener.vr(r,t)}return O(!e.writeResults||e.writeResults.length===0),this.Rr=!0,this.listener.Vr()}Sr(){let e={};e.database=zo(this.N),this.wr(e)}br(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>$o(this.N,r))};this.wr(t)}};var wd=class extends class{}{constructor(e,t,r){super(),this.credentials=e,this.nr=t,this.N=r,this.Dr=!1}Cr(){if(this.Dr)throw new T(y.FAILED_PRECONDITION,"The client has already been terminated.")}Li(e,t,r){return this.Cr(),this.credentials.getToken().then(i=>this.nr.Li(e,t,r,i)).catch(i=>{throw i.name==="FirebaseError"?(i.code===y.UNAUTHENTICATED&&this.credentials.invalidateToken(),i):new T(y.UNKNOWN,i.toString())})}Ki(e,t,r){return this.Cr(),this.credentials.getToken().then(i=>this.nr.Ki(e,t,r,i)).catch(i=>{throw i.name==="FirebaseError"?(i.code===y.UNAUTHENTICATED&&this.credentials.invalidateToken(),i):new T(y.UNKNOWN,i.toString())})}terminate(){this.Dr=!0}},Id=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){this.Nr===0&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve())))}Lr(e){this.state==="Online"?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Fr("Offline")))}set(e){this.Br(),this.Nr=0,e==="Online"&&(this.$r=!1),this.Fr(e)}Fr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Mr(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(ve(t),this.$r=!1):w("OnlineStateTracker",t)}Br(){this.kr!==null&&(this.kr.cancel(),this.kr=null)}};var _d=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=s,this.Qr.Ei(o=>{r.enqueueAndForget(async()=>{Ht(this)&&(w("RemoteStore","Restarting streams for network reachability change."),await async function(a){let c=C(a);c.Kr.add(4),await Cr(c),c.Wr.set("Unknown"),c.Kr.delete(4),await ts(c)}(this))})}),this.Wr=new Id(r,i)}};async function ts(n){if(Ht(n))for(let e of n.jr)await e(!0)}async function Cr(n){for(let e of n.jr)await e(!1)}function Ed(n,e){let t=C(n);t.qr.has(e.targetId)||(t.qr.set(e.targetId,e),aa(t)?oa(t):Ln(t).cr()&&sa(t,e))}function Td(n,e){let t=C(n),r=Ln(t);t.qr.delete(e),r.cr()&&bd(t,e),t.qr.size===0&&(r.cr()?r.lr():Ht(t)&&t.Wr.set("Unknown"))}function sa(n,e){n.Gr.Y(e.targetId),Ln(n).Ir(e)}function bd(n,e){n.Gr.Y(e),Ln(n).Ar(e)}function oa(n){n.Gr=new ih({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.qr.get(e)||null}),Ln(n).start(),n.Wr.Or()}function aa(n){return Ht(n)&&!Ln(n).ar()&&n.qr.size>0}function Ht(n){return C(n).Kr.size===0}function Sd(n){n.Gr=void 0}async function Py(n){n.qr.forEach((e,t)=>{sa(n,e)})}async function Ly(n,e){Sd(n),aa(n)?(n.Wr.Lr(e),oa(n)):n.Wr.set("Unknown")}async function xy(n,e,t){if(n.Wr.set("Online"),e instanceof Vo&&e.state===2&&e.cause)try{await async function(r,i){let s=i.cause;for(let o of i.targetIds)r.qr.has(o)&&(await r.remoteSyncer.rejectListen(o,s),r.qr.delete(o),r.Gr.removeTarget(o))}(n,e)}catch(r){w("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ns(n,r)}else if(e instanceof Ar?n.Gr.rt(e):e instanceof Fo?n.Gr.ft(e):n.Gr.ct(e),!t.isEqual(P.min()))try{let r=await sd(n.localStore);t.compareTo(r)>=0&&await function(i,s){let o=i.Gr._t(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){let u=i.qr.get(c);u&&i.qr.set(c,u.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{let c=i.qr.get(a);if(!c)return;i.qr.set(a,c.withResumeToken(te.EMPTY_BYTE_STRING,c.snapshotVersion)),bd(i,a);let u=new nt(c.target,a,1,c.sequenceNumber);sa(i,u)}),i.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){w("RemoteStore","Failed to raise snapshot:",r),await ns(n,r)}}async function ns(n,e,t){if(!Bt(e))throw e;n.Kr.add(1),await Cr(n),n.Wr.set("Offline"),t||(t=()=>sd(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{w("RemoteStore","Retrying IndexedDB access"),await t(),n.Kr.delete(1),await ts(n)})}function Ad(n,e){return e().catch(t=>ns(n,t,e))}async function Or(n){let e=C(n),t=gt(e),r=e.Ur.length>0?e.Ur[e.Ur.length-1].batchId:-1;for(;My(e);)try{let i=await ky(e.localStore,r);if(i===null){e.Ur.length===0&&t.lr();break}r=i.batchId,Uy(e,i)}catch(i){await ns(e,i)}Nd(e)&&kd(e)}function My(n){return Ht(n)&&n.Ur.length<10}function Uy(n,e){n.Ur.push(e);let t=gt(n);t.cr()&&t.Pr&&t.br(e.mutations)}function Nd(n){return Ht(n)&&!gt(n).ar()&&n.Ur.length>0}function kd(n){gt(n).start()}async function Fy(n){gt(n).Sr()}async function Vy(n){let e=gt(n);for(let t of n.Ur)e.br(t.mutations)}async function qy(n,e,t){let r=n.Ur.shift(),i=ji.from(r,e,t);await Ad(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Or(n)}async function By(n,e){e&&gt(n).Pr&&await async function(t,r){if(i=r.code,ny(i)&&i!==y.ABORTED){let s=t.Ur.shift();gt(t).hr(),await Ad(t,()=>t.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Or(t)}var i}(n,e),Nd(n)&&kd(n)}async function jy(n,e){let t=C(n);e?(t.Kr.delete(2),await ts(t)):e||(t.Kr.add(2),await Cr(t),t.Wr.set("Unknown"))}function Ln(n){return n.zr||(n.zr=function(e,t,r){let i=C(e);return i.Cr(),new yd(t,i.nr,i.credentials,i.N,r)}(n.datastore,n.asyncQueue,{Si:Py.bind(null,n),Ci:Ly.bind(null,n),Tr:xy.bind(null,n)}),n.jr.push(async e=>{e?(n.zr.hr(),aa(n)?oa(n):n.Wr.set("Unknown")):(await n.zr.stop(),Sd(n))})),n.zr}function gt(n){return n.Hr||(n.Hr=function(e,t,r){let i=C(e);return i.Cr(),new vd(t,i.nr,i.credentials,i.N,r)}(n.datastore,n.asyncQueue,{Si:Fy.bind(null,n),Ci:By.bind(null,n),Vr:Vy.bind(null,n),vr:qy.bind(null,n)}),n.jr.push(async e=>{e?(n.Hr.hr(),await Or(n)):(await n.Hr.stop(),n.Ur.length>0&&(w("RemoteStore",`Stopping write stream with ${n.Ur.length} pending writes`),n.Ur=[]))})),n.Hr}var rs=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new xe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new rs(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new T(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ca(n,e){if(ve("AsyncQueue",`${e}: ${n}`),Bt(n))return new T(y.UNAVAILABLE,`${e}: ${n}`);throw n}var Kt=class{constructor(e){this.comparator=e?(t,r)=>e(t,r)||b.comparator(t.key,r.key):(t,r)=>b.comparator(t.key,r.key),this.keyedMap=Uo(),this.sortedSet=new ne(this.comparator)}static emptySet(e){return new Kt(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Kt)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new Kt;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var ua=class{constructor(){this.Jr=new ne(b.comparator)}track(e){let t=e.doc.key,r=this.Jr.get(t);r?e.type!==0&&r.type===3?this.Jr=this.Jr.insert(t,e):e.type===3&&r.type!==1?this.Jr=this.Jr.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Jr=this.Jr.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Jr=this.Jr.remove(t):e.type===1&&r.type===2?this.Jr=this.Jr.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):S():this.Jr=this.Jr.insert(t,e)}Yr(){let e=[];return this.Jr.inorderTraversal((t,r)=>{e.push(r)}),e}},Gt=class{constructor(e,t,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,t,r,i){let s=[];return t.forEach(o=>{s.push({type:0,doc:o})}),new Gt(e,t,Kt.emptySet(t),s,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Dd=class{constructor(){this.Xr=void 0,this.listeners=[]}},Rd=class{constructor(){this.queries=new zt(e=>Vl(e),Fi),this.onlineState="Unknown",this.Zr=new Set}};async function zy(n,e){let t=C(n),r=e.query,i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Dd),i)try{s.Xr=await t.onListen(r)}catch(o){let a=ca(o,`Initialization of query '${Oo(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.listeners.push(e),e.eo(t.onlineState),s.Xr&&e.no(s.Xr)&&la(t)}async function $y(n,e){let t=C(n),r=e.query,i=!1,s=t.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function Hy(n,e){let t=C(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.no(i)&&(r=!0);o.Xr=i}}r&&la(t)}function Ky(n,e,t){let r=C(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function la(n){n.Zr.forEach(e=>{e.next()})}var Cd=class{constructor(e,t,r){this.query=e,this.so=t,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=r||{}}no(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Gt(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.io?this.oo(e)&&(this.so.next(e),t=!0):this.ao(e,this.onlineState)&&(this.co(e),t=!0),this.ro=e,t}onError(e){this.so.error(e)}eo(e){this.onlineState=e;let t=!1;return this.ro&&!this.io&&this.ao(this.ro,e)&&(this.co(this.ro),t=!0),t}ao(e,t){if(!e.fromCache)return!0;let r=t!=="Offline";return(!this.options.uo||!r)&&(!e.docs.isEmpty()||t==="Offline")}oo(e){if(e.docChanges.length>0)return!0;let t=this.ro&&this.ro.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}co(e){e=Gt.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.io=!0,this.so.next(e)}};var ha=class{constructor(e){this.key=e}},da=class{constructor(e){this.key=e}},Od=class{constructor(e,t){this.query=e,this._o=t,this.mo=null,this.current=!1,this.yo=B(),this.mutatedKeys=B(),this.po=ql(e),this.Eo=new Kt(this.po)}get To(){return this._o}Io(e,t){let r=t?t.Ao:new ua,i=t?t.Eo:this.Eo,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=Ui(this.query)&&i.size===this.query.limit?i.last():null,u=Co(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=_r(this.query,d)?d:null,m=!!h&&this.mutatedKeys.has(h.key),v=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),I=!1;h&&f?h.data.isEqual(f.data)?m!==v&&(r.track({type:3,doc:f}),I=!0):this.Ro(h,f)||(r.track({type:2,doc:f}),I=!0,(c&&this.po(f,c)>0||u&&this.po(f,u)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),I=!0):h&&!f&&(r.track({type:1,doc:h}),I=!0,(c||u)&&(a=!0)),I&&(f?(o=o.add(f),s=v?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),Ui(this.query)||Co(this.query))for(;o.size>this.query.limit;){let l=Ui(this.query)?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Eo:o,Ao:r,Ln:a,mutatedKeys:s}}Ro(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){let i=this.Eo;this.Eo=e.Eo,this.mutatedKeys=e.mutatedKeys;let s=e.Ao.Yr();s.sort((u,l)=>function(d,h){let f=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return S()}};return f(d)-f(h)}(u.type,l.type)||this.po(u.doc,l.doc)),this.Po(r);let o=t?this.bo():[],a=this.yo.size===0&&this.current?1:0,c=a!==this.mo;return this.mo=a,s.length!==0||c?{snapshot:new Gt(this.query,e.Eo,i,s,e.mutatedKeys,a===0,c,!1),vo:o}:{vo:o}}eo(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new ua,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(e){return!this._o.has(e)&&!!this.Eo.has(e)&&!this.Eo.get(e).hasLocalMutations}Po(e){e&&(e.addedDocuments.forEach(t=>this._o=this._o.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._o=this._o.delete(t)),this.current=e.current)}bo(){if(!this.current)return[];let e=this.yo;this.yo=B(),this.Eo.forEach(r=>{this.Vo(r.key)&&(this.yo=this.yo.add(r.key))});let t=[];return e.forEach(r=>{this.yo.has(r)||t.push(new da(r))}),this.yo.forEach(r=>{e.has(r)||t.push(new ha(r))}),t}So(e){this._o=e.Gn,this.yo=B();let t=this.Io(e.documents);return this.applyChanges(t,!0)}Do(){return Gt.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,this.mo===0)}},Pd=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Ld=class{constructor(e){this.key=e,this.Co=!1}},xd=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.No={},this.xo=new zt(a=>Vl(a),Fi),this.ko=new Map,this.$o=new Set,this.Oo=new ne(b.comparator),this.Fo=new Map,this.Mo=new Ji,this.Lo={},this.Bo=new Map,this.Uo=pt.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return this.qo===!0}};async function Gy(n,e){let t=rv(n),r,i,s=t.xo.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Do();else{let o=await Dy(t.localStore,Ze(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await Wy(t,e,r,a==="current"),t.isPrimaryClient&&Ed(t.remoteStore,o)}return i}async function Wy(n,e,t,r){n.Ko=(l,d,h)=>async function(f,m,v,I){let E=m.view.Io(v);E.Ln&&(E=await od(f.localStore,m.query,!1).then(({documents:N})=>m.view.Io(N,E)));let L=I&&I.targetChanges.get(m.targetId),R=m.view.applyChanges(E,f.isPrimaryClient,L);return Bd(f,m.targetId,R.vo),R.snapshot}(n,l,d,h);let i=await od(n.localStore,e,!0),s=new Od(e,i.Gn),o=s.Io(i.documents),a=bn.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline"),c=s.applyChanges(o,n.isPrimaryClient,a);Bd(n,t,c.vo);let u=new Pd(e,t,s);return n.xo.set(e,u),n.ko.has(t)?n.ko.get(t).push(e):n.ko.set(t,[e]),c.snapshot}async function Qy(n,e){let t=C(n),r=t.xo.get(e),i=t.ko.get(r.targetId);if(i.length>1)return t.ko.set(r.targetId,i.filter(s=>!Fi(s,e))),void t.xo.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await Zo(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Td(t.remoteStore,r.targetId),fa(t,r.targetId)}).catch(Pn)):(fa(t,r.targetId),await Zo(t.localStore,r.targetId,!0))}async function Yy(n,e,t){let r=jd(n);try{let i=await function(s,o){let a=C(s),c=ee.now(),u=o.reduce((d,h)=>d.add(h.key),B()),l;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>a.Qn.bn(d,u).next(h=>{l=h;let f=[];for(let m of o){let v=ty(m,l.get(m.key));v!=null&&f.push(new ht(m.key,v,Al(v.value.mapValue),Me.exists(!0)))}return a.In.addMutationBatch(d,c,f,o)})).then(d=>(d.applyToLocalDocumentSet(l),{batchId:d.batchId,changes:l}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.Lo[s.currentUser.toKey()];c||(c=new ne(M)),c=c.insert(o,a),s.Lo[s.currentUser.toKey()]=c}(r,i.batchId,t),await Pr(r,i.changes),await Or(r.remoteStore)}catch(i){let s=ca(i,"Failed to persist write");t.reject(s)}}async function Md(n,e){let t=C(n);try{let r=await Ay(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fo.get(s);o&&(O(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Co=!0:i.modifiedDocuments.size>0?O(o.Co):i.removedDocuments.size>0&&(O(o.Co),o.Co=!1))}),await Pr(t,r,e)}catch(r){await Pn(r)}}function Ud(n,e,t){let r=C(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.xo.forEach((s,o)=>{let a=o.view.eo(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){let a=C(s);a.onlineState=o;let c=!1;a.queries.forEach((u,l)=>{for(let d of l.listeners)d.eo(o)&&(c=!0)}),c&&la(a)}(r.eventManager,e),i.length&&r.No.Tr(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Jy(n,e,t){let r=C(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fo.get(e),s=i&&i.key;if(s){let o=new ne(b.comparator);o=o.insert(s,G.newNoDocument(s,P.min()));let a=B().add(s),c=new Sr(P.min(),new Map,new K(M),o,a);await Md(r,c),r.Oo=r.Oo.remove(s),r.Fo.delete(e),pa(r)}else await Zo(r.localStore,e,!1).then(()=>fa(r,e,t)).catch(Pn)}async function Xy(n,e){let t=C(n),r=e.batch.batchId;try{let i=await Sy(t.localStore,e);Vd(t,r,null),Fd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Pr(t,i)}catch(i){await Pn(i)}}async function Zy(n,e,t){let r=C(n);try{let i=await function(s,o){let a=C(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return a.In.lookupMutationBatch(c,o).next(l=>(O(l!==null),u=l.keys(),a.In.removeMutationBatch(c,l))).next(()=>a.In.performConsistencyCheck(c)).next(()=>a.Qn.bn(c,u))})}(r.localStore,e);Vd(r,e,t),Fd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Pr(r,i)}catch(i){await Pn(i)}}function Fd(n,e){(n.Bo.get(e)||[]).forEach(t=>{t.resolve()}),n.Bo.delete(e)}function Vd(n,e,t){let r=C(n),i=r.Lo[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Lo[r.currentUser.toKey()]=i}}function fa(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.ko.get(e))n.xo.delete(r),t&&n.No.jo(r,t);n.ko.delete(e),n.isPrimaryClient&&n.Mo.cs(e).forEach(r=>{n.Mo.containsKey(r)||qd(n,r)})}function qd(n,e){n.$o.delete(e.path.canonicalString());let t=n.Oo.get(e);t!==null&&(Td(n.remoteStore,t),n.Oo=n.Oo.remove(e),n.Fo.delete(t),pa(n))}function Bd(n,e,t){for(let r of t)r instanceof ha?(n.Mo.addReference(r.key,e),ev(n,r)):r instanceof da?(w("SyncEngine","Document no longer in limbo: "+r.key),n.Mo.removeReference(r.key,e),n.Mo.containsKey(r.key)||qd(n,r.key)):S()}function ev(n,e){let t=e.key,r=t.path.canonicalString();n.Oo.get(t)||n.$o.has(r)||(w("SyncEngine","New document in limbo: "+t),n.$o.add(r),pa(n))}function pa(n){for(;n.$o.size>0&&n.Oo.size<n.maxConcurrentLimboResolutions;){let e=n.$o.values().next().value;n.$o.delete(e);let t=new b(q.fromString(e)),r=n.Uo.next();n.Fo.set(r,new Ld(t)),n.Oo=n.Oo.insert(t,r),Ed(n.remoteStore,new nt(Ze(Mi(t.path)),r,2,Re.T))}}async function Pr(n,e,t){let r=C(n),i=[],s=[],o=[];r.xo.isEmpty()||(r.xo.forEach((a,c)=>{o.push(r.Ko(c,e,t).then(u=>{if(u){r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u.fromCache?"not-current":"current"),i.push(u);let l=Yi.kn(c.targetId,u);s.push(l)}}))}),await Promise.all(o),r.No.Tr(i),await async function(a,c){let u=C(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",l=>g.forEach(c,d=>g.forEach(d.Nn,h=>u.persistence.referenceDelegate.addReference(l,d.targetId,h)).next(()=>g.forEach(d.xn,h=>u.persistence.referenceDelegate.removeReference(l,d.targetId,h)))))}catch(l){if(!Bt(l))throw l;w("LocalStore","Failed to update sequence numbers: "+l)}for(let l of c){let d=l.targetId;if(!l.fromCache){let h=u.Un.get(d),f=h.snapshotVersion,m=h.withLastLimboFreeSnapshotVersion(f);u.Un=u.Un.insert(d,m)}}}(r.localStore,s))}async function tv(n,e){let t=C(n);if(!t.currentUser.isEqual(e)){w("SyncEngine","User change. New user:",e.toKey());let r=await id(t.localStore,e);t.currentUser=e,function(i,s){i.Bo.forEach(o=>{o.forEach(a=>{a.reject(new T(y.CANCELLED,s))})}),i.Bo.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Pr(t,r.Wn)}}function nv(n,e){let t=C(n),r=t.Fo.get(e);if(r&&r.Co)return B().add(r.key);{let i=B(),s=t.ko.get(e);if(!s)return i;for(let o of s){let a=t.xo.get(o);i=i.unionWith(a.view.To)}return i}}function rv(n){let e=C(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Md.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jy.bind(null,e),e.No.Tr=Hy.bind(null,e.eventManager),e.No.jo=Ky.bind(null,e.eventManager),e}function jd(n){let e=C(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Xy.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Zy.bind(null,e),e}var ma=class{constructor(){this.synchronizeTabs=!1}async initialize(e){this.N=es(e.databaseInfo.databaseId),this.sharedClientState=this.Wo(e),this.persistence=this.Go(e),await this.persistence.start(),this.gcScheduler=this.zo(e),this.localStore=this.Ho(e)}zo(e){return null}Ho(e){return rd(this.persistence,new Xo,e.initialUser,this.N)}Go(e){return new dd(Xi.Ns,this.N)}Wo(e){return new ta}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}},zd=class extends ma{constructor(e,t,r){super(),this.Jo=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await Ry(this.localStore),await this.Jo.initialize(this,e),await jd(this.Jo.syncEngine),await Or(this.Jo.remoteStore),await this.persistence.nn(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve()))}Ho(e){return rd(this.persistence,new Xo,e.initialUser,this.N)}zo(e){let t=this.persistence.referenceDelegate.garbageCollector;return new Wh(t,e.asyncQueue)}Go(e){let t=by(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ye.withCacheSize(this.cacheSizeBytes):ye.DEFAULT;return new Wi(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Oy(),Zi(),this.N,this.sharedClientState,!!this.forceOwnership)}Wo(e){return new ta}};var ga=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ud(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tv.bind(null,this.syncEngine),await jy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Rd}createDatastore(e){let t=es(e.databaseInfo.databaseId),r=(i=e.databaseInfo,new gd(i));var i;return function(s,o,a){return new wd(s,o,a)}(e.credentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,s=a=>Ud(this.syncEngine,a,0),o=na.Pt()?new na:new pd,new _d(t,r,i,s,o);var t,r,i,s,o}createSyncEngine(e,t){return function(r,i,s,o,a,c,u){let l=new xd(r,i,s,o,a,c);return u&&(l.qo=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){let t=C(e);w("RemoteStore","RemoteStore shutting down."),t.Kr.add(5),await Cr(t),t.Qr.shutdown(),t.Wr.set("Unknown")}(this.remoteStore)}};var $d=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Yo(this.observer.next,e)}error(e){this.observer.error?this.Yo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Xo(){this.muted=!0}Yo(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Hd=class{constructor(e,t,r){this.credentials=e,this.asyncQueue=t,this.databaseInfo=r,this.user=pe.UNAUTHENTICATED,this.clientId=Ao.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(t,async i=>{w("FirestoreClient","Received user=",i.uid),await this.credentialListener(i),this.user=i})}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new T(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new xe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),e.resolve()}catch(t){let r=ca(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Kd(n,e){n.asyncQueue.verifyOperationInProgress(),w("FirestoreClient","Initializing OfflineComponentProvider");let t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await id(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}async function Gd(n,e){n.asyncQueue.verifyOperationInProgress();let t=await iv(n);w("FirestoreClient","Initializing OnlineComponentProvider");let r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>async function(s,o){let a=C(s);a.asyncQueue.verifyOperationInProgress(),w("RemoteStore","RemoteStore received new credentials");let c=Ht(a);a.Kr.add(3),await Cr(a),c&&a.Wr.set("Unknown"),await a.remoteSyncer.handleCredentialChange(o),a.Kr.delete(3),await ts(a)}(e.remoteStore,i)),n.onlineComponents=e}async function iv(n){return n.offlineComponents||(w("FirestoreClient","Using default OfflineComponentProvider"),await Kd(n,new ma)),n.offlineComponents}async function Wd(n){return n.onlineComponents||(w("FirestoreClient","Using default OnlineComponentProvider"),await Gd(n,new ga)),n.onlineComponents}function sv(n){return Wd(n).then(e=>e.syncEngine)}async function ov(n){let e=await Wd(n),t=e.eventManager;return t.onListen=Gy.bind(null,e.syncEngine),t.onUnlisten=Qy.bind(null,e.syncEngine),t}function av(n,e,t={}){let r=new xe;return n.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,c){let u=new $d({next:d=>{s.enqueueAndForget(()=>$y(i,l));let h=d.docs.has(o);!h&&d.fromCache?c.reject(new T(y.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&d.fromCache&&a&&a.source==="server"?c.reject(new T(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),l=new Cd(Mi(o.path),u,{includeMetadataChanges:!0,uo:!0});return zy(i,l)}(await ov(n),n.asyncQueue,e,t,r)),r.promise}var Qd=class{constructor(e,t,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}},xn=class{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof xn&&e.projectId===this.projectId&&e.database===this.database}};var Yd=new Map;function cv(n,e,t){if(!t)throw new T(y.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uv(n,e,t,r){if(e===!0&&r===!0)throw new T(y.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Jd(n){if(!b.isDocumentKey(n))throw new T(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ya(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(t){if(t.constructor){let r=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(r&&r.length>1)return r[1]}return null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":S()}function Lr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new T(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ya(n);throw new T(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var va=class{constructor(e){var t;if(e.host===void 0){if(e.ssl!==void 0)throw new T(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new T(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,uv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};var wa=class{constructor(e,t){this._credentials=t,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new va({}),this._settingsFrozen=!1,e instanceof xn?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new T(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xn(r.options.projectId)}(e))}get app(){if(!this._app)throw new T(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new T(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new va(e),e.credentials!==void 0&&(this._credentials=function(t){if(!t)return new pl;switch(t.type){case"gapi":let r=t.client;return O(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new yl(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new T(y.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=Yd.get(e);t&&(w("ComponentProvider","Removing Datastore"),Yd.delete(e),t.terminate())}(this),Promise.resolve()}};var Ne=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ne(this.firestore,e,this._key)}},is=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new is(this.firestore,e,this._query)}},Mn=class extends is{constructor(e,t,r){super(e,t,Mi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new b(e))}withConverter(e){return new Mn(this.firestore,e,this._path)}};function Ia(n,e,...t){if(n=be(n),arguments.length===1&&(e=Ao.I()),cv("doc","path",e),n instanceof wa){let r=q.fromString(e,...t);return Jd(r),new Ne(n,null,new b(r))}{if(!(n instanceof Ne||n instanceof Mn))throw new T(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(q.fromString(e,...t));return Jd(r),new Ne(n.firestore,n instanceof Mn?n.converter:null,new b(r))}}var Xd=class{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new ra(this,"async_queue_retry"),this.Ea=()=>{let t=Zi();t&&w("AsyncQueue","Visibility state changed to "+t.visibilityState),this.rr.tr()};let e=Zi();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ta(),this.Ia(e)}enterRestrictedMode(e){if(!this.wa){this.wa=!0,this.ya=e||!1;let t=Zi();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Ea)}}enqueue(e){if(this.Ta(),this.wa)return new Promise(()=>{});let t=new xe;return this.Ia(()=>this.wa&&this.ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.da.push(e),this.Aa()))}async Aa(){if(this.da.length!==0){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(e){if(!Bt(e))throw e;w("AsyncQueue","Operation failed with retryable error: "+e)}this.da.length>0&&this.rr.Xi(()=>this.Aa())}}Ia(e){let t=this.fa.then(()=>(this.ga=!0,e().catch(r=>{throw this.ma=r,this.ga=!1,ve("INTERNAL UNHANDLED ERROR: ",function(i){let s=i.message||"";return i.stack&&(s=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),s}(r)),r}).then(r=>(this.ga=!1,r))));return this.fa=t,t}enqueueAfterDelay(e,t,r){this.Ta(),this.pa.indexOf(e)>-1&&(t=0);let i=rs.createAndSchedule(this,e,t,r,s=>this.Ra(s));return this._a.push(i),i}Ta(){this.ma&&S()}verifyOperationInProgress(){}async Pa(){let e;do e=this.fa,await e;while(e!==this.fa)}ba(e){for(let t of this._a)if(t.timerId===e)return!0;return!1}va(e){return this.Pa().then(()=>{this._a.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._a)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pa()})}Va(e){this.pa.push(e)}Ra(e){let t=this._a.indexOf(e);this._a.splice(t,1)}};var xr=class extends wa{constructor(e,t){super(e,t),this.type="firestore",this._queue=new Xd,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||ef(this),this._firestoreClient.terminate()}};function Zd(n=ei()){return Wn(n,"firestore").getImmediate()}function _a(n){return n._firestoreClient||ef(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function ef(n){var e;let t=n._freezeSettings(),r=function(i,s,o,a){return new Qd(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,t);n._firestoreClient=new Hd(n._credentials,n._queue,r)}function tf(n,e){hv(n=Lr(n,xr));let t=_a(n),r=n._freezeSettings(),i=new ga;return lv(t,i,new zd(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function lv(n,e,t){let r=new xe;return n.asyncQueue.enqueue(async()=>{try{await Kd(n,t),await Gd(n,e),r.resolve()}catch(i){if(!function(s){return s.name==="FirebaseError"?s.code===y.FAILED_PRECONDITION||s.code===y.UNIMPLEMENTED:typeof DOMException!="undefined"&&s instanceof DOMException?s.code===22||s.code===20||s.code===11:!0}(i))throw i;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),r.reject(i)}}).then(()=>r.promise)}function hv(n){if(n._initialized||n._terminated)throw new T(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ss=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new T(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ce(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Wt=class{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wt(te.fromBase64String(e))}catch(t){throw new T(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wt(te.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ea=class{constructor(e){this._methodName=e}};var os=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new T(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new T(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return M(this._lat,e._lat)||M(this._long,e._long)}};var dv=/^__.*__$/,nf=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ht(e,this.data,this.fieldMask,t,this.fieldTransforms):new Tn(e,this.data,t,this.fieldTransforms)}};function rf(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw S()}}var as=class{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.N=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Sa(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(e){return new as(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Ca({path:r,xa:!1});return i.ka(e),i}$a(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Ca({path:r,xa:!1});return i.Sa(),i}Oa(e){return this.Ca({path:void 0,xa:!0})}Fa(e){return cs(e,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Sa(){if(this.path)for(let e=0;e<this.path.length;e++)this.ka(this.path.get(e))}ka(e){if(e.length===0)throw this.Fa("Document fields must not be empty");if(rf(this.Da)&&dv.test(e))throw this.Fa('Document fields cannot begin and end with "__"')}},sf=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.N=r||es(e)}Ba(e,t,r,i=!1){return new as({Da:e,methodName:t,La:r,path:ce.emptyPath(),xa:!1,Ma:i},this.databaseId,this.N,this.ignoreUndefinedProperties)}};function fv(n){let e=n._freezeSettings(),t=es(n._databaseId);return new sf(n._databaseId,!!e.ignoreUndefinedProperties,t)}function pv(n,e,t,r,i,s={}){let o=n.Ba(s.merge||s.mergeFields?2:0,e,t,i);uf("Data must be an object, but it was:",o,r);let a=af(r,o),c,u;if(s.merge)c=new pr(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=mv(e,d,t);if(!o.contains(h))throw new T(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);yv(l,h)||l.push(h)}c=new pr(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new nf(new we(a),c,u)}function of(n,e){if(cf(n=be(n)))return uf("Unsupported field value:",e,n),af(n,e);if(n instanceof Ea)return function(t,r){if(!rf(r.Da))throw r.Fa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Fa(`${t._methodName}() is not currently supported inside arrays`);let i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xa&&e.Da!==4)throw e.Fa("Nested arrays are not supported");return function(t,r){let i=[],s=0;for(let o of t){let a=of(o,r.Oa(s));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if((t=be(t))===null)return{nullValue:"NULL_VALUE"};if(typeof t=="number")return Yg(r.N,t);if(typeof t=="boolean")return{booleanValue:t};if(typeof t=="string")return{stringValue:t};if(t instanceof Date){let i=ee.fromDate(t);return{timestampValue:Nr(r.N,i)}}if(t instanceof ee){let i=new ee(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Nr(r.N,i)}}if(t instanceof os)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wt)return{bytesValue:ch(r.N,t._byteString)};if(t instanceof Ne){let i=r.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw r.Fa(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Bo(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.Fa(`Unsupported field value: ${ya(t)}`)}(n,e)}function af(n,e){let t={};return Il(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mn(n,(r,i)=>{let s=of(i,e.Na(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function cf(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ee||n instanceof os||n instanceof Wt||n instanceof Ne||n instanceof Ea)}function uf(n,e,t){if(!cf(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let r=ya(t);throw r==="an object"?e.Fa(n+" a custom object"):e.Fa(n+" "+r)}}function mv(n,e,t){if((e=be(e))instanceof ss)return e._internalPath;if(typeof e=="string")return lf(n,e);throw cs("Field path arguments must be of type string or FieldPath.",n,!1,void 0,t)}var gv=new RegExp("[~\\*/\\[\\]]");function lf(n,e,t){if(e.search(gv)>=0)throw cs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ss(...e.split("."))._internalPath}catch(r){throw cs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cs(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new T(y.INVALID_ARGUMENT,a+n+c)}function yv(n,e){return n.some(t=>t.isEqual(e))}var Ta=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new hf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(df("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},hf=class extends Ta{data(){return super.data()}};function df(n,e){return typeof e=="string"?lf(n,e):e instanceof ss?e._internalPath:e._delegate._internalPath}var ff=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ba=class extends Ta{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new pf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(df("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},pf=class extends ba{data(e={}){return super.data(e)}};var mf=class{convertValue(e,t="none"){switch(xt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Y(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw S()}}convertObject(e,t){let r={};return mn(e.fields,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new os(Y(e.latitude),Y(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=El(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(mr(e));default:return null}}convertTimestamp(e){let t=lt(e);return new ee(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=q.fromString(e);O(Ih(r));let i=new xn(r.get(1),r.get(3)),s=new b(r.popFirst(5));return i.isEqual(t)||ve(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function vv(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}function gf(n){n=Lr(n,Ne);let e=Lr(n.firestore,xr);return av(_a(e),n._key).then(t=>Iv(e,n,t))}var yf=class extends mf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,t)}};function vf(n,e,t){n=Lr(n,Ne);let r=Lr(n.firestore,xr),i=vv(n.converter,e,t);return wv(r,[pv(fv(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Me.none())])}function wv(n,e){return function(t,r){let i=new xe;return t.asyncQueue.enqueueAndForget(async()=>Yy(await sv(t),r,i)),i.promise}(_a(n),e)}function Iv(n,e,t){let r=t.docs.get(e._key),i=new yf(n);return new ba(n,i,e._key,r,new ff(t.hasPendingWrites,t.fromCache),e.converter)}var _v;(function(n){fn=n})(kt),Nt(new Ye("firestore",(n,{options:e})=>{let t=n.getProvider("app").getImmediate(),r=new xr(t,new ml(n.getProvider("auth-internal")));return e=Object.assign({useFetchStreams:!0},e),r._setSettings(e),r},"PUBLIC")),at("@firebase/firestore","3.0.1-2021730202621",_v);var Sa=Zd();function wf(){tf(Sa).catch(alert)}async function If(n){await vf(Ia(Sa,"plants","plants"),{plants:n})}async function _f(){return(await gf(Ia(Sa,"plants","plants"))).data().plants}function Ef(n){let e=document.createElement("a");e.setAttribute("href","data:text/json;charset=utf-8, "+encodeURIComponent(JSON.stringify(n))),e.setAttribute("download","grannyplant-backup.json"),e.click()}function Ev(n,e){return document.createElement(n,e)}function Tv(n,e,t){return document.createElementNS(n,e,t)}function bv(n){return document.createTextNode(n)}function Sv(n){return document.createComment(n)}function Av(n,e,t){n.insertBefore(e,t)}function Nv(n,e){n.removeChild(e)}function kv(n,e){n.appendChild(e)}function Dv(n){return n.parentNode}function Rv(n){return n.nextSibling}function Cv(n){return n.tagName}function Ov(n,e){n.textContent=e}function Pv(n){return n.textContent}function Lv(n){return n.nodeType===1}function xv(n){return n.nodeType===3}function Mv(n){return n.nodeType===8}var Tf={createElement:Ev,createElementNS:Tv,createTextNode:bv,createComment:Sv,insertBefore:Av,removeChild:Nv,appendChild:kv,parentNode:Dv,nextSibling:Rv,tagName:Cv,setTextContent:Ov,getTextContent:Pv,isElement:Lv,isText:xv,isComment:Mv};function Un(n,e,t,r,i){let s=e===void 0?void 0:e.key;return{sel:n,data:e,children:t,text:r,elm:i,key:s}}var Mr=Array.isArray;function Fn(n){return typeof n=="string"||typeof n=="number"||n instanceof String||n instanceof Number}function Aa(n){return n===void 0}function ke(n){return n!==void 0}var bf=Un("",{},[],void 0,void 0);function Ur(n,e){var t,r;let i=n.key===e.key,s=((t=n.data)===null||t===void 0?void 0:t.is)===((r=e.data)===null||r===void 0?void 0:r.is);return n.sel===e.sel&&i&&s}function Uv(n){return n.sel!==void 0}function Fv(n,e,t){var r;let i={};for(let s=e;s<=t;++s){let o=(r=n[s])===null||r===void 0?void 0:r.key;o!==void 0&&(i[o]=s)}return i}var Vv=["create","update","remove","destroy","pre","post"];function Na(n,e){let t={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},r=e!==void 0?e:Tf;for(let h of Vv)for(let f of n){let m=f[h];m!==void 0&&t[h].push(m)}function i(h){let f=h.id?"#"+h.id:"",m=h.getAttribute("class"),v=m?"."+m.split(" ").join("."):"";return Un(r.tagName(h).toLowerCase()+f+v,{},[],void 0,h)}function s(h,f){return function(){if(--f==0){let v=r.parentNode(h);r.removeChild(v,h)}}}function o(h,f){var m,v;let I,E=h.data;if(E!==void 0){let N=(m=E.hook)===null||m===void 0?void 0:m.init;ke(N)&&(N(h),E=h.data)}let L=h.children,R=h.sel;if(R==="!")Aa(h.text)&&(h.text=""),h.elm=r.createComment(h.text);else if(R!==void 0){let N=R.indexOf("#"),V=R.indexOf(".",N),x=N>0?N:R.length,$=V>0?V:R.length,De=N!==-1||V!==-1?R.slice(0,Math.min(x,$)):R,Te=h.elm=ke(E)&&ke(I=E.ns)?r.createElementNS(I,De,E):r.createElement(De,E);for(x<$&&Te.setAttribute("id",R.slice(x+1,$)),V>0&&Te.setAttribute("class",R.slice($+1).replace(/\./g," ")),I=0;I<t.create.length;++I)t.create[I](bf,h);if(Mr(L))for(I=0;I<L.length;++I){let Kn=L[I];Kn!=null&&r.appendChild(Te,o(Kn,f))}else Fn(h.text)&&r.appendChild(Te,r.createTextNode(h.text));let Pe=h.data.hook;ke(Pe)&&((v=Pe.create)===null||v===void 0||v.call(Pe,bf,h),Pe.insert&&f.push(h))}else h.elm=r.createTextNode(h.text);return h.elm}function a(h,f,m,v,I,E){for(;v<=I;++v){let L=m[v];L!=null&&r.insertBefore(h,o(L,E),f)}}function c(h){var f,m;let v=h.data;if(v!==void 0){(m=(f=v==null?void 0:v.hook)===null||f===void 0?void 0:f.destroy)===null||m===void 0||m.call(f,h);for(let I=0;I<t.destroy.length;++I)t.destroy[I](h);if(h.children!==void 0)for(let I=0;I<h.children.length;++I){let E=h.children[I];E!=null&&typeof E!="string"&&c(E)}}}function u(h,f,m,v){for(var I,E;m<=v;++m){let L,R,N=f[m];if(N!=null)if(ke(N.sel)){c(N),L=t.remove.length+1,R=s(N.elm,L);for(let x=0;x<t.remove.length;++x)t.remove[x](N,R);let V=(E=(I=N==null?void 0:N.data)===null||I===void 0?void 0:I.hook)===null||E===void 0?void 0:E.remove;ke(V)?V(N,R):R()}else r.removeChild(h,N.elm)}}function l(h,f,m,v){let I=0,E=0,L=f.length-1,R=f[0],N=f[L],V=m.length-1,x=m[0],$=m[V],De,Te,Pe,Kn;for(;I<=L&&E<=V;)R==null?R=f[++I]:N==null?N=f[--L]:x==null?x=m[++E]:$==null?$=m[--V]:Ur(R,x)?(d(R,x,v),R=f[++I],x=m[++E]):Ur(N,$)?(d(N,$,v),N=f[--L],$=m[--V]):Ur(R,$)?(d(R,$,v),r.insertBefore(h,R.elm,r.nextSibling(N.elm)),R=f[++I],$=m[--V]):Ur(N,x)?(d(N,x,v),r.insertBefore(h,N.elm,R.elm),N=f[--L],x=m[++E]):(De===void 0&&(De=Fv(f,I,L)),Te=De[x.key],Aa(Te)?r.insertBefore(h,o(x,v),R.elm):(Pe=f[Te],Pe.sel!==x.sel?r.insertBefore(h,o(x,v),R.elm):(d(Pe,x,v),f[Te]=void 0,r.insertBefore(h,Pe.elm,R.elm))),x=m[++E]);(I<=L||E<=V)&&(I>L?(Kn=m[V+1]==null?null:m[V+1].elm,a(h,Kn,m,E,V,v)):u(h,f,I,L))}function d(h,f,m){var v,I,E,L,R;let N=(v=f.data)===null||v===void 0?void 0:v.hook;(I=N==null?void 0:N.prepatch)===null||I===void 0||I.call(N,h,f);let V=f.elm=h.elm,x=h.children,$=f.children;if(h!==f){if(f.data!==void 0){for(let De=0;De<t.update.length;++De)t.update[De](h,f);(L=(E=f.data.hook)===null||E===void 0?void 0:E.update)===null||L===void 0||L.call(E,h,f)}Aa(f.text)?ke(x)&&ke($)?x!==$&&l(V,x,$,m):ke($)?(ke(h.text)&&r.setTextContent(V,""),a(V,null,$,0,$.length-1,m)):ke(x)?u(V,x,0,x.length-1):ke(h.text)&&r.setTextContent(V,""):h.text!==f.text&&(ke(x)&&u(V,x,0,x.length-1),r.setTextContent(V,f.text)),(R=N==null?void 0:N.postpatch)===null||R===void 0||R.call(N,h,f)}}return function(f,m){let v,I,E,L=[];for(v=0;v<t.pre.length;++v)t.pre[v]();for(Uv(f)||(f=i(f)),Ur(f,m)?d(f,m,L):(I=f.elm,E=r.parentNode(I),o(m,L),E!==null&&(r.insertBefore(E,m.elm,r.nextSibling(I)),u(E,[f],0,0))),v=0;v<L.length;++v)L[v].data.hook.insert(L[v]);for(v=0;v<t.post.length;++v)t.post[v]();return m}}function Sf(n,e,t){if(n.ns="http://www.w3.org/2000/svg",t!=="foreignObject"&&e!==void 0)for(let r=0;r<e.length;++r){let i=e[r].data;i!==void 0&&Sf(i,e[r].children,e[r].sel)}}function p(n,e,t){let r={},i,s,o;if(t!==void 0?(e!==null&&(r=e),Mr(t)?i=t:Fn(t)?s=t.toString():t&&t.sel&&(i=[t])):e!=null&&(Mr(e)?i=e:Fn(e)?s=e.toString():e&&e.sel?i=[e]:r=e),i!==void 0)for(o=0;o<i.length;++o)Fn(i[o])&&(i[o]=Un(void 0,void 0,void 0,i[o],void 0));return n[0]==="s"&&n[1]==="v"&&n[2]==="g"&&(n.length===3||n[3]==="."||n[3]==="#")&&Sf(r,i,n),Un(n,r,i,s,void 0)}var qv="http://www.w3.org/1999/xlink",Bv="http://www.w3.org/XML/1998/namespace",Af=58,jv=120;function Nf(n,e){let t,r=e.elm,i=n.data.attrs,s=e.data.attrs;if(!(!i&&!s)&&i!==s){i=i||{},s=s||{};for(t in s){let o=s[t];i[t]!==o&&(o===!0?r.setAttribute(t,""):o===!1?r.removeAttribute(t):t.charCodeAt(0)!==jv?r.setAttribute(t,o):t.charCodeAt(3)===Af?r.setAttributeNS(Bv,t,o):t.charCodeAt(5)===Af?r.setAttributeNS(qv,t,o):r.setAttribute(t,o))}for(t in i)t in s||r.removeAttribute(t)}}var ka={create:Nf,update:Nf};function kf(n,e){let t,r,i=e.elm,s=n.data.class,o=e.data.class;if(!(!s&&!o)&&s!==o){s=s||{},o=o||{};for(r in s)s[r]&&!Object.prototype.hasOwnProperty.call(o,r)&&i.classList.remove(r);for(r in o)t=o[r],t!==s[r]&&i.classList[t?"add":"remove"](r)}}var Da={create:kf,update:kf};function Df(n,e,t){if(typeof n=="function")n.call(e,t,e);else if(typeof n=="object")for(let r=0;r<n.length;r++)Df(n[r],e,t)}function zv(n,e){let t=n.type,r=e.data.on;r&&r[t]&&Df(r[t],e,n)}function $v(){return function n(e){zv(e,n.vnode)}}function Ra(n,e){let t=n.data.on,r=n.listener,i=n.elm,s=e&&e.data.on,o=e&&e.elm,a;if(t!==s){if(t&&r)if(s)for(a in t)s[a]||i.removeEventListener(a,r,!1);else for(a in t)i.removeEventListener(a,r,!1);if(s){let c=e.listener=n.listener||$v();if(c.vnode=e,t)for(a in s)t[a]||o.addEventListener(a,c,!1);else for(a in s)o.addEventListener(a,c,!1)}}}var Ca={create:Ra,update:Ra,destroy:Ra};function Rf(n,e){let t,r,i,s=e.elm,o=n.data.props,a=e.data.props;if(!(!o&&!a)&&o!==a){o=o||{},a=a||{};for(t in a)r=a[t],i=o[t],i!==r&&(t!=="value"||s[t]!==r)&&(s[t]=r)}}var Oa={create:Rf,update:Rf};var Cf=typeof window!="undefined"&&window.requestAnimationFrame.bind(window)||setTimeout,Hv=function(n){Cf(function(){Cf(n)})},Pa=!1;function Kv(n,e,t){Hv(function(){n[e]=t})}function Of(n,e){let t,r,i=e.elm,s=n.data.style,o=e.data.style;if(!s&&!o||s===o)return;s=s||{},o=o||{};let a="delayed"in s;for(r in s)o[r]||(r[0]==="-"&&r[1]==="-"?i.style.removeProperty(r):i.style[r]="");for(r in o)if(t=o[r],r==="delayed"&&o.delayed)for(let c in o.delayed)t=o.delayed[c],(!a||t!==s.delayed[c])&&Kv(i.style,c,t);else r!=="remove"&&t!==s[r]&&(r[0]==="-"&&r[1]==="-"?i.style.setProperty(r,t):i.style[r]=t)}function Gv(n){let e,t,r=n.elm,i=n.data.style;if(!(!i||!(e=i.destroy)))for(t in e)r.style[t]=e[t]}function Wv(n,e){let t=n.data.style;if(!t||!t.remove){e();return}Pa||(n.elm.offsetLeft,Pa=!0);let r,i=n.elm,s=0,o=t.remove,a=0,c=[];for(r in o)c.push(r),i.style[r]=o[r];let l=getComputedStyle(i)["transition-property"].split(", ");for(;s<l.length;++s)c.indexOf(l[s])!==-1&&a++;i.addEventListener("transitionend",function(d){d.target===i&&--a,a===0&&e()})}function Qv(){Pa=!1}var La={pre:Qv,create:Of,update:Of,destroy:Gv,remove:Wv};var us=[{name:"Raised bed along back of house",areas:["Opposite kitchen window","Back alpine bed, higher section","Back alpine bed, shed section","Back alpine bed, path corner","Rockface bed"]},{name:"Road fence bed",areas:[""]},{name:"Lawn Garden",areas:["Icky's seat and sundial bed","House end","Griselinia bed","Far corner","Far bed"]},{name:"Raised bed by lawn",areas:["Left alpine bed","Raised bed to daisy bush","Washing-pole bed","Raised bed from daisy bush to fence path","Fence path to woodshed"]},{name:"Central area",areas:["Right alpine bed","Fence","Bullnose bed","Main bed","Eucalyptus bed"]},{name:"Far woodland",areas:["Bottom","Centre","Slope above centre","Top","High up, left of path"]},{name:"Below mid path",areas:["Left hand slope","Centre panel","Pine tree to oak tree","Oak tree to escallonia"]},{name:"Between mid path and top path",areas:["From woodland to pine tree","From pine tree to oak tree","From oak tree to escallonia"]},{name:"Above top path",areas:["On the crag","High up to exit, right of path","From spruce trees to bench","From bench to stone seat","Stone seat area"]},{name:"Pond woodland",areas:["Left edge","Pond area, sides and front","Pond area, behind","Past pond","Slope apposite door"]},{name:"Gable end",areas:["Around fence by grass steps","Banking"]},{name:"Containers",areas:["At front, inside gate","At front, at lunchroom window","At front, at front door","At front, at sittingroom window","Roadside gable, at stone wall","Roadside gable, near postbox","Roadside gable, by wall bench","Roadside gable, by house wall","Garden gable, by bench","Centre, back path","Centre, circle","Centre, path corner","Centre, woodshed step","Top garden, by bench","Top garden, before pond","Top garden, at sheep gate"]}];function Ce(n){return us[n].name}function Oe(n,e){return us[n].areas[e]}var ls=us.length;function Vn(n){return us[n].areas.length}function hs(){return{areas:[],care:"",name:"",description:"",rhs:!1,size:""}}function Yv(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Pf=new nn("auth","Firebase",Yv());var Lf=new an("@firebase/auth");function ds(n,...e){Lf.logLevel<=U.ERROR&&Lf.error(`Auth (${kt}): ${n}`,...e)}function Ve(n,...e){throw xa(n,...e)}function $e(n,...e){return xa(n,...e)}function xa(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Pf.create(n,...e)}function A(n,e,...t){if(!n)throw xa(e,...t)}function rt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ds(e),new Error(e)}function it(n,e){n||rt(e)}var xf=new Map;function st(n){it(n instanceof Function,"Expected a class definition");let e=xf.get(n);return e?(it(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xf.set(n,e),e)}function Mf(n,e){let t=Wn(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(bt(s,e??{}))return i;Ve(i,"already-initialized")}return t.initialize({options:e})}function Jv(n,e){let t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(st);(e==null?void 0:e.errorMap)&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ma(){var n;return typeof self!="undefined"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Xv(){return Uf()==="http:"||Uf()==="https:"}function Uf(){var n;return typeof self!="undefined"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Zv(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xv()||Qr()||"connection"in navigator)?navigator.onLine:!0}function ew(){if(typeof navigator=="undefined")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var qn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,it(t>e,"Short delay should be less than long delay!"),this.isMobile=Wr()||Yr()}get(){return Zv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ua(n,e){it(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var fs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;rt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;rt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;rt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var tw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded"};var nw=new qn(3e4,6e4);function yt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function vt(n,e,t,r,i={}){return Ff(n,i,()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let a=rn(Object.assign({key:n.config.apiKey},o)).slice(1),c=new(fs.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",n._getSdkClientVersion()),n.languageCode&&c.set("X-Firebase-Locale",n.languageCode),fs.fetch()(Vf(n,n.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))})}async function Ff(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},tw),e);try{let i=new qf(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw ps(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=(s.ok?o.errorMessage:o.error.message).split(" : ")[0];if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ps(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ps(n,"email-already-in-use",o);let u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");Ve(n,u)}}catch(i){if(i instanceof tn)throw i;Ve(n,"network-request-failed")}}async function Qt(n,e,t,r,i={}){let s=await vt(n,e,t,r,i);return"mfaPendingCredential"in s&&Ve(n,"multi-factor-auth-required",{serverResponse:s}),s}function Vf(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Ua(n.config,i):`${n.config.apiScheme}://${i}`}var qf=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($e(this.auth,"timeout")),nw.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ps(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=$e(n,e,r);return i.customData._tokenResponse=t,i}async function rw(n,e){return vt(n,"POST","/v1/accounts:delete",e)}async function iw(n,e){return vt(n,"POST","/v1/accounts:lookup",e)}function Fr(n){if(!!n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}async function Bf(n,e=!1){let t=be(n),r=await t.getIdToken(e),i=Va(r);A(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Fr(Fa(i.auth_time)),issuedAtTime:Fr(Fa(i.iat)),expirationTime:Fr(Fa(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Fa(n){return Number(n)*1e3}function Va(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ds("JWT malformed, contained fewer than 3 sections"),null;try{let i=Lc(t);return i?JSON.parse(i):(ds("Failed to decode base64 JWT payload"),null)}catch(i){return ds("Caught error parsing JWT payload as JSON",i),null}}function sw(n){let e=Va(n);return A(e,"internal-error"),A(typeof e.exp!="undefined","internal-error"),A(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}async function Vr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof tn&&ow(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function ow({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var jf=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var qa=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fr(this.lastLoginAt),this.creationTime=Fr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function ms(n){var e;let t=n.auth,r=await n.getIdToken(),i=await Vr(n,iw(t,{idToken:r}));A(i==null?void 0:i.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=((e=s.providerUserInfo)===null||e===void 0?void 0:e.length)?cw(s.providerUserInfo):[],a=aw(n.providerData,o),c=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!(a==null?void 0:a.length),l=c?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new qa(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(n,d)}async function zf(n){let e=be(n);await ms(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aw(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function cw(n){return n.map(e=>{var{providerId:t}=e,r=Kr(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function uw(n,e){let t=await Ff(n,{},()=>{let r=rn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=Vf(n,i,"/v1/token",`key=${s}`);return fs.fetch()(o,{method:"POST",headers:{"X-Client-Version":n._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}var Bn=class{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){A(e.idToken,"internal-error"),A(typeof e.idToken!="undefined","internal-error"),A(typeof e.refreshToken!="undefined","internal-error");let t="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):sw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return A(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await uw(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Bn;return r&&(A(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(A(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(A(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bn,this.toJSON())}_performRefresh(){return rt("not implemented")}};function wt(n,e){A(typeof n=="string"||typeof n=="undefined","internal-error",{appName:e})}var It=class{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Kr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new jf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.metadata=new qa(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await Vr(this,this.stsTokenManager.getToken(this.auth,e));return A(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Bf(this,e)}reload(){return zf(this)}_assign(e){this!==e&&(A(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new It(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){A(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ms(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){let e=await this.getIdToken();return await Vr(this,rw(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,u,l;let d=(r=t.displayName)!==null&&r!==void 0?r:void 0,h=(i=t.email)!==null&&i!==void 0?i:void 0,f=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=t.photoURL)!==null&&o!==void 0?o:void 0,v=(a=t.tenantId)!==null&&a!==void 0?a:void 0,I=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,E=(u=t.createdAt)!==null&&u!==void 0?u:void 0,L=(l=t.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:R,emailVerified:N,isAnonymous:V,providerData:x,stsTokenManager:$}=t;A(R&&$,e,"internal-error");let De=Bn.fromJSON(this.name,$);A(typeof R=="string",e,"internal-error"),wt(d,e.name),wt(h,e.name),A(typeof N=="boolean",e,"internal-error"),A(typeof V=="boolean",e,"internal-error"),wt(f,e.name),wt(m,e.name),wt(v,e.name),wt(I,e.name),wt(E,e.name),wt(L,e.name);let Te=new It({uid:R,auth:e,email:h,emailVerified:N,displayName:d,isAnonymous:V,photoURL:m,phoneNumber:f,tenantId:v,stsTokenManager:De,createdAt:E,lastLoginAt:L});return x&&Array.isArray(x)&&(Te.providerData=x.map(Pe=>Object.assign({},Pe))),I&&(Te._redirectEventId=I),Te}static async _fromIdTokenResponse(e,t,r=!1){let i=new Bn;i.updateFromServerResponse(t);let s=new It({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ms(s),s}};var Ba=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};Ba.type="NONE";var ja=Ba;function gs(n,e,t){return`firebase:${n}:${e}:${t}`}var Yt=class{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=gs(this.userKey,i.apiKey,s),this.fullPersistenceKey=gs("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);return e?It._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Yt(st(ja),e,r);let i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u),s=i[0]||st(ja),o=gs(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let l=await u._get(o);if(l){let d=It._fromJSON(e,l);u!==s&&(a=d),s=u;break}}catch(l){}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Yt(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(o)}catch(l){}})),new Yt(s,e,r))}};function $f(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Gf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Hf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Qf(e))return"Blackberry";if(Yf(e))return"Webos";if(za(e))return"Safari";if((e.includes("chrome/")||Kf(e))&&!e.includes("edge/"))return"Chrome";if(Wf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Hf(n=H()){return/firefox\//i.test(n)}function za(n=H()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Kf(n=H()){return/crios\//i.test(n)}function Gf(n=H()){return/iemobile/i.test(n)}function Wf(n=H()){return/android/i.test(n)}function Qf(n=H()){return/blackberry/i.test(n)}function Yf(n=H()){return/webos/i.test(n)}function ys(n=H()){return/iphone|ipad|ipod/i.test(n)}function lw(n=H()){var e;return ys(n)&&!!((e=window.navigator)===null||e===void 0?void 0:e.standalone)}function hw(){return Jr()&&document.documentMode===10}function Jf(n=H()){return ys(n)||Wf(n)||Yf(n)||Qf(n)||/windows phone/i.test(n)||Gf(n)}function dw(){try{return!!(window&&window!==window.top)}catch(n){return!1}}function Xf(n,e=[]){let t;switch(n){case"Browser":t=$f(H());break;case"Worker":t=`${$f(H())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kt}/${r}`}var Zf=class{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $a(this),this.idTokenSubscription=new $a(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Pf,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=st(t)),this._initializationPromise=this.queue(async()=>{var r;this._deleted||(this.persistenceManager=await Yt.create(this,e),!this._deleted&&(((r=this._popupRedirectResolver)===null||r===void 0?void 0:r._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),!this._deleted&&(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e)}}async initializeCurrentUser(e){var t;let r=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let i=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,s=r==null?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);(!i||i===s)&&(o==null?void 0:o.user)&&(r=o.user)}return r?r._redirectEventId?(A(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)):this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(r){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ms(e)}catch(t){if(t.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ew()}async _delete(){this._deleted=!0}async updateCurrentUser(e){let t=e?be(e):null;return t&&A(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&A(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(st(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new nn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&st(e)||this._popupRedirectResolver;A(t,this,"argument-error"),this.redirectPersistenceManager=await Yt.create(this,[st(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return A(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof t=="function"?e.addObserver(t,r,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return A(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Xf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}};function vs(n){return be(n)}var $a=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Bc(t=>this.observer=t)}get next(){return A(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var jn=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return rt("not implemented")}_getIdTokenResponse(e){return rt("not implemented")}_linkToIdToken(e,t){return rt("not implemented")}_getReauthenticationResolver(e){return rt("not implemented")}};async function fw(n,e){return vt(n,"POST","/v1/accounts:update",e)}async function pw(n,e){return Qt(n,"POST","/v1/accounts:signInWithPassword",yt(n,e))}async function mw(n,e){return Qt(n,"POST","/v1/accounts:signInWithEmailLink",yt(n,e))}async function gw(n,e){return Qt(n,"POST","/v1/accounts:signInWithEmailLink",yt(n,e))}var Jt=class extends jn{constructor(e,t,r,i=null){super("password",r);this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Jt(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Jt(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if((t==null?void 0:t.email)&&(t==null?void 0:t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return pw(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return mw(e,{email:this._email,oobCode:this._password});default:Ve(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return fw(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return gw(e,{idToken:t,email:this._email,oobCode:this._password});default:Ve(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function zn(n,e){return Qt(n,"POST","/v1/accounts:signInWithIdp",yt(n,e))}var yw="http://localhost",ot=class extends jn{constructor(){super(...arguments);this.pendingToken=null}static _fromParams(e){let t=new ot(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ve("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Kr(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new ot(r,i);return Object.assign(o,s),o}_getIdTokenResponse(e){let t=this.buildRequest();return zn(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,zn(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,zn(e,t)}buildRequest(){let e={requestUri:yw,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=rn(t)}return e}};async function vw(n,e){return vt(n,"POST","/v1/accounts:sendVerificationCode",yt(n,e))}async function ww(n,e){return Qt(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,e))}async function Iw(n,e){let t=await Qt(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,e));if(t.temporaryProof)throw ps(n,"account-exists-with-different-credential",t);return t}var _w={USER_NOT_FOUND:"user-not-found"};async function Ew(n,e){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Qt(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,t),_w)}var _t=class extends jn{constructor(e){super("phone","phone");this.params=e}static _fromVerification(e,t){return new _t({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new _t({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return ww(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return Iw(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Ew(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new _t({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function Tw(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function bw(n){let e=sn(on(n)).link,t=e?sn(on(e)).deep_link_id:null,r=sn(on(n)).deep_link_id;return(r?sn(on(r)).link:null)||r||t||e||n}var qr=class{constructor(e){var t,r,i,s,o,a;let c=sn(on(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,l=(r=c.oobCode)!==null&&r!==void 0?r:null,d=Tw((i=c.mode)!==null&&i!==void 0?i:null);A(u&&l&&d,"argument-error"),this.apiKey=u,this.operation=d,this.code=l,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=bw(e);try{return new qr(t)}catch(r){return null}}};var Et=class{constructor(){this.providerId=Et.PROVIDER_ID}static credential(e,t){return Jt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=qr.parseLink(t);return A(r,"argument-error"),Jt._fromEmailAndCode(e,r.code,r.tenantId)}};Et.PROVIDER_ID="password";Et.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Et.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Ha=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var $n=class extends Ha{constructor(){super(...arguments);this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var He=class extends $n{constructor(){super("facebook.com")}static credential(e){return ot._fromParams({providerId:He.PROVIDER_ID,signInMethod:He.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return He.credentialFromTaggedObject(e)}static credentialFromError(e){return He.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return He.credential(e.oauthAccessToken)}catch(t){return null}}};He.FACEBOOK_SIGN_IN_METHOD="facebook.com";He.PROVIDER_ID="facebook.com";var Ke=class extends $n{constructor(){super("google.com");this.addScope("profile")}static credential(e,t){return ot._fromParams({providerId:Ke.PROVIDER_ID,signInMethod:Ke.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ke.credentialFromTaggedObject(e)}static credentialFromError(e){return Ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ke.credential(t,r)}catch(i){return null}}};Ke.GOOGLE_SIGN_IN_METHOD="google.com";Ke.PROVIDER_ID="google.com";var Ge=class extends $n{constructor(){super("github.com")}static credential(e){return ot._fromParams({providerId:Ge.PROVIDER_ID,signInMethod:Ge.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ge.credentialFromTaggedObject(e)}static credentialFromError(e){return Ge.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ge.credential(e.oauthAccessToken)}catch(t){return null}}};Ge.GITHUB_SIGN_IN_METHOD="github.com";Ge.PROVIDER_ID="github.com";var We=class extends $n{constructor(){super("twitter.com")}static credential(e,t){return ot._fromParams({providerId:We.PROVIDER_ID,signInMethod:We.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return We.credentialFromTaggedObject(e)}static credentialFromError(e){return We.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return We.credential(t,r)}catch(i){return null}}};We.TWITTER_SIGN_IN_METHOD="twitter.com";We.PROVIDER_ID="twitter.com";var Xt=class{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await It._fromIdTokenResponse(e,r,i),o=ep(r);return new Xt({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=ep(r);return new Xt({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function ep(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Br=class extends tn{constructor(e,t,r,i){var s;super(t.code,t.message);this.operationType=r,this.user=i,this.name="FirebaseError",Object.setPrototypeOf(this,Br.prototype),this.appName=e.name,this.code=t.code,this.tenantId=(s=e.tenantId)!==null&&s!==void 0?s:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,r,i){return new Br(e,t,r,i)}};function tp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Br._fromErrorAndOperation(n,s,e,r):s})}async function Sw(n,e,t=!1){let r=await Vr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Xt._forOperation(n,"link",r)}async function Aw(n,e,t=!1){let{auth:r}=n,i="reauthenticate";try{let s=await Vr(n,tp(r,i,e,n),t);A(s.idToken,r,"internal-error");let o=Va(s.idToken);A(o,r,"internal-error");let{sub:a}=o;return A(n.uid===a,r,"user-mismatch"),Xt._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ve(r,"user-mismatch"),s}}async function np(n,e,t=!1){let r="signIn",i=await tp(n,r,e),s=await Xt._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function rp(n,e){return np(vs(n),e)}function Ka(n,e,t){return rp(be(n),Et.credential(e,t))}function Ga(n,e,t,r){return be(n).onAuthStateChanged(e,t,r)}function Nw(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:n.tenantId},e))}var pE=new WeakMap;var ws="__sak";var Wa=class{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ws,"1"),this.storage.removeItem(ws),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}};function kw(){let n=H();return za(n)||ys(n)}var Dw=1e3,Rw=10,Qa=class extends Wa{constructor(){super(window.localStorage,"LOCAL");this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=kw()&&dw(),this.fallbackToPolling=Jf(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}let r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}let i=()=>{let o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);hw()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Rw):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Dw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};Qa.type="LOCAL";var ip=Qa;var Ya=class extends Wa{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}};Ya.type="SESSION";var Ja=Ya;function Cw(n){return Promise.all(n.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(t){return{fulfilled:!1,reason:t}}}))}var jr=class{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;let r=new jr(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o==null?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});let a=Array.from(o).map(async u=>u(t.origin,s)),c=await Cw(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};jr.receivers=[];function Xa(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var sp=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=Xa("",20);i.port1.start();let l=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(d){let h=d;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(h.data.response);break;default:clearTimeout(l),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function Qe(){return window}function Ow(n){Qe().location.href=n}function op(){return typeof Qe().WorkerGlobalScope!="undefined"&&typeof Qe().importScripts=="function"}async function Pw(){if(!(navigator==null?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(n){return null}}function Lw(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function xw(){return op()?self:null}var ap="firebaseLocalStorageDb",Mw=1,Is="firebaseLocalStorage",cp="fbase_key",Hn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function _s(n,e){return n.transaction([Is],e?"readwrite":"readonly").objectStore(Is)}function Uw(){let n=indexedDB.deleteDatabase(ap);return new Hn(n).toPromise()}function Za(){let n=indexedDB.open(ap,Mw);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Is,{keyPath:cp})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Is)?e(r):(r.close(),await Uw(),e(await Za()))})})}async function up(n,e,t){let r=_s(n,!0).put({[cp]:e,value:t});return new Hn(r).toPromise()}async function Fw(n,e){let t=_s(n,!1).get(e),r=await new Hn(t).toPromise();return r===void 0?null:r.value}function lp(n,e){let t=_s(n,!0).delete(e);return new Hn(t).toPromise()}var Vw=800,qw=3,ec=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Za(),this.db)}async _withRetries(e){let t=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(r){if(t++>qw)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return op()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jr._getInstance(xw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Pw(),!this.activeServiceWorker)return;this.sender=new sp(this.activeServiceWorker);let r=await this.sender._send("ping",{},800);!r||((e=r[0])===null||e===void 0?void 0:e.fulfilled)&&((t=r[0])===null||t===void 0?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Lw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await Za();return await up(e,ws,"1"),await lp(e,ws),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>up(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(r=>Fw(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lp(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(i=>{let s=_s(i,!1).getAll();return new Hn(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];let t=[],r=new Set;for(let{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(let i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Vw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};ec.type="LOCAL";var hp=ec;function Bw(n,e){return vt(n,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:n.tenantId},e))}function jw(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function zw(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=$e("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",jw().appendChild(r)})}function dp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var mE=dp("rcb"),gE=new qn(3e4,6e4);var $w="recaptcha";async function Hw(n,e,t){var r;let i=await t.verify();try{A(typeof i=="string",n,"argument-error"),A(t.type===$w,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return A(o.type==="enroll",n,"internal-error"),(await Nw(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{A(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return A(a,n,"missing-multi-factor-info"),(await Bw(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=await vw(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}}var Tt=class{constructor(e){this.providerId=Tt.PROVIDER_ID,this.auth=vs(e)}verifyPhoneNumber(e,t){return Hw(this.auth,e,be(t))}static credential(e,t){return _t._fromVerification(e,t)}static credentialFromResult(e){let t=e;return Tt.credentialFromTaggedObject(t)}static credentialFromError(e){return Tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?_t._fromTokenResponse(t,r):null}};Tt.PROVIDER_ID="phone";Tt.PHONE_SIGN_IN_METHOD="phone";function Kw(n,e){return e?st(e):(A(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Es=class extends jn{constructor(e){super("custom","custom");this.params=e}_getIdTokenResponse(e){return zn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return zn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return zn(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Gw(n){return np(n.auth,new Es(n),n.bypassAuthState)}function Ww(n){let{auth:e,user:t}=n;return A(t,e,"internal-error"),Aw(t,new Es(n),n.bypassAuthState)}async function Qw(n){let{auth:e,user:t}=n;return A(t,e,"internal-error"),Sw(t,new Es(n),n.bypassAuthState)}var tc=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Gw;case"linkViaPopup":case"linkViaRedirect":return Qw;case"reauthViaPopup":case"reauthViaRedirect":return Ww;default:Ve(this.auth,"internal-error")}}resolve(e){it(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){it(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Yw=new qn(2e3,1e4);var Zt=class extends tc{constructor(e,t,r,i,s){super(e,t,i,s);this.provider=r,this.authWindow=null,this.pollId=null,Zt.currentPopupAction&&Zt.currentPopupAction.cancel(),Zt.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return A(e,this.auth,"internal-error"),e}async onExecution(){it(this.filter.length===1,"Popup operations only handle one event");let e=Xa();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($e(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject($e(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zt.currentPopupAction=null}pollUserCancellation(){let e=()=>{var t,r;if((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0?void 0:r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($e(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,Yw.get())};e()}};Zt.currentPopupAction=null;var Jw="pendingRedirect",fp=new Map,pp=class extends tc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r);this.eventId=null}async execute(){let e=fp.get(this.auth._key());if(!e){try{let r=await Xw(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}fp.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Xw(n,e){let t=Zw(e),r=await mp(n)._get(t)==="true";return await mp(n)._remove(t),r}function mp(n){return st(n._redirectPersistence)}function Zw(n){return gs(Jw,n.config.apiKey,n.name)}async function eI(n,e,t=!1){let r=vs(n),i=Kw(r,e),o=await new pp(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var tI=10*60*1e3,gp=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!vp(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError($e(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tI&&this.cachedEventUids.clear(),this.cachedEventUids.has(yp(e))}saveEventToCache(e){this.cachedEventUids.add(yp(e)),this.lastProcessedEventTime=Date.now()}};function yp(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function vp({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vp(n);default:return!1}}async function rI(n,e={}){return vt(n,"GET","/v1/projects",e)}var iI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sI=/^https?/;async function oI(n){if(n.config.emulator)return;let{authorizedDomains:e}=await rI(n);for(let t of e)try{if(aI(t))return}catch(r){}Ve(n,"unauthorized-domain")}function aI(n){let e=Ma(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!sI.test(t))return!1;if(iI.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var cI=new qn(3e4,6e4);function wp(){let n=Qe().___jsl;if(n==null?void 0:n.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function uI(n){return new Promise((e,t)=>{var r,i,s;function o(){wp(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wp(),t($e(n,"network-request-failed"))},timeout:cI.get()})}if((i=(r=Qe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0?void 0:i.Iframe)e(gapi.iframes.getContext());else if((s=Qe().gapi)===null||s===void 0?void 0:s.load)o();else{let a=dp("iframefcb");return Qe()[a]=()=>{gapi.load?o():t($e(n,"network-request-failed"))},zw(`https://apis.google.com/js/api.js?onload=${a}`)}}).catch(e=>{throw Ts=null,e})}var Ts=null;function lI(n){return Ts=Ts||uI(n),Ts}var hI=new qn(5e3,15e3),dI="__/auth/iframe",fI="emulator/auth/iframe",pI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},mI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gI(n){let e=n.config;A(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Ua(e,fI):`https://${n.config.authDomain}/${dI}`,r={apiKey:e.apiKey,appName:n.name,v:kt},i=mI.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${rn(r).slice(1)}`}async function yI(n){let e=await lI(n),t=Qe().gapi;return A(t,n,"internal-error"),e.open({where:document.body,url:gI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pI,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=$e(n,"network-request-failed"),a=Qe().setTimeout(()=>{s(o)},hI.get());function c(){Qe().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}var vI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wI=500,II=600,_I="_blank",EI="http://localhost",nc=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}};function TI(n,e,t,r=wI,i=II){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},vI),{width:r.toString(),height:i.toString(),top:s,left:o}),u=H().toLowerCase();t&&(a=Kf(u)?_I:t),Hf(u)&&(e=e||EI,c.scrollbars="yes");let l=Object.entries(c).reduce((h,[f,m])=>`${h}${f}=${m},`,"");if(lw(u)&&a!=="_self")return bI(e||"",a),new nc(null);let d=window.open(e||"",a,l);A(d,n,"popup-blocked");try{d.focus()}catch(h){}return new nc(d)}function bI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var SI="__/auth/handler",AI="emulator/auth/handler";function Ip(n,e,t,r,i,s){A(n.config.authDomain,n,"auth-domain-config-required"),A(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kt,eventId:i};if(e instanceof Ha){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Vc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[c,u]of Object.entries(s||{}))o[c]=u}if(e instanceof $n){let c=e.getScopes().filter(u=>u!=="");c.length>0&&(o.scopes=c.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let c of Object.keys(a))a[c]===void 0&&delete a[c];return`${NI(n)}?${rn(a).slice(1)}`}function NI({config:n}){return n.emulator?Ua(n,AI):`https://${n.authDomain}/${SI}`}var rc="webStorageSupport",_p=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ja,this._completeRedirectFn=eI}async _openPopup(e,t,r,i){var s;it((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=Ip(e,t,r,Ma(),i);return TI(e,o,Xa())}async _openRedirect(e,t,r,i){return await this._originValidation(e),Ow(Ip(e,t,r,Ma(),i)),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(it(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r}async initAndGetManager(e){let t=await yI(e),r=new gp(e);return t.register("authEvent",i=>(A(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(rc,{type:rc},i=>{var s;let o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[rc];o!==void 0&&t(!!o),Ve(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=oI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Jf()||za()||ys()}},Ep=_p;var kI="@firebase/auth",DI="0.17.1-2021730202621";var Tp=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{var i;e(((i=r)===null||i===void 0?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){A(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function RI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function CI(n){Nt(new Ye("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),{apiKey:i,authDomain:s}=r.options;return(o=>{A(i&&!i.includes(":"),"invalid-api-key",{appName:o.name}),A(!(s==null?void 0:s.includes(":")),"argument-error",{appName:o.name});let a={apiKey:i,authDomain:s,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xf(n)},c=new Zf(o,a);return Jv(c,t),c})(r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Nt(new Ye("auth-internal",e=>{let t=vs(e.getProvider("auth").getImmediate());return(r=>new Tp(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),at(kI,DI,RI(n))}function ic(n=ei()){let e=Wn(n,"auth");return e.isInitialized()?e.getImmediate():Mf(n,{popupRedirectResolver:Ep,persistence:[hp,ip,Ja]})}CI("Browser");var OI=Na([ka,Da,Ca,Oa,La]);function D(n,e){this.name=n,this.setUrl(e)}D.prototype.name="sign-in";D.prototype.urls={};D.prototype.vnode=null;D.prototype.plants=[];D.prototype.auth=ic();Ga(D.prototype.auth,PI);async function PI(n){n?(D.prototype.plants=await _f(),D.prototype.goto("plants")):D.prototype.goto("sign-in")}D.prototype.setUrl=function(n){this.urls[this.name]={obj:this,url:n}};D.prototype.saveBackup=function(){Ef(this.plants)};D.prototype.saveToDb=function(){If(this.plants)};D.prototype.setup=function(){};D.prototype.onLoad=function(){};D.prototype.addToHistory=!0;D.prototype.pushHistory=function(n,...e){this.urls[n].obj.addToHistory&&history.pushState({view:n,args:e},null,this.urls[n].url)};D.prototype.goto=function(n,...e){this.moveto(n,...e),this.pushHistory(n,...e)};D.prototype.moveto=function(n,...e){D.prototype.name=n;let t=this.urls[n].obj;t.setup(...e),t.redraw(),t.onLoad()};D.prototype.redraw=function(){old=D.prototype.vnode,D.prototype.vnode=this.view(),OI(old,D.prototype.vnode)};D.prototype.nav=function(){return p("header",[p("button",{class:{selected:this.name==="plants"||this.name==="view-plant"},on:{click:()=>this.goto("plants")}},["Plant View"]),p("button",{class:{selected:this.name==="areas"},on:{click:()=>this.goto("areas")}},["Area View"]),p("button",{class:{selected:this.name==="search"},on:{click:()=>this.goto("search")}},["Search"])])};D.prototype.viewPlantDataTable=function(n){return[n.rhs?p("h3.rhs",["RHS award"]):null,p("section",[p("table.plant-data",[n.name.length>0?p("tr",[p("th",["Name"]),p("td",[n.name])]):null,n.description.length>0?p("tr",[p("th",["Description"]),p("td",[n.description])]):null,n.size.length>0?p("tr",[p("th",["Size"]),p("td",[n.size])]):null,n.care.length>0?p("tr",[p("th",["Care"]),p("td",[n.care])]):null]),...n.areas.map(e=>p("div.area",{on:{click:()=>this.goto("areas",e)}},[p("p",[e.number?p("span.data",[`${e.number}x`]):null,p("span",[` ${Ce(e.general)} - ${Oe(e.general,e.specific)}`])]),e.date?p("p",[p("span",["Since "]),p("span.data",[new Date(e.date).toDateString().split(" ").splice(1).join(" ")])]):null]))])]};var bp=new D("plants","/plants");bp.view=function(){return p("div",[this.nav(),p("main",[p("h1",[`${this.plants.length} Plants`]),p("div.add-plant",[p("button.save-backup",{on:{click:()=>this.saveBackup()}},["Save backup"]),p("button",{on:{click:()=>this.goto("edit-plant")}},["+ Plant"])]),p("table.plant-table",[p("tr",[p("th",["Name"]),p("th",["Areas"])]),...this.plants.filter(n=>n.name!=null).sort((n,e)=>n.name>e.name?1:-1).map(this.renderPlant.bind(this))])])])};bp.renderPlant=function(n){let e=100;return p("tr",{on:{click:()=>this.goto("view-plant",n)}},[p("td",[n.name]),p("td",n.areas.map(t=>p("p.area-text",[`${Ce(t.general)} - ${Oe(t.general,t.specific)}`])))])};var Sp=new D("add-another","/add-another");Sp.setup=function(n){this.justAdded=n};Sp.view=function(){return p("div",[p("main",[p("h2",["Added!"]),...this.viewPlantDataTable(this.justAdded),p("p",["Add another?"]),p("button",{on:{click:()=>this.goto("edit-plant")}},["Yes"]),p("button",{on:{click:()=>this.goto("view-plant",this.justAdded)}},["No"])])])};var sc=new D("areas","/areas");sc.setup=function(n=null){this.jumpToArea=n};sc.onLoad=function(){this.jumpToArea&&document.getElementById(`${this.jumpToArea.general}-${this.jumpToArea.specific}`).scrollIntoView()};sc.view=function(){let n=[];for(let e=0;e<ls;e++){n.push(new Array(Vn(e)));for(let t=0;t<n[e].length;t++)n[e][t]=new Array}for(let e of this.plants)for(let t of e.areas)n[t.general][t.specific].push(e);return p("div",[this.nav(),p("main",n.map((e,t)=>p("section",[p("h2",[Ce(t)]),...e.map((r,i)=>p("div",[p(`details#${t}-${i}`,[p("summary",[Oe(t,i)]),p("ul.specific-area",r.map(s=>p("li",{on:{click:()=>this.goto("view-plant",s)}},[s.name]))),p("div.add-plant-to-specific-area",[p("button",{on:{click:()=>{let s={...hs(),areas:[{general:t,specific:i,date:null,number:1}]};this.plants.push(s),this.goto("edit-plant",s)}}},["+ Plant"])])])]))])))])};var oc=new D("edit-plant","/edit-plant");oc.setup=function(n=null,e=null,t=null){n===null?this.plant=hs():this.plant=n,e?(this.nextView=e,this.nextViewArgs=t,this.failView=e,this.failViewArgs=t):(this.nextView="add-another",this.nextViewArgs=[this.plant],this.failView="plants",this.failViewArgs=[])};oc.view=function(){let n=(e,t=r=>r)=>r=>{this.plant[e]=t(r.target.value),this.redraw()};return p("div",[p("main",[p("h2",["Plant Editor"]),p("label",["Name:",p("input",{on:{input:n("name")},attrs:{type:"text",value:this.plant.name}})]),p("label",["Description:",p("textarea",{on:{input:n("description")}},[this.plant.description])]),p("label",["Care:",p("textarea",{on:{input:n("care")}},[this.plant.care])]),p("label",["Size:",p("input",{on:{input:n("size")},attrs:{type:"text",value:this.plant.size}})]),p("label",["RHS:",p("input",{on:{change:n("rhs",Boolean)},attrs:{type:"checkbox",checked:this.plant.rhs}})]),p("hr"),this.viewAreaWidget(),p("hr"),p("button.cancel",{on:{click:()=>{this.goto(this.failView,...this.failViewArgs)}}},["Cancel"]),p("button.done",{on:{click:()=>{this.plants.indexOf(this.plant)===-1&&this.plants.push(this.plant),this.saveToDb(),this.goto(this.nextView,...this.nextViewArgs)}}},["Done"])])])};oc.viewAreaWidget=function(){let n=e=>{try{return new Date(e).toISOString().slice(0,10)}catch{return null}};return p("div",[...this.plant.areas.map(e=>p("div.inputArea",[p("select",{on:{change:t=>{e.general=parseInt(t.target.value),e.specific>=Vn(e.general)&&(e.specific=0),this.redraw()}}},[...Array(ls).keys()].map(t=>p("option",{attrs:{value:t,selected:e.general===t}},[Ce(t)]))),Vn(e.general)>1?p("select",{on:{change:t=>{e.specific=parseInt(t.target.value),this.redraw()}}},[...Array(Vn(e.general)).keys()].map(t=>p("option",{attrs:{value:t,selected:e.specific===t}},[Oe(e.general,t)]))):null,p("label",["Date: ",p("input",{on:{change:t=>{e.date=n(t.target.value),this.redraw()}},attrs:{type:"date",value:n(e.date)}})]),p("label",["Number: ",p("input",{on:{change:t=>{e.number=parseInt(t.target.value),this.redraw()}},attrs:{type:"number",value:e.number}})]),p("button.remove-area",{on:{click:()=>{this.plant.areas.splice(this.plant.areas.indexOf(e),1),this.redraw()}}},["Remove"])])),p("button.add-area",{on:{click:()=>{this.plant.areas.push({general:0,specific:0}),this.redraw()}}},["+ Area"])])};var ac=new D("view-plant","/viewplant");ac.setup=function(n){this.plant=n};ac.onLoad=function(){window.scrollTo(0,0)};ac.view=function(){return p("div",[this.nav(),p("main",[p("h2",[this.plant.name]),p("button",{on:{click:()=>this.goto("edit-plant",this.plant,"view-plant",[this.plant])}},["Edit"]),p("button",{on:{click:()=>{confirm(`Are you sure you want to delete "${this.plant.name}"?`)&&(this.plants.splice(this.plants.indexOf(this.plant),1),this.saveToDb(),this.goto("plants"))}}},["Delete"]),...this.viewPlantDataTable(this.plant)])])};function LI(n){return n.name+" "+n.description+" "+n.size+" "+n.care+" "+n.areas.map(e=>Ce(e.general)+" "+Oe(e.general,e.specific)+" "+e.number+" "+e.date).join("")}function Ap(n,e){return e===""?n:n.filter(t=>LI(t).toLowerCase().indexOf(e.toLowerCase())!==-1)}var bs=new D("search","/search");bs.onlyRHS=!1;bs.searchTerm="";bs.onLoad=function(){let n=document.getElementById("search");if(n){n.focus();let e=n.value.length+1;n.setSelectionRange(e,e)}};bs.view=function(){return p("div",[this.nav(),p("main",[p("input#search",{on:{input:()=>{this.searchTerm=document.getElementById("search").value,this.redraw()}},attrs:{type:"text",placeholder:"Type to search...",value:this.searchTerm}}),p("label",["Only RHS award winners:",p("input",{on:{change:()=>{this.onlyRHS=!this.onlyRHS,this.redraw()}},attrs:{type:"checkbox",checked:this.onlyRHS}})]),p("ul",Ap(this.plants.filter(n=>this.onlyRHS?n.rhs:!0),this.searchTerm).map(n=>p("li",{on:{click:()=>this.goto("view-plant",n)}},[p("p",[n.name]),p("p",n.areas.map(e=>p("p.area-in-list",[`${Ce(e.general)}:${Oe(e.general,e.specific)}`])))])))])])};var Np=new D("sign-in","/sign-in");Np.triedBefore=!1;Np.view=function(){return p("main#sign-in",[p("h2",["Sign in"]),this.triedBefore?p("p.incorrect-login",["Incorrect login. Please try again."]):null,p("form",{on:{submit:n=>{n.preventDefault(),this.triedBefore=!0;let e=document.getElementById("email").value,t=document.getElementById("pwd").value;this.goto("spinner",new Promise(r=>Ka(this.auth,e,t).then(()=>r("plants")).catch(()=>r("sign-in"))))}}},[p("label",["Email:",p("input#email",{attrs:{type:"email",autocomplete:"email"}})]),p("label",["Password:",p("input#pwd",{attrs:{type:"password",autocomplete:"password"}})]),p("input",{attrs:{type:"submit",value:"Login"}})])])};var cc=new D("spinner","/loading");cc.addToHistory=!1;cc.setup=function(n){this.prom=n,n.then((...e)=>this.goto(...e))};cc.view=function(){return p("div.spinner",[p("div.spinner-in")])};var kp=start=function(){D.prototype.goto("spinner",new Promise(()=>null))};document.addEventListener("DOMContentLoaded",()=>D.prototype.vnode=document.getElementById("root"));window.onpopstate=function(n){n.state&&D.prototype.moveto(n.state.view,...n.state.args)};function xI(){navigator.serviceWorker.register("/serviceWorker.js").then(n=>console.log("service worker registered"))}function MI(){"serviceWorker"in navigator&&xI(),wf()}MI();document.addEventListener("DOMContentLoaded",kp);})();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
